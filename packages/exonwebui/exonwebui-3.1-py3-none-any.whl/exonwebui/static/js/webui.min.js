/*
  :copyright: 2020, ExonLabs. All rights reserved.
  :license: BSD, see LICENSE for more details.
*/
var WebUI=function(c,s){return c.ajaxSetup({cache:!0}),s.format_url=function(e){return"/"+e.replace(/^[\/#]/,"")},s.doctitle={base:document.title,update:function(e){void 0!==e&&0<e.length&&(e=e[0].toUpperCase()+e.slice(1),document.title=e+" | "+s.doctitle.base)},reset:function(){document.title=s.doctitle.base}},s.pagelock={show:function(e,o){s.pagelock.hide(),c("body").append('<div id="_UiPageLock" class="container-fluid overflow-auto scroll page-lock '+(o||"")+'">'+(e||"")+"</div>")},loading:function(e){return s.pagelock.show('<div class="row"><div class="col cancel"><a id="_UiPageLock_btnCancel">&times;</a></div></div>'+(e||""),"page-loading"),c("#_UiPageLock_btnCancel").on("click",function(){s.pagelock.hide()}),c("#_UiPageLock_btnCancel")},progress:function(e){if(!e)return s.pagelock.loading('<div class="row h-100 align-items-center justify-content-center"><div class="col-5"><div class="progress"><div class="progress-bar progress-bar-striped progress-bar-animated"></div></div></div></div>');c("#_UiPageLock .progress-bar").css("width",e+"%")},modal:function(e,o,t,r){s.pagelock.show('<div class="modal-dialog modal-dialog-centered '+(r||"")+'"><div class="modal-content"><div class="modal-header pt-2 pb-1">'+(e||"")+'<button class="close" onclick="WebUI.pagelock.hide()">&times;</button></div><div class="modal-body scroll">'+(o||"")+(t?'</div><div class="modal-footer p-1">'+t+"</div></div></div>":""))},hide:function(){c("#_UiPageLock").length&&c("#_UiPageLock").remove()}},s.notify={stack:{dir1:"down",dir2:"left",push:"top",firstpos1:14,firstpos2:10,spacing1:7,spacing2:7},clear:PNotify.removeAll,show:function(e,o,t,r){t&&PNotify.removeAll(),window.innerWidth<576?(s.notify.stack.firstpos1=0,s.notify.stack.firstpos2=0):(s.notify.stack.firstpos1=14,s.notify.stack.firstpos2=10),"rtl"==c("html").attr("dir")||"rtl"==c("body").attr("dir")?s.notify.stack.dir2="right":s.notify.stack.dir2="left";var n={styling:"fontawesome",icon:!1,hide:!r,animate_speed:"fast",buttons:{sticker:!1,closer:!0},addclass:"stack-custom",stack:s.notify.stack};"error"==e?(n.type="error",n.text='<i class="fa fas fa-ta fa-exclamation-circle"></i>'+o):"warn"==e?(n.type="notice",n.text='<i class="fa fas fa-ta fa-exclamation-circle"></i>'+o):"success"==e?(n.type="success",n.text='<i class="fa fas fa-ta fa-check-circle"></i>'+o):(n.type="info",n.text='<i class="fa fas fa-ta fa-info-circle"></i>'+o);var i=new PNotify(n);i.get().click(function(){i.remove()})},error:function(e,o,t){s.notify.show("error",e,o,t)},warn:function(e,o,t){s.notify.show("warn",e,o,t)},info:function(e,o,t){s.notify.show("info",e,o,t)},success:function(e,o,t){s.notify.show("success",e,o,t)},load:function(e){for(var o=0;o<e.length;o++)s.notify.show(e[o][0],e[o][1],e[o][2],e[o][3])}},s.scrolltop=function(e){c("body").animate({scrollTop:0},e||300)},s.redirect=function(e,o){void 0!==e&&0<e.length&&("#"==e[0]?e==window.location.hash?c(window).trigger("hashchange"):window.location.hash=e:o?window.open(e):e==window.location?location.reload():window.location=e)},s.request=function(e,o,t,r,n,i,a){return c.ajax({url:s.format_url(o),type:e,data:t||{},contentType:!(t instanceof FormData)&&"application/x-www-form-urlencoded; charset=UTF-8",processData:!(t instanceof FormData),success:function(e,o,t){s.request.success(e,r)},error:function(e,o,t){t="abort"==t?"request cancelled":e.status?t||"request failed":"service unavailable",s.request.error(c.i18n._(t),n)},complete:function(e,o){s.request.complete(o,i)},xhr:function(){return"function"==typeof a?a():new window.XMLHttpRequest}})},s.request.success=function(e,o){"function"==typeof o?o(e):(e.notifications&&s.notify.load(e.notifications),e.redirect&&s.redirect(e.redirect,e.blank))},s.request.error=function(e,o){"function"==typeof o?o(e):s.notify.error(e,!0,!0)},s.request.complete=function(e,o){"function"==typeof o&&o(e)},s.loader={req_xhr:null,lock_timer:null,progress_timer:null,progress_xhr:null,load:function(e,o,t,r,n,i,a){s.loader.cancel(),s.loader.lock_timer=setTimeout(function(){s.pagelock.loading().off("click").on("click",function(e){s.loader.cancel()})},a||500),s.loader.req_xhr=s.request(e,o,t,function(e){s.loader.reset(),s.pagelock.hide(),s.request.success(e,r)},function(e){s.loader.reset(),s.pagelock.hide(),s.request.error(e,n)},i)},progress:function(e,o,t,r,n,i,a,c){s.loader.cancel(),s.loader.lock_timer=setTimeout(function(){s.pagelock.progress().off("click").on("click",function(e){s.loader.cancel()}),s.loader.progress_timer=setInterval(function(){null===s.loader.progress_xhr&&(s.loader.progress_xhr=s.request(e,o,{get_progress:1},function(e){s.pagelock.progress(e.payload)},function(e){},function(e){s.loader.progress_xhr=null}))},c||5e3)},a||500),s.loader.req_xhr=s.request(e,o,t,function(e){s.loader.reset(),s.pagelock.progress(100),setTimeout(function(){s.pagelock.hide(),s.request.success(e,r)},500)},function(e){s.loader.reset(),s.pagelock.hide(),s.request.error(e,n)},i)},formsubmit:function(e,o,t,r,n){s.loader.cancel();var i=s.pagelock.progress;s.loader.lock_timer=setTimeout(function(){i().off("click").on("click",function(e){s.loader.cancel()})},n||500),s.loader.req_xhr=s.request(e.attr("method"),e.attr("action"),new FormData(e[0]),function(e){s.loader.reset(),s.pagelock.hide(),s.request.success(e,o)},function(e){s.loader.reset(),s.pagelock.hide(),s.request.error(e,t)},r,function(){var e=new window.XMLHttpRequest;return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var o=parseInt(e.loaded/e.total*100);if(o<100)return s.pagelock.progress(o),null;s.pagelock.progress(100)}i=s.pagelock.loading},!1),e})},cancel:function(){s.loader.req_xhr&&s.loader.req_xhr.abort()},reset:function(){s.loader.lock_timer&&clearTimeout(s.loader.lock_timer),s.loader.progress_timer&&clearTimeout(s.loader.progress_timer),s.loader.req_xhr=null,s.loader.lock_timer=null,s.loader.progress_timer=null}},s.loadCss={after:function(e,o){c("head link[href='"+e+"']").length||(void 0!==o?c(o).after('<link rel="stylesheet" type="text/css" href="'+e+'">'):c("head").append('<link rel="stylesheet" type="text/css" href="'+e+'">'))},before:function(e,o){c("head link[href='"+e+"']").length||(void 0!==o?c(o).before('<link rel="stylesheet" type="text/css" href="'+e+'">'):c("head").append('<link rel="stylesheet" type="text/css" href="'+e+'">'))}},s.loadScript=function(r,t){c("body script[_src='"+r+"']").length?"function"==typeof t&&t():c.getScript(r).done(function(e,o){c("body").append('<script type="text/javascript" _src="'+r+'"><\/script>'),"function"==typeof t&&t()}).fail(function(e,o,t){s.notify.warn(c.i18n._("Failed to load all page contents !!")+"<br>"+c.i18n._("Please reload page and try again."),null,!0),console.error("failed loading "+r+" ["+t+"]")})},c(document).ready(function(){c("html").attr("lang")&&"undefined"!=typeof webui_i18n&&c.i18n.load(webui_i18n)}),s}(jQuery,WebUI||{});
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-221c78e9"],{"24bc":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-select",e._b({attrs:{placeholder:"选择项目"},model:{value:e._value,callback:function(t){e._value=t},expression:"_value"}},"el-select",e.$attrs,!1),e._l(e.list,(function(e){return r("el-option",{attrs:{label:e.project,value:e.project}})})),1)},i=[],a=(r("9382"),r("ed32")),s={name:"",props:{value:{type:String}},components:{},data:function(){return{list:[]}},computed:{_value:{get:function(){return this.value},set:function(e){this.$emit("update:value",e)}}},methods:{getData:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$Http.scrapydListProjects();case 2:t=e.sent,this.list=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},created:function(){this.getData()}},o=s,c=r("5d22"),l=Object(c["a"])(o,n,i,!1,null,"09352087",null);t["a"]=l.exports},3629:function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-autocomplete",e._g(e._b({attrs:{"fetch-suggestions":e.querySearch,placeholder:"搜索\bSpider名"},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.item;return[r("span",[e._v(e._s(n.spider))])]}}]),model:{value:e._value,callback:function(t){e._value=t},expression:"_value"}},"el-autocomplete",e.$attrs,!1),e.$listeners))},i=[],a=(r("9382"),r("ed32")),s={name:"",props:{value:{type:String},project:{type:String}},components:{},data:function(){return{list:[]}},watch:{project:{handler:function(e){e?this.getData():this.list=[]},immediate:!0}},computed:{_value:{get:function(){return this.value},set:function(e){this.$emit("update:value",e)}}},methods:{querySearch:function(e,t){var r=e?this.filterItem(e):this.list;t(r)},filterItem:function(e){return this.list.filter((function(t){return 0==t.spider.toLowerCase().indexOf(e.toLowerCase())}))},handleSelect:function(e){this._value=e.spider,this.$emit("change",e.spider)},getData:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.list=[],e.next=3,this.$Http.scrapydlistSpiders({project:this.project});case 3:t=e.sent,this.list=t.data;case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},created:function(){}},o=s,c=r("5d22"),l=Object(c["a"])(o,n,i,!1,null,"2a1a8db9",null);t["a"]=l.exports},"479c":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{},[r("el-button",e._b({attrs:{size:"mini",icon:"el-icon-video-play"},on:{click:e.handleSchedule}},"el-button",e.$attrs,!1),[e._v("运行")])],1)},i=[],a=(r("9382"),r("ed32")),s={name:"",props:{spider:{type:String},project:{type:String}},components:{},data:function(){return{}},computed:{},methods:{handleSchedule:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$Http.scrapydSchedule({project:this.project,spider:this.spider});case 2:t=e.sent,0==t.code?this.$message.success("运行成功"):this.$message.error(t.msg);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},created:function(){}},o=s,c=r("5d22"),l=Object(c["a"])(o,n,i,!1,null,"a1e375f0",null);t["a"]=l.exports},"63d3":function(e,t,r){"use strict";var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("span",{},[r("el-button",e._b({attrs:{size:"mini",icon:e.icon},on:{click:function(t){e.dialogVisible=!0}}},"el-button",e.$attrs,!1),[e._v(e._s(e.btnText))]),e._v(" "),r("el-dialog",{attrs:{title:e.btnText+"任务",visible:e.dialogVisible,width:"500px",center:""},on:{"update:visible":function(t){e.dialogVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,"status-icon":"","label-width":"100px",size:"small",rules:e.rules}},[r("el-form-item",{attrs:{label:"项目名称",prop:"project",width:"300px"}},[r("ProjectSelect",{staticStyle:{width:"300px"},attrs:{value:e.form.project,disabled:null!=e.project||null!=e.job_id},on:{"update:value":function(t){return e.$set(e.form,"project",t)}}})],1),e._v(" "),r("el-form-item",{attrs:{label:"\bSpider名称",prop:"spider",width:"300px"}},[r("SpiderSearch",{staticStyle:{width:"300px"},attrs:{project:e.form.project,value:e.form.spider,disabled:null!=e.spider||null!=e.job_id},on:{"update:value":function(t){return e.$set(e.form,"spider",t)}}})],1),e._v(" "),r("el-form-item",{attrs:{label:"cron表达式",prop:"cron"}},[r("el-input",{staticStyle:{width:"300px"},attrs:{type:"text",placeholder:"分 时 日 月 周"},model:{value:e.form.cron,callback:function(t){e.$set(e.form,"cron",t)},expression:"form.cron"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"其他参数",prop:"options"}},[r("el-input",{staticStyle:{width:"300px"},attrs:{type:"textarea",rows:"3",placeholder:'any parameter is passed as spider args eg:{"setting": "DOWNLOAD_DELAY=2"}'},model:{value:e.form.options,callback:function(t){e.$set(e.form,"options",t)},expression:"form.options"}})],1)],1),e._v(" "),r("span",{attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{size:"small"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.submit}},[e._v("确 定")])],1)],1)],1)},i=[],a=(r("ac67"),r("1bc7"),r("32ea"),r("34f5")),s=(r("9382"),r("ed32")),o=(r("fc02"),r("24bc")),c=r("3629");function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){Object(a["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p={name:"",props:{job_id:{type:String,default:null},project:{type:String,default:null},spider:{type:String,default:null}},components:{ProjectSelect:o["a"],SpiderSearch:c["a"]},data:function(){var e=function(e,t,r){if(!t)return r(new Error("cron表达式不能为空"));var n=t.split(" ").filter((function(e){return""!=e.trim()}));if(5!=n.length)return r(new Error("cron表达式不正确"));r()},t=function(e,t,r){if(t)try{JSON.parse(t)}catch(n){return r(new Error("参数不是json字符串"))}r()};return{dialogVisible:!1,form:{project:"",spider:"",cron:"* * * * *",options:""},rules:{project:{required:!0,message:"项目名称必须填写",trigger:"blur"},spider:{required:!0,message:"\bSpider名称必须填写",trigger:"change"},cron:{required:!0,validator:e,trigger:"blur"},options:{required:!1,validator:t,trigger:"blur"}}}},computed:{btnText:function(){return this.job_id?"修改":"添加"},icon:function(){return this.job_id?"el-icon-edit-outline":"el-icon-document-add"}},watch:{dialogVisible:function(e){e&&(this.form.project=this.project,this.form.spider=this.spider,this.job_id&&this.getData())}},methods:{getData:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$Http.scheduleJobDetail({job_id:this.job_id});case 2:t=e.sent,this.form=t.data.kwargs;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),submit:function(){var e=this;this.$refs.form.validate((function(t){t&&e.addVersion()}))},addVersion:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$Http.scheduleAddJob(u({job_id:this.job_id},this.form));case 2:t=e.sent,0==t.code?(this.$message.success("添加成功"),this.$emit("success"),this.dialogVisible=!1):this.$message.error(t.msg);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},created:function(){}},d=p,f=r("5d22"),h=Object(f["a"])(d,n,i,!1,null,"dc887f22",null);t["a"]=h.exports},f96b:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("SpiderTable",{attrs:{data:e.list}})],1)},i=[],a=(r("9382"),r("ed32")),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("mo-table",e._g(e._b({},"mo-table",e.$attrs,!1),e.$listeners),[r("el-table-column",{attrs:{align:"center",label:"序号",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n      "+e._s(t.$index+1)+"\n    ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"\bSpider名称",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n      "+e._s(t.row.spider)+"\n    ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"查看日志",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("router-link",{attrs:{to:{name:"logs-project-spider",params:{project:e.project,spider:t.row.spider}}}},[r("i",{staticClass:"el-icon-document"}),e._v("查看")])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"添加任务",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("ScheduleAdd",{attrs:{spider:t.row.spider,project:e.project}})]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"运行\bSpider",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("SpiderSchedule",{attrs:{spider:t.row.spider,project:e.project}})]}}])})],1)},o=[],c=r("479c"),l=r("63d3"),u={name:"",props:[],components:{SpiderSchedule:c["a"],ScheduleAdd:l["a"]},data:function(){return{project:""}},computed:{},methods:{getData:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},created:function(){this.project=this.$route.params.project,this.getData()}},p=u,d=r("5d22"),f=Object(d["a"])(p,s,o,!1,null,"132ce09c",null),h=f.exports,m={name:"",props:[],components:{SpiderTable:h},data:function(){return{project:"",list:[]}},computed:{},methods:{getData:function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$Http.scrapydlistSpiders({project:this.project});case 2:t=e.sent,this.list=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},created:function(){this.project=this.$route.params.project,this.getData()}},b=m,v=Object(d["a"])(b,n,i,!1,null,"3ad057f6",null);t["default"]=v.exports}}]);
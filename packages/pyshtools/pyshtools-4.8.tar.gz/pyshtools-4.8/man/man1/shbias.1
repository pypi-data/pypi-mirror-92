.\" Automatically generated by Pandoc 2.11.3.2
.\"
.TH "shbias" "1" "2020-12-16" "Fortran 95" "SHTOOLS 4.8"
.hy
.SH SHBias
.PP
Calculate the (cross-)power spectrum expectation of a windowed function
from its global spectrum.
.SH Usage
.PP
call SHBias (\f[C]shh\f[R], \f[C]lwin\f[R], \f[C]incspectra\f[R],
\f[C]ldata\f[R], \f[C]outcspectra\f[R], \f[C]save_cg\f[R],
\f[C]exitstatus\f[R])
.SH Parameters
.TP
\f[B]\f[CB]shh\f[B]\f[R] : input, real(dp), dimension (\f[B]\f[CB]lwin\f[B]\f[R]+1)
The power spectrum of the localizing window.
.TP
\f[B]\f[CB]lwin\f[B]\f[R] : input, integer(int32)
The spherical harmonic bandwidth of the localizing window.
.TP
\f[B]\f[CB]incspectra\f[B]\f[R] : input, real(dp), dimension (\f[B]\f[CB]ldata\f[B]\f[R]+1)
The global unwindowed (cross-)power spectrum.
.TP
\f[B]\f[CB]ldata\f[B]\f[R] : input, integer(int32)
The maximum degree of the global unwindowed power spectrum.
.TP
\f[B]\f[CB]outcspectra\f[B]\f[R] : output, real(dp), dimension (\f[B]\f[CB]ldata\f[B]\f[R]+\f[B]\f[CB]lwin\f[B]\f[R]+1)
The expectation of the localized (cross-)power spectrum.
.TP
\f[B]\f[CB]save_cg\f[B]\f[R] : optional, input, integer(int32), default = 0
If set equal to 1, the Clebsch-Gordon coefficients will be precomputed
and saved for future use (if \f[C]lwin\f[R] or \f[C]ldata\f[R] change,
this will be recomputed).
To deallocate the saved memory, set this parameter equal to -1.
If set equal to 0 (default), the Clebsch-Gordon coefficients will be
recomputed for each call.
.TP
\f[B]\f[CB]exitstatus\f[B]\f[R] : output, optional(int32), integer
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[C]SHBias\f[R] will calculate the (cross-)power spectrum expectation
of a function multiplied by a localizing window.
This is given by equation 35 of Wieczorek and Simons (2005) and equation
2.11 of Wieczorek and Simons (2007),
.PP
\f[C]<SFG> = Sum_{j=0}\[ha]L Shh Sum_{i=|l-j|}\[ha]{|l+j|} Sfg (C_{j0i0}\[ha]{l0})\[ha]2\f[R]
.PP
where \f[C]<SFG>\f[R] is the expectation of the localized (cross-)power
spectrum, \f[C]Shh\f[R] is the power spectrum of the window bandlimited
to degree \f[C]L\f[R], \f[C]Sfg\f[R] is the global unwindowed
(cross-)power spectrum, and \f[C]C\f[R] is a Clebsch-Gordan coefficient.
The Clebsch-Gordan coefficients are calculated using a simple
relationship to the Wigner 3-j symbols.
The maximum calculated degree of the windowed power spectrum expectation
corresponds to the smaller of (\f[C]ldata+lwin\f[R]) and
\f[C]size(outcspectra)-1\f[R].
It is implicitly assumed that the power spectrum of \f[C]inspectrum\f[R]
is zero beyond degree \f[C]ldata.\f[R].
If this is not the case, the ouput power spectrum should be considered
valid only for the degrees up to and including \f[C]ldata\f[R] -
\f[C]lwin\f[R].
.PP
If this routine is to be called several times using the same values of
\f[C]lwin\f[R] and \f[C]ldata\f[R], then the Clebsch-Gordon coefficients
can be precomputed and saved by setting the optional parameter
\f[C]save_cg\f[R] equal to 1.
To deallocate the saved memory, which is a matrix of size
(\f[C]lwin+ldata,lwin,2*lwin+ldata+1\f[R]), set \f[C]save_cg\f[R] equal
to -1.
.SH References
.PP
Wieczorek, M.
A.
and F.
J.
Simons, Localized spectral analysis on the sphere, Geophys.
J.
Int., 162, 655-675, doi:10.1111/j.1365-246X.2005.02687.x, 2005.
.PP
Wieczorek, M.
A.
and F.
J.
Simons, Minimum-variance multitaper spectral estimation on a sphere, J.
Fourier Anal.
Appl., 13, 665-692, doi:10.1007/s00041-006-6904-1, 2007.
.SH See also
.PP
shpowerspectrum,shcrosspowerspectrum, wigner3j, shreturntapers,
shreturntapersm, shbiasadmitcorr

.\" Automatically generated by Pandoc 2.11.3.2
.\"
.TH "shreturntapersm" "1" "2020-12-16" "Fortran 95" "SHTOOLS 4.8"
.hy
.SH SHReturnTapersM
.PP
Calculate the eigenfunctions of the spherical-cap concentration problem
for a single angular order.
.SH Usage
.PP
call SHReturnTapersM (\f[C]theta0\f[R], \f[C]lmax\f[R], \f[C]m\f[R],
\f[C]tapers\f[R], \f[C]eigenvalues\f[R], \f[C]shannon\f[R],
\f[C]degrees\f[R], \f[C]ntapers\f[R], \f[C]exitstatus\f[R])
.SH Parameters
.TP
\f[B]\f[CB]theta0\f[B]\f[R] : input, real(dp)
The angular radius of the spherical cap in radians.
.TP
\f[B]\f[CB]lmax\f[B]\f[R] : input, integer(int32)
The spherical harmonic bandwidth of the localization windows.
.TP
\f[B]\f[CB]m\f[B]\f[R] : input, integer(int32)
The angular order of the localization windows.
.TP
\f[B]\f[CB]tapers\f[B]\f[R] : output, real(dp), dimension (\f[B]\f[CB]lmax\f[B]\f[R]+1, \f[B]\f[CB]lmax\f[B]\f[R]+1)
The spherical harmonic coefficients of the \f[C]lmax+1\f[R] localization
windows, arranged in columns.
The first and last rows of each column correspond to spherical harmonic
degrees 0 and \f[C]lmax\f[R], respectively, and the columns are arranged
from best to worst concentrated.
Only the first \f[C]ntapers\f[R] columns are non-zero.
.TP
\f[B]\f[CB]eigenvalues\f[B]\f[R] : output, real(dp), dimension (\f[B]\f[CB]lmax\f[B]\f[R]+1)
The concentration factors of the localization windows.
.TP
\f[B]\f[CB]shannon\f[B]\f[R] : output, optional, real(dp)
The Shannon number, which is the trace of the concentration kernel.
.TP
\f[B]\f[CB]degrees\f[B]\f[R] : input, integer(int32), optional, dimension (\f[B]\f[CB]lmax\f[B]\f[R]+1)
List of degrees to use when computing the eigenfunctions.
Only those degrees where \f[C]degrees(l+1)\f[R] is non-zero will be
employed.
.TP
\f[B]\f[CB]ntapers\f[B]\f[R] : output, integer(int32), optional
The number of non-zero tapers.
.TP
\f[B]\f[CB]exitstatus\f[B]\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[C]SHReturnTapersM\f[R] will calculate the eigenfunctions of the
spherical-cap concentration problem for a singule angular order.
The 4pi normalized spherical harmonic coefficients of each window are
given in the columns of \f[C]tapers\f[R], and the corresponding
concentration factors are given in \f[C]eigenvaules\f[R].
The columns of \f[C]tapers\f[R] are ordered from best to worst
concentrated, and the first and last rows of each column correspond to
spherical harmonic degrees 0 and \f[C]lmax\f[R], respectively.
The localization windows are normalized such that they have unit power.
If the optional vector \f[C]degrees\f[R] is specified, then the
eigenfunctions will be computed using only those degrees \f[C]l\f[R]
where \f[C]degrees(l+1)\f[R] is not zero.
.PP
When possible, the eigenfunctions are calculated using the kernel of
Grunbaum et al.\ 1982 and the eigenvalues are then calculated by
integration using the definition of the space-concentration problem.
Use of the Grunbaum et al.\ kernel is prefered over the
space-concentration kernel as the eigenfunctions of the later are
unreliable when there are several eigenvalues identical (within machine
precision) to either 1 or zero.
If, the optional parameter \f[C]degrees\f[R] is specified, and at least
one element is zero for degrees greater or equal to abs(m), then the
eigenfunctions and eigenvalues will instead be computed directly using
the space-concentration kernel.
.SH References
.PP
Grunbaum, F.
A., L.
Longhi, and M.
Perlstadt, Differential operators commuting with finite convolution
integral operators: Some non-abelian examples, SIAM, J.
Appl.
Math.
42, 941-955, 1982.
.PP
Simons, F.
J., F.
A.
Dahlen, and M.
A.
Wieczorek, Spatiospectral concentration on a sphere,
\f[C]SIAM Review\f[R], 48, 504-536, 2006.
.PP
Wieczorek, M.
A.
and F.
J.
Simons, Localized spectral analysis on the sphere,
\f[C]Geophys. J. Int.\f[R], 162, 655-675, 2005.
.SH See also
.PP
shreturntapers, computedg82, computedm

.\" Automatically generated by Pandoc 2.11.3.2
.\"
.TH "makemaggriddh" "1" "2020-12-16" "Fortran 95" "SHTOOLS 4.8"
.hy
.SH MakeMagGridDH
.PP
Create 2D cylindrical maps on a flattened ellipsoid of all three vector
components of the magnetic field, the magnitude of the magnetic field,
and the magnetic potential.
.SH Usage
.PP
call MakeMagGridDH (\f[C]cilm\f[R], \f[C]lmax\f[R], \f[C]r0\f[R],
\f[C]a\f[R], \f[C]f\f[R], \f[C]rad\f[R], \f[C]theta\f[R], \f[C]phi\f[R],
\f[C]total\f[R], \f[C]n\f[R], \f[C]sampling\f[R], \f[C]lmax_calc\f[R],
\f[C]pot_grid\f[R], \f[C]extend\f[R], \f[C]exitstatus\f[R])
.SH Parameters
.TP
\f[B]\f[CB]cilm\f[B]\f[R] : input, real(dp), dimension (2, \f[B]\f[CB]lmax\f[B]\f[R]+1, \f[B]\f[CB]lmax\f[B]\f[R]+1)
The real Schmidt semi-normalized spherical harmonic coefficients to be
expanded in the space domain.
The coefficients \f[C]C1lm\f[R] and \f[C]C2lm\f[R] refer to the cosine
(\f[C]Clm\f[R]) and sine (\f[C]Slm\f[R]) coefficients, respectively,
with \f[C]Clm=cilm(1,l+1,m+1)\f[R] and \f[C]Slm=cilm(2,l+1,m+1)\f[R].
Alternatively, \f[C]C1lm\f[R] and \f[C]C2lm\f[R] correspond to the
positive and negative order coefficients, respectively.
The coefficients are assumed to have units of nT.
.TP
\f[B]\f[CB]lmax\f[B]\f[R] : input, integer(int32)
The maximum spherical harmonic degree of the coefficients
\f[C]cilm\f[R].
This determines the number of samples of the output grids,
\f[C]n=2*lmax+2\f[R], and the latitudinal sampling interval,
\f[C]90/(lmax+1)\f[R].
.TP
\f[B]\f[CB]r0\f[B]\f[R] : input, real(dp)
The reference radius of the spherical harmonic coefficients.
.TP
\f[B]\f[CB]a\f[B]\f[R] : input, real(dp)
The semi-major axis of the flattened ellipsoid on which the field is
computed.
.TP
\f[B]\f[CB]f\f[B]\f[R] : input, real(dp)
The flattening of the reference ellipsoid: i.e.,
\f[C]F=(R_equator-R_pole)/R_equator\f[R].
.TP
\f[B]\f[CB]rad\f[B]\f[R] : output, real(dp), dimension(nlat, nlong)
A 2D map of radial component of the magnetic field that conforms to the
sampling theorem of Driscoll and Healy (1994).
If \f[C]sampling\f[R] is 1, the grid is equally sampled and is
dimensioned as (\f[C]n\f[R] by \f[C]n\f[R]), where \f[C]n\f[R] is
\f[C]2lmax+2\f[R].
If sampling is 2, the grid is equally spaced and is dimensioned as
(\f[C]n\f[R] by 2\f[C]n\f[R]).
The first latitudinal band of the grid corresponds to 90 N, the
latitudinal sampling interval is 180/\f[C]n\f[R] degrees, and the
default behavior is to exclude the latitudinal band for 90 S.
The first longitudinal band of the grid is 0 E, by default the
longitudinal band for 360 E is not included, and the longitudinal
sampling interval is 360/\f[C]n\f[R] for an equally sampled and
180/\f[C]n\f[R] for an equally spaced grid, respectively.
If \f[C]extend\f[R] is 1, the longitudinal band for 360 E and the
latitudinal band for 90 S will be included, which increases each of the
dimensions of the grid by 1.
.TP
\f[B]\f[CB]theta\f[B]\f[R] : output, real(dp), dimension(nlat, nlong)
A 2D equally sampled or equally spaced grid of the theta component of
the magnetic field.
.TP
\f[B]\f[CB]phi\f[B]\f[R] : output, real(dp), dimension(nlat, nlong)
A 2D equally sampled or equally spaced grid of the phi component of the
magnetic field.
.TP
\f[B]\f[CB]total\f[B]\f[R] : output, real(dp), dimension(nlat, nlong)
A 2D equally sampled or equally spaced grid of the total magnetic field
strength.
.TP
\f[B]\f[CB]n\f[B]\f[R] : output, integer(int32)
The number of samples in latitude of the output grids.
This is equal to \f[C]2lmax+2\f[R].
.TP
\f[B]\f[CB]sampling\f[B]\f[R] : optional, input, integer(int32), default = 1
If 1 (default) the output grids are equally sampled (\f[C]n\f[R] by
\f[C]n\f[R]).
If 2, the grids are equally spaced (\f[C]n\f[R] by 2\f[C]n\f[R]).
.TP
\f[B]\f[CB]lmaxcalc\f[B]\f[R] : optional, input, integer(int32), default = \f[B]\f[CB]lmax\f[B]\f[R]
The maximum spherical harmonic degree used in evaluating the functions.
This must be less than or equal to \f[C]lmax\f[R].
.TP
\f[B]\f[CB]potgrid\f[B]\f[R] : output, real(dp), dimension(nlat, nlong)
A 2D equally sampled or equaly spaced grid of the magnetic potential.
.TP
\f[B]\f[CB]extend\f[B]\f[R] : input, optional, integer(int32), default = 0
If 1, compute the longitudinal band for 360 E and the latitudinal band
for 90 S.
This increases each of the dimensions of the grids by 1.
.TP
\f[B]\f[CB]exitstatus\f[B]\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[C]MakeMagGridDH\f[R] will create 2-dimensional cylindrical maps from
the spherical harmonic coefficients \f[C]cilm\f[R] of all three
components of the magnetic field, the total field strength, and the
magnetic potential.
The magnetic potential is given by
.PP
\f[C]V = R0 Sum_{l=1}\[ha]LMAX (R0/r)\[ha]{l+1} Sum_{m=-l}\[ha]l C_{lm} Y_{lm}\f[R]
.PP
and the magnetic field is
.PP
\f[C]B = - Grad V\f[R].
.PP
The coefficients are referenced to a radius \f[C]r0\f[R], and the
function is computed on a flattened ellipsoid with semi-major axis
\f[C]a\f[R] (i.e., the mean equatorial radius) and flattening
\f[C]f\f[R].
.PP
The default is to use an input grid that is equally sampled (\f[C]n\f[R]
by \f[C]n\f[R]), but this can be changed to use an equally spaced grid
(\f[C]n\f[R] by 2\f[C]n\f[R]) by the optional argument
\f[C]sampling\f[R].
The redundant longitudinal band for 360 E and the latitudinal band for
90 S are excluded by default, but these can be computed by specifying
the optional argument \f[C]extend\f[R].
.SH Reference
.PP
Driscoll, J.R.
and D.M.
Healy, Computing Fourier transforms and convolutions on the 2-sphere,
Adv.
Appl.
Math., 15, 202-250, 1994.

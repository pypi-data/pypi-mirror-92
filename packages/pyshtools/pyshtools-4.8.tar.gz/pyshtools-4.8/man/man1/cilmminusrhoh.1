.\" Automatically generated by Pandoc 2.11.3.2
.\"
.TH "cilmminusrhoh" "1" "2020-12-16" "Fortran 95" "SHTOOLS 4.8"
.hy
.SH CilmMinusRhoH
.PP
Calculate the gravitational potential interior to relief referenced to a
spherical interface with laterally varying density using the finite
amplitude algorithm of Wieczorek (2007).
.SH Usage
.PP
call CilmMinusRhoH (\f[C]cilm\f[R], \f[C]gridin\f[R], \f[C]lmax\f[R],
\f[C]nmax\f[R], \f[C]mass\f[R], \f[C]d\f[R], \f[C]rho\f[R],
\f[C]gridtype\f[R], \f[C]w\f[R], \f[C]zero\f[R], \f[C]plx\f[R],
\f[C]n\f[R], \f[C]dref\f[R], \f[C]exitstatus\f[R])
.SH Parameters
.TP
\f[B]\f[CB]cilm\f[B]\f[R] : output, real(dp), dimension (2, \f[B]\f[CB]lmax\f[B]\f[R]+1, \f[B]\f[CB]lmax\f[B]\f[R]+1)
The real spherical harmonic coefficients (geodesy normalized) of the
gravitational potential corresponding to constant density relief
referenced to a spherical interface of radius \f[C]d\f[R].
.TP
\f[B]\f[CB]gridin\f[B]\f[R] : input, real(dp), dimension (\f[B]\f[CB]lmax\f[B]\f[R]+1, 2*\f[B]\f[CB]lmax\f[B]\f[R]+1) for gridtype 1, (\f[B]\f[CB]n\f[B]\f[R], \f[B]\f[CB]n\f[B]\f[R]) for gridtype 2, (\f[B]\f[CB]n\f[B]\f[R], 2*\f[B]\f[CB]n\f[B]\f[R]) for gridtype 3
The radii of the interface evaluated on a grid corresponding to a
function of maximum spherical harmonic degree \f[C]lmax\f[R].
This is calculated by a call to either \f[C]MakeGridGLQ\f[R] or
\f[C]MakeGridDH\f[R].
.TP
\f[B]\f[CB]lmax\f[B]\f[R] : input, integer(int32)
The maximum spherical harmonic degree of the output spherical harmonic
coefficients.
This degree also determines the dimension of the input relief
\f[C]gridin\f[R] for \f[C]gridtype\f[R] 1.
For Driscoll-Healy grids, \f[C]lmax\f[R] must be less than or equal to
\f[C]n/2-1\f[R].
.TP
\f[B]\f[CB]nmax\f[B]\f[R] : input, integer(int32)
The maximum order used in the Taylor-series expansion used in
calculating the potential coefficients.
.TP
\f[B]\f[CB]mass\f[B]\f[R] : input, real(dp)
The mass of the planet in kg.
.TP
\f[B]\f[CB]d\f[B]\f[R] : output, real(dp)
The mean radius of the relief in meters.
.TP
\f[B]\f[CB]rho\f[B]\f[R] : input, real(dp), dimension (\f[B]\f[CB]lmax\f[B]\f[R]+1, 2*\f[B]\f[CB]lmax\f[B]\f[R]+1) for gridtype 1, (\f[B]\f[CB]n\f[B]\f[R], \f[B]\f[CB]n\f[B]\f[R]) for gridtype 2, (\f[B]\f[CB]n\f[B]\f[R], 2*\f[B]\f[CB]n\f[B]\f[R]) for gridtype 3
The density contrast of the relief in kg/m\[ha]3 expressed on a grid
with the same dimensions as \f[C]gridin\f[R].
.TP
\f[B]\f[CB]gridtype\f[B]\f[R] : input, integer(int32)
1 = Gauss-Legendre grids, calculated using \f[C]SHGLQ\f[R] and
\f[C]MakeGridGLQ>\f[R].
2 = Equally sampled Driscoll-Healy grids, \f[C]n\f[R] by \f[C]n\f[R],
calculated using \f[C]MakeGridDH\f[R].
3 = Equally spaced Driscoll-Healy grids, \f[C]n\f[R] by 2\f[C]n\f[R],
calculated using \f[C]MakeGridDH\f[R].
.TP
\f[B]\f[CB]w\f[B]\f[R] : optional, input, real(dp), dimension (\f[B]\f[CB]lmax\f[B]\f[R]+1)
The weights used in the Gauss-Legendre quadrature, which are required
for \f[C]gridtype\f[R] = 1.
These are calculated from a call to \f[C]SHGLQ\f[R].
.TP
\f[B]\f[CB]zero\f[B]\f[R] : optional, input, real(dp), dimension (\f[B]\f[CB]lmax\f[B]\f[R]+1)
The nodes used in the Gauss-Legendre quadrature over latitude for
\f[C]gridtype\f[R] 1, calculated by a call to \f[C]SHGLQ\f[R].
One of \f[C]plx\f[R] or \f[C]zero\f[R] must be present when
\f[C]gridtype=1\f[R], but not both.
.TP
\f[B]\f[CB]plx\f[B]\f[R] : optional, input, real(dp), dimension (\f[B]\f[CB]lmax\f[B]\f[R]+1, (\f[B]\f[CB]lmax\f[B]\f[R]+1)*(\f[B]\f[CB]lmax\f[B]\f[R]+2)/2)
An array of the associated Legendre functions calculated at the nodes
used in the Gauss-Legendre quadrature for \f[C]gridtype\f[R] 1.
These are determined from a call to \f[C]SHGLQ\f[R].
One of \f[C]plx\f[R] or \f[C]zero\f[R] must be present when
\f[C]gridtype=1\f[R], but not both.
.TP
\f[B]\f[CB]n\f[B]\f[R] : optional, input, integer(int32)
The number of samples in latitude when using Driscoll-Healy grids.
For a function bandlimited to \f[C]lmax\f[R], \f[C]n=2(lmax+1)\f[R].
This is required for gridtypes 2 and 3.
.TP
\f[B]\f[CB]dref\f[B]\f[R] : optional, input, real(dp)
The reference radius to be used when calculating both the relief and
spherical harmonic coefficients.
If this is not specified, this parameter will be set equal to the mean
radius of \f[C]gridin\f[R].
.TP
\f[B]\f[CB]exitstatus\f[B]\f[R] : output, optional, integer(int32)
If present, instead of executing a STOP when an error is encountered,
the variable exitstatus will be returned describing the error.
0 = No errors; 1 = Improper dimensions of input array; 2 = Improper
bounds for input variable; 3 = Error allocating memory; 4 = File IO
error.
.SH Description
.PP
\f[C]CilmMinusRhoH\f[R] will calculate the spherical harmonic
coefficients of the gravitational potential interior to relief
referenced to a spherical interface with laterally varying density.
This is a generalization of equation 30 of Wieczorek (2007), and
equation 12 of Wieczorek and Phillips (1998).
The potential is strictly valid only when the coefficients are evaluated
at a radius greater than the maximum radius of the relief.
The relief and laterally varying density are input as a grid, whose type
is specified by \f[C]gridtype\f[R] (1 for Gauss-Legendre quadrature
grids, 2 for \f[C]n\f[R] by \f[C]n\f[R] Driscoll and Healy sampled
grids, and 3 for \f[C]n\f[R] by 2\f[C]n\f[R] Driscoll and Healy sampled
grids).
The input relief \f[C]gridin\f[R] must correspond to absolute radii.
The parameter \f[C]nmax\f[R] is the order of the Taylor series used in
the algorithm to approximate the potential coefficients.
By default, the relief and spherical harmonic coefficients will be
referenced to the mean radius of \f[C]gridin\f[R].
However, if the optional parameter \f[C]dref\f[R] is specified, this
will be used instead as the reference radius.
.PP
It is important to understand that as an intermediate step, this routine
calculates the spherical harmonic coefficients of the density multiplied
by the relief (referenced to the mean radius of \f[C]gridin\f[R] or
\f[C]dref\f[R]) raised to the nth power.
As such, if the input function is bandlimited to degree \f[C]L\f[R], the
resulting function will be bandlimited to degree \f[C]L*nmax\f[R].
This subroutine implicitly assumes that \f[C]gridin\f[R] and
\f[C]rho\f[R] have an effective spherical harmonic bandwidth greater or
equal to this value.
(The effective bandwidth is equal to \f[C]lmax\f[R] for
\f[C]gridtype\f[R] 1, and is \f[C]n/2-1\f[R] for \f[C]gridtype\f[R] 2 or
3.) If this is not the case, aliasing will occur.
In practice, for accurate results, it is found that the effective
bandwidth needs only to be about three times the size of \f[C]L\f[R],
though this should be verified for each application.
Thus, if the input function is considered to be bandlimited to degree
\f[C]L\f[R], the function should be evaluated on a grid corresponding to
a maximum degree of about \f[C]3*\f[R]L.
Aliasing effects can be partially mitigated by using Driscoll and Healy
\f[C]n\f[R] by 2\f[C]n\f[R] grids.
.PP
If the input grid is evaluated on the Gauss-Legendre points, it is
necessary to specify the optional parameters \f[C]w\f[R] and
\f[C]zero\f[R], or \f[C]w\f[R] and \f[C]plx\f[R], which are calculated
by a call to \f[C]SHGLQ\f[R].
In contast, if Driscoll-Healy grids are used, it is necessary to specify
the optional parameter \f[C]n\f[R].
If memory is not an issue, the algorithm can be speeded up when using
Gauss-Lengendre grids by inputing the optional array \f[C]plx\f[R]
(along with \f[C]w\f[R]) of precomputed associated Legendre functions on
the Gauss-Legendre nodes.
Both of these variables are computed by a call to \f[C]SHGLQ\f[R].
.PP
This routine uses geodesy 4-pi normalized spherical harmonics that
exclude the Condon-Shortley phase.
.SH References
.PP
Wieczorek, M.
A.
and R.
J.
Phillips, Potential anomalies on a sphere: applications to the thickness
of the lunar crust, J.
Geophys.
Res., 103, 1715-1724, 1998.
.PP
Wieczorek, M.
A., Gravity and topography of the terrestrial planets, Treatise on
Geophysics, 10, 165-206, doi:10.1016/B978-044452748-6/00156-5, 2007.
.SH See also
.PP
cilmminus, cilmplus, cilmplusrhoh, makegridglq, makegriddh, shglq,
glqgridcoord

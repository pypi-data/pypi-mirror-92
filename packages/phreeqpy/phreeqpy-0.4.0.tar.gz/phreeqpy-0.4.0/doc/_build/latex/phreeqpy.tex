%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{times}
\expandafter\ifx\csname T@LGR\endcsname\relax
\else
% LGR was declared as font encoding
  \substitutefont{LGR}{\rmdefault}{cmr}
  \substitutefont{LGR}{\sfdefault}{cmss}
  \substitutefont{LGR}{\ttdefault}{cmtt}
\fi
\expandafter\ifx\csname T@X2\endcsname\relax
  \expandafter\ifx\csname T@T2A\endcsname\relax
  \else
  % T2A was declared as font encoding
    \substitutefont{T2A}{\rmdefault}{cmr}
    \substitutefont{T2A}{\sfdefault}{cmss}
    \substitutefont{T2A}{\ttdefault}{cmtt}
  \fi
\else
% X2 was declared as font encoding
  \substitutefont{X2}{\rmdefault}{cmr}
  \substitutefont{X2}{\sfdefault}{cmss}
  \substitutefont{X2}{\ttdefault}{cmtt}
\fi


\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}


\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}



\title{PhreeqPy Documentation}
\date{Jan 23, 2021}
\release{0.4.0}
\author{Mike Müller\\\\ http://www.hydrocomputing.com}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{contents::doc}}



\chapter{PhreeqPy \sphinxhyphen{} Python Tools for PHREEQC}
\label{\detokenize{index:phreeqpy-python-tools-for-phreeqc}}\label{\detokenize{index::doc}}

\section{Introduction}
\label{\detokenize{index:introduction}}
PhreeqPy is Open Source software and provides Python tools to work with
\sphinxhref{http://wwwbrr.cr.usgs.gov/projects/GWC\_coupled/phreeqc/index.html}{PHREEQC}.

Currently it provides access to the new \sphinxhref{ftp://brrftp.cr.usgs.gov/pub/charlton/iphreeqc/IPhreeqc.pdf}{IPhreeqc} interface without the need to
run a COM server and therefore also works on non\sphinxhyphen{}Windows systems.
IPhreeqc is described in more detail in this \sphinxhref{http://www.sciencedirect.com/science/article/pii/S0098300411000653}{publication}.

\sphinxhref{contact.html}{Please let us know} what you do with PhreeqPy or if things do not work
as expected. There is a
\sphinxhref{https://groups.google.com/forum/\#!forum/phreeqpy-users}{mailing list for PhreeqPy}.
Please \sphinxhref{mailto:phreeqpy-users+subscribe@googlegroups.com?subject=Subscribe}{subscribe} to get your questions about PhreeqPy answered.

\sphinxhref{phreeqpy.pdf}{Download latest version of this documentation as PDF}

\sphinxstylestrong{License}: BSD


\section{Installation}
\label{\detokenize{index:installation}}\label{\detokenize{index:id1}}
\sphinxstylestrong{Pythons (tested)}: Python 2.6, 2.7, 3.3, 3.4, 3.5, 3.6, 3.8, 3.7, 3.9 PyPy

\sphinxstylestrong{Pythons (untested but should work since using ctypes)}: IronPython, Jython 2.7

\sphinxstylestrong{Platforms}: Unix/Posix and Windows

\sphinxstylestrong{PyPI package name}: \sphinxhref{http://pypi.python.org/pypi/phreeqpy}{phreeqpy}

Installation with \sphinxtitleref{pip}:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{o}{\PYGZhy{}}\PYG{n}{U} \PYG{n}{phreeqpy}
\end{sphinxVerbatim}

You need an IPhreeqc shared libray for your operating system.
PhreeqPy comes with shared libraries for 32\sphinxhyphen{}bit Windows, 32\sphinxhyphen{}bit Linux and
64\sphinxhyphen{}bit Mac OS X.
There is no 64\sphinxhyphen{}bit Windows distributed with PhreeqPy.
Please install the {\color{red}\bfseries{}\textasciigrave{}Windows COM 64\sphinxhyphen{}bit\textasciigrave{}\_} module of IPhreeqc and use
\sphinxtitleref{phreeqpy.iphreeqc.phreeqc\_com as phreeqc\_mod} instead of
\sphinxtitleref{import phreeqpy.iphreeqc.phreeqc\_dll as phreeqc\_mod} as shown in the example.
If you use Anaconda or Miniconda make sure to:
\begin{quote}

conda install pywin32
\end{quote}

before you install PhreeqPy.

You may download an appropriate library from here:
\sphinxurl{ftp://brrftp.cr.usgs.gov/pub/charlton/iphreeqc/}

For example for Linux:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{wget} \PYG{n}{ftp}\PYG{p}{:}\PYG{o}{/}\PYG{o}{/}\PYG{n}{brrftp}\PYG{o}{.}\PYG{n}{cr}\PYG{o}{.}\PYG{n}{usgs}\PYG{o}{.}\PYG{n}{gov}\PYG{o}{/}\PYG{n}{pub}\PYG{o}{/}\PYG{n}{charlton}\PYG{o}{/}\PYG{n}{iphreeqc}\PYG{o}{/}\PYG{n}{iphreeqc}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.18}\PYG{o}{.}\PYG{l+m+mi}{4}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{6386.}\PYG{n}{tar}\PYG{o}{.}\PYG{n}{gz}
\PYG{n}{tar} \PYG{o}{\PYGZhy{}}\PYG{n}{xzvf} \PYG{n}{iphreeqc}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.18}\PYG{o}{.}\PYG{l+m+mi}{4}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{6386.}\PYG{n}{tar}\PYG{o}{.}\PYG{n}{gz}
\PYG{n}{cd} \PYG{n}{iphreeqc}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{2.18}\PYG{o}{.}\PYG{l+m+mi}{4}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{6386}
\PYG{o}{.}\PYG{o}{/}\PYG{n}{configure}
\PYG{n}{make}
\PYG{n}{make} \PYG{n}{check}
\PYG{n}{sudo} \PYG{n}{make} \PYG{n}{install}
\end{sphinxVerbatim}

Then either use the full path to the shared libray when making an instance of
\sphinxcode{\sphinxupquote{phreeqc\_dll.IPhreeqc}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{phreeqc} \PYG{o}{=} \PYG{n}{phreeqpy}\PYG{o}{.}\PYG{n}{iphreeqc}\PYG{o}{.}\PYG{n}{phreeqc\PYGZus{}dll}\PYG{o}{.}\PYG{n}{IPhreeqc}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/full/path/to/libiphreeqc.so}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

or copy the shared object into \sphinxcode{\sphinxupquote{phreeqpy/iphreeqc}} replacing the existing
one. For example:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sudo} \PYG{n}{cp} \PYG{o}{/}\PYG{n}{usr}\PYG{o}{/}\PYG{n}{local}\PYG{o}{/}\PYG{n}{lib}\PYG{o}{/}\PYG{n}{libiphreeqc}\PYG{o}{.}\PYG{n}{so}  \PYG{o}{/}\PYG{n}{path}\PYG{o}{/}\PYG{n}{to}\PYG{o}{/}\PYG{n}{site}\PYG{o}{\PYGZhy{}}\PYG{n}{pacges}\PYG{o}{/}\PYG{n}{PhreeqPy}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{0.2}\PYG{o}{.}\PYG{l+m+mi}{0}\PYG{o}{\PYGZhy{}}\PYG{n}{py2}\PYG{o}{.}\PYG{l+m+mf}{7.}\PYG{n}{egg}\PYG{o}{/}\PYG{n}{phreeqpy}\PYG{o}{/}\PYG{n}{iphreeqc}\PYG{o}{/}\PYG{n}{libiphreeqc}\PYG{o}{.}\PYG{n}{so}\PYG{o}{.}\PYG{l+m+mf}{0.0}\PYG{o}{.}\PYG{l+m+mi}{0}
\end{sphinxVerbatim}


\section{Benchmark Test Comparing PhreeqPy to External Processes, COM and C++}
\label{\detokenize{index:benchmark-test-comparing-phreeqpy-to-external-processes-com-and-c}}
This publication demonstrates how PhreeqPy can be used for reactive transport
modeling.

Müller M., Parkhurst D.L., Charlton S.R. (2011)
\sphinxhref{download/Mueller\_etal\_MODFLOWandMORE2011\_Proceedings.pdf}{Programming PHREEQC Calculations with C++ and Python \sphinxhyphen{} A Comparative Study} ,
In: Maxwell R., Poeter E., Hill M., Zheng C. (2011) MODFLOW and More 2011 \sphinxhyphen{}
Integrated Hydrological Modeling, Proceedings, pp. 632 \sphinxhyphen{} 636.


\chapter{Class IPhreeqc}
\label{\detokenize{iphreeqc:class-iphreeqc}}\label{\detokenize{iphreeqc::doc}}
This is the main class to work with the IPhreeqc interface.

You can {\hyperref[\detokenize{index:installation}]{\sphinxcrossref{\DUrole{std,std-ref}{add your own shared library for IPhreeqc}}}}.

\phantomsection\label{\detokenize{iphreeqc:module-phreeqpy.iphreeqc.phreeqc_dll}}\index{module@\spxentry{module}!phreeqpy.iphreeqc.phreeqc\_dll@\spxentry{phreeqpy.iphreeqc.phreeqc\_dll}}\index{phreeqpy.iphreeqc.phreeqc\_dll@\spxentry{phreeqpy.iphreeqc.phreeqc\_dll}!module@\spxentry{module}}
Access PHREEQC\sphinxhyphen{}DLL via ctypes.

This is exchangeable with the COM interface.
\index{IPhreeqc (class in phreeqpy.iphreeqc.phreeqc\_dll)@\spxentry{IPhreeqc}\spxextra{class in phreeqpy.iphreeqc.phreeqc\_dll}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{phreeqpy.iphreeqc.phreeqc\_dll.}}\sphinxbfcode{\sphinxupquote{IPhreeqc}}}{\emph{\DUrole{n}{dll\_path}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
Wrapper for the IPhreeqc DLL.

Connect to DLL and create IPhreeqc.

The optional \sphinxtitleref{dll\_path} takes a path to the IPhreeqc shared library.
If not provided it tries to select an appropriate library.
Make sure you have the right library for your operating system.
You may download one from here:
\sphinxurl{ftp://brrftp.cr.usgs.gov/pub/charlton/iphreeqc/}

See the PhreeqPy documentation for help on compiling a IPhreeqc shared
library.
\index{accumulate\_line() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{accumulate\_line()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.accumulate_line}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{accumulate\_line}}}{\emph{\DUrole{n}{line}}}{}
Put line in input buffer.

\end{fulllineitems}

\index{add\_error() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{add\_error()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.add_error}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{add\_error}}}{\emph{\DUrole{n}{phc\_error\_msg}}}{}
Add an error message to Phreeqc.

\end{fulllineitems}

\index{add\_warning() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{add\_warning()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.add_warning}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{add\_warning}}}{\emph{\DUrole{n}{phc\_warn\_msg}}}{}
Add an warning message to Phreeqc.

\end{fulllineitems}

\index{clear\_accumlated\_lines() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{clear\_accumlated\_lines()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.clear_accumlated_lines}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{clear\_accumlated\_lines}}}{}{}
Clear the input buffer.

\end{fulllineitems}

\index{column\_count() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc property)@\spxentry{column\_count()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.column_count}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{column\_count}}}
Get number of columns in selected output.

\end{fulllineitems}

\index{component\_count() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc property)@\spxentry{component\_count()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.component_count}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{component\_count}}}
Return the number of components.

\end{fulllineitems}

\index{create\_iphreeqc() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{create\_iphreeqc()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.create_iphreeqc}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{create\_iphreeqc}}}{}{}
Create a IPhreeqc object.

\end{fulllineitems}

\index{destroy\_iphreeqc() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{destroy\_iphreeqc()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.destroy_iphreeqc}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{destroy\_iphreeqc}}}{}{}
Delete the current instance of IPhreeqc.

\end{fulllineitems}

\index{get\_component() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{get\_component()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_component}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_component}}}{\emph{\DUrole{n}{index}}}{}
Get one component.

\end{fulllineitems}

\index{get\_component\_list() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{get\_component\_list()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_component_list}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_component\_list}}}{}{}
Return all component names.

\end{fulllineitems}

\index{get\_error\_string() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{get\_error\_string()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_error_string}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_error\_string}}}{}{}
Retrieves the error messages.

\end{fulllineitems}

\index{get\_selected\_output\_array() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{get\_selected\_output\_array()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_selected_output_array}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_selected\_output\_array}}}{}{}
Get all values from selected output.

\end{fulllineitems}

\index{get\_selected\_output\_column() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{get\_selected\_output\_column()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_selected_output_column}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_selected\_output\_column}}}{\emph{\DUrole{n}{col}}}{}
Get all values for one column from selected output.

\end{fulllineitems}

\index{get\_selected\_output\_row() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{get\_selected\_output\_row()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_selected_output_row}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_selected\_output\_row}}}{\emph{\DUrole{n}{row}}}{}
Get all values for one from selected output.

\end{fulllineitems}

\index{get\_selected\_output\_value() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{get\_selected\_output\_value()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.get_selected_output_value}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_selected\_output\_value}}}{\emph{\DUrole{n}{row}}, \emph{\DUrole{n}{col}}}{}
Get one value from selected output at given row and column.

\end{fulllineitems}

\index{load\_database() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{load\_database()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.load_database}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{load\_database}}}{\emph{\DUrole{n}{database\_name}}}{}
Load a database with given file\_name.

\end{fulllineitems}

\index{load\_database\_string() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{load\_database\_string()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.load_database_string}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{load\_database\_string}}}{\emph{\DUrole{n}{input\_string}}}{}
Load a datbase from a string.

\end{fulllineitems}

\index{raise\_ipq\_error() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc static method)@\spxentry{raise\_ipq\_error()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.raise_ipq_error}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{static }}\sphinxbfcode{\sphinxupquote{raise\_ipq\_error}}}{\emph{\DUrole{n}{error\_code}}}{}
There was an error, raise an exception.

\end{fulllineitems}

\index{raise\_string\_error() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{raise\_string\_error()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.raise_string_error}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{raise\_string\_error}}}{\emph{\DUrole{n}{errors}}}{}
Raise an exception with message from IPhreeqc error.

\end{fulllineitems}

\index{row\_count() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc property)@\spxentry{row\_count()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.row_count}}\pysigline{\sphinxbfcode{\sphinxupquote{property }}\sphinxbfcode{\sphinxupquote{row\_count}}}
Get number of rows in selected output.

\end{fulllineitems}

\index{run\_string() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{run\_string()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.run_string}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{run\_string}}}{\emph{\DUrole{n}{cmd\_string}}}{}
Run PHREEQC input from string.

\end{fulllineitems}

\index{set\_output\_file\_off() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{set\_output\_file\_off()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.set_output_file_off}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{set\_output\_file\_off}}}{}{}
Turn on writing to selected output file.

\end{fulllineitems}

\index{set\_output\_file\_on() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{set\_output\_file\_on()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.set_output_file_on}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{set\_output\_file\_on}}}{}{}
Turn on writing to selected output file.

\end{fulllineitems}

\index{set\_selected\_output\_file\_off() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{set\_selected\_output\_file\_off()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.set_selected_output_file_off}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{set\_selected\_output\_file\_off}}}{}{}
Turn on writing to selected output file.

\end{fulllineitems}

\index{set\_selected\_output\_file\_on() (phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method)@\spxentry{set\_selected\_output\_file\_on()}\spxextra{phreeqpy.iphreeqc.phreeqc\_dll.IPhreeqc method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.IPhreeqc.set_selected_output_file_on}}\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{set\_selected\_output\_file\_on}}}{}{}
Turn on writing to selected output file.

\end{fulllineitems}


\end{fulllineitems}

\index{PhreeqcException@\spxentry{PhreeqcException}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.PhreeqcException}}\pysigline{\sphinxbfcode{\sphinxupquote{exception }}\sphinxcode{\sphinxupquote{phreeqpy.iphreeqc.phreeqc\_dll.}}\sphinxbfcode{\sphinxupquote{PhreeqcException}}}
Error in Phreeqc call.

\end{fulllineitems}

\index{VAR (class in phreeqpy.iphreeqc.phreeqc\_dll)@\spxentry{VAR}\spxextra{class in phreeqpy.iphreeqc.phreeqc\_dll}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.VAR}}\pysigline{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{phreeqpy.iphreeqc.phreeqc\_dll.}}\sphinxbfcode{\sphinxupquote{VAR}}}
Struct with data type and data values.

See Var.h in PHREEQC source.

\end{fulllineitems}

\index{VARUNION (class in phreeqpy.iphreeqc.phreeqc\_dll)@\spxentry{VARUNION}\spxextra{class in phreeqpy.iphreeqc.phreeqc\_dll}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{iphreeqc:phreeqpy.iphreeqc.phreeqc_dll.VARUNION}}\pysigline{\sphinxbfcode{\sphinxupquote{class }}\sphinxcode{\sphinxupquote{phreeqpy.iphreeqc.phreeqc\_dll.}}\sphinxbfcode{\sphinxupquote{VARUNION}}}
Union with types.

See Var.h in PHREEQC source.

\end{fulllineitems}



\chapter{Examples for PhreeqPy}
\label{\detokenize{examples:examples-for-phreeqpy}}\label{\detokenize{examples::doc}}
This is an example for the use PhreeqPy for one\sphinxhyphen{}dimensional advection.
It is the example 11 from the PHREEQC users manual.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Advection with DLL or COM server.}

\PYG{l+s+sd}{Using MODFIY we update the concentration on every}
\PYG{l+s+sd}{time step. We shift by one cell per step.}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}

\PYG{k+kn}{from} \PYG{n+nn}{\PYGZus{}\PYGZus{}future\PYGZus{}\PYGZus{}} \PYG{k+kn}{import} \PYG{n}{print\PYGZus{}function}

\PYG{k+kn}{import} \PYG{n+nn}{sys}

\PYG{c+c1}{\PYGZsh{} Simple Python 3 compatibility adjustment.}
\PYG{k}{if} \PYG{n}{sys}\PYG{o}{.}\PYG{n}{version\PYGZus{}info}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{==} \PYG{l+m+mi}{2}\PYG{p}{:}
    \PYG{n+nb}{range} \PYG{o}{=} \PYG{n}{xrange}

\PYG{k+kn}{import} \PYG{n+nn}{os}
\PYG{k+kn}{import} \PYG{n+nn}{timeit}

\PYG{n}{MODE} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dll}\PYG{l+s+s1}{\PYGZsq{}}  \PYG{c+c1}{\PYGZsh{} \PYGZsq{}dll\PYGZsq{} or \PYGZsq{}com\PYGZsq{}}

\PYG{k}{if} \PYG{n}{MODE} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{com}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
    \PYG{k+kn}{import} \PYG{n+nn}{phreeqpy}\PYG{n+nn}{.}\PYG{n+nn}{iphreeqc}\PYG{n+nn}{.}\PYG{n+nn}{phreeqc\PYGZus{}com} \PYG{k}{as} \PYG{n+nn}{phreeqc\PYGZus{}mod}
\PYG{k}{elif} \PYG{n}{MODE} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{dll}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
    \PYG{k+kn}{import} \PYG{n+nn}{phreeqpy}\PYG{n+nn}{.}\PYG{n+nn}{iphreeqc}\PYG{n+nn}{.}\PYG{n+nn}{phreeqc\PYGZus{}dll} \PYG{k}{as} \PYG{n+nn}{phreeqc\PYGZus{}mod}
\PYG{k}{else}\PYG{p}{:}
    \PYG{k}{raise} \PYG{n+ne}{Exception}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Mode }\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+si}{\PYGZpc{}s}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{ is not defined use }\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{com}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{ or }\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{dll}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{.}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{\PYGZpc{}} \PYG{n}{MODE}\PYG{p}{)}


\PYG{k}{def} \PYG{n+nf}{make\PYGZus{}initial\PYGZus{}conditions}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{    Specify initial conditions data blocks.}

\PYG{l+s+sd}{    Uniform initial conditions are assumed.}
\PYG{l+s+sd}{    \PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{initial\PYGZus{}conditions} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{    TITLE Example 11.\PYGZhy{}\PYGZhy{}Transport and ion exchange.}
\PYG{l+s+s2}{    SOLUTION 0  CaCl2}
\PYG{l+s+s2}{        units            mmol/kgw}
\PYG{l+s+s2}{        temp             25.0}
\PYG{l+s+s2}{        pH               7.0     charge}
\PYG{l+s+s2}{        pe               12.5    O2(g)   \PYGZhy{}0.68}
\PYG{l+s+s2}{        Ca               0.6}
\PYG{l+s+s2}{        Cl               1.2}
\PYG{l+s+s2}{    SOLUTION 1  Initial solution for column}
\PYG{l+s+s2}{        units            mmol/kgw}
\PYG{l+s+s2}{        temp             25.0}
\PYG{l+s+s2}{        pH               7.0     charge}
\PYG{l+s+s2}{        pe               12.5    O2(g)   \PYGZhy{}0.68}
\PYG{l+s+s2}{        Na               1.0}
\PYG{l+s+s2}{        K                0.2}
\PYG{l+s+s2}{        N(5)             1.2}
\PYG{l+s+s2}{        END}
\PYG{l+s+s2}{    EXCHANGE 1}
\PYG{l+s+s2}{        equilibrate 1}
\PYG{l+s+s2}{        X                0.0011}
\PYG{l+s+s2}{    END}
\PYG{l+s+s2}{        }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{k}{return} \PYG{n}{initial\PYGZus{}conditions}


\PYG{k}{def} \PYG{n+nf}{make\PYGZus{}selected\PYGZus{}output}\PYG{p}{(}\PYG{n}{components}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{    Build SELECTED\PYGZus{}OUTPUT data block}
\PYG{l+s+sd}{    \PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{headings} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZhy{}headings    cb    H    O    }\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{components}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{headings} \PYG{o}{+}\PYG{o}{=} \PYG{n}{components}\PYG{p}{[}\PYG{n}{i}\PYG{p}{]} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{selected\PYGZus{}output} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+s2}{    SELECTED\PYGZus{}OUTPUT}
\PYG{l+s+s2}{        \PYGZhy{}reset false}
\PYG{l+s+s2}{    USER\PYGZus{}PUNCH}
\PYG{l+s+s2}{    }\PYG{l+s+s2}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{selected\PYGZus{}output} \PYG{o}{+}\PYG{o}{=} \PYG{n}{headings} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{c+c1}{\PYGZsh{}}
    \PYG{c+c1}{\PYGZsh{} charge balance, H, and O}
    \PYG{c+c1}{\PYGZsh{}}
    \PYG{n}{code} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{10 w = TOT(}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{water}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{)}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{n}{code} \PYG{o}{+}\PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{20 PUNCH CHARGE\PYGZus{}BALANCE, TOTMOLE(}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{H}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{), TOTMOLE(}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{O}\PYG{l+s+s1}{\PYGZdq{}}\PYG{l+s+s1}{)}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{c+c1}{\PYGZsh{}}
    \PYG{c+c1}{\PYGZsh{} All other elements}
    \PYG{c+c1}{\PYGZsh{}}
    \PYG{n}{lino} \PYG{o}{=} \PYG{l+m+mi}{30}
    \PYG{k}{for} \PYG{n}{component} \PYG{o+ow}{in} \PYG{n}{components}\PYG{p}{:}
        \PYG{n}{code} \PYG{o}{+}\PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s1}{ PUNCH w*TOT(}\PYG{l+s+se}{\PYGZbs{}\PYGZdq{}}\PYG{l+s+si}{\PYGZpc{}s}\PYG{l+s+se}{\PYGZbs{}\PYGZdq{}}\PYG{l+s+s1}{)}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{lino}\PYG{p}{,} \PYG{n}{component}\PYG{p}{)}
        \PYG{n}{lino} \PYG{o}{+}\PYG{o}{=} \PYG{l+m+mi}{10}
    \PYG{n}{selected\PYGZus{}output} \PYG{o}{+}\PYG{o}{=} \PYG{n}{code}
    \PYG{k}{return} \PYG{n}{selected\PYGZus{}output}


\PYG{k}{def} \PYG{n+nf}{initialize}\PYG{p}{(}\PYG{n}{cells}\PYG{p}{,} \PYG{n}{first}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{    Initialize IPhreeqc module}
\PYG{l+s+sd}{    \PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{phreeqc} \PYG{o}{=} \PYG{n}{phreeqc\PYGZus{}mod}\PYG{o}{.}\PYG{n}{IPhreeqc}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{load\PYGZus{}database}\PYG{p}{(}\PYG{l+s+sa}{r}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{phreeqc.dat}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
    \PYG{n}{initial\PYGZus{}conditions} \PYG{o}{=} \PYG{n}{make\PYGZus{}initial\PYGZus{}conditions}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{run\PYGZus{}string}\PYG{p}{(}\PYG{n}{initial\PYGZus{}conditions}\PYG{p}{)}
    \PYG{n}{components} \PYG{o}{=} \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{get\PYGZus{}component\PYGZus{}list}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{selected\PYGZus{}output} \PYG{o}{=} \PYG{n}{make\PYGZus{}selected\PYGZus{}output}\PYG{p}{(}\PYG{n}{components}\PYG{p}{)}
    \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{run\PYGZus{}string}\PYG{p}{(}\PYG{n}{selected\PYGZus{}output}\PYG{p}{)}
    \PYG{n}{phc\PYGZus{}string} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{RUN\PYGZus{}CELLS; \PYGZhy{}cells 0\PYGZhy{}1}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{run\PYGZus{}string}\PYG{p}{(}\PYG{n}{phc\PYGZus{}string}\PYG{p}{)}
    \PYG{n}{conc} \PYG{o}{=} \PYG{n}{get\PYGZus{}selected\PYGZus{}output}\PYG{p}{(}\PYG{n}{phreeqc}\PYG{p}{)}
    \PYG{n}{inflow} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
    \PYG{n}{initial} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
    \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{conc}\PYG{p}{:}
        \PYG{k}{if} \PYG{n}{first}\PYG{p}{:}
            \PYG{n}{inflow}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]} \PYG{o}{=} \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
        \PYG{k}{else}\PYG{p}{:}
            \PYG{n}{inflow}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]} \PYG{o}{=} \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
        \PYG{n}{initial}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]} \PYG{o}{=} \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
    \PYG{n}{task} \PYG{o}{=} \PYG{n}{initial\PYGZus{}conditions} \PYG{o}{+} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{task} \PYG{o}{+}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{COPY solution 1 }\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s2}{\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{task} \PYG{o}{+}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{COPY exchange 1 }\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s2}{\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{task} \PYG{o}{+}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{END}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}
    \PYG{n}{task} \PYG{o}{+}\PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{RUN\PYGZus{}CELLS; \PYGZhy{}cells }\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s2}{\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
    \PYG{n}{task} \PYG{o}{+}\PYG{o}{=} \PYG{n}{selected\PYGZus{}output}
    \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{run\PYGZus{}string}\PYG{p}{(}\PYG{n}{task}\PYG{p}{)}
    \PYG{n}{conc} \PYG{o}{=} \PYG{n}{get\PYGZus{}selected\PYGZus{}output}\PYG{p}{(}\PYG{n}{phreeqc}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{conc}\PYG{p}{:}
        \PYG{n}{value} \PYG{o}{=} \PYG{p}{[}\PYG{n}{initial}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{]} \PYG{o}{*} \PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]} \PYG{o}{=} \PYG{n}{value}
    \PYG{k}{return} \PYG{n}{phreeqc}\PYG{p}{,} \PYG{n}{inflow}\PYG{p}{,} \PYG{n}{conc}


\PYG{k}{def} \PYG{n+nf}{advect\PYGZus{}step}\PYG{p}{(}\PYG{n}{phreeqc}\PYG{p}{,} \PYG{n}{inflow}\PYG{p}{,} \PYG{n}{conc}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Advect by shifting concentrations from previous time step.}
\PYG{l+s+sd}{    \PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{all\PYGZus{}names} \PYG{o}{=} \PYG{n}{conc}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{names} \PYG{o}{=} \PYG{p}{[}\PYG{n}{name} \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{all\PYGZus{}names} \PYG{k}{if} \PYG{n}{name} \PYG{o+ow}{not} \PYG{o+ow}{in} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{H}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{O}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{conc}\PYG{p}{:}
        \PYG{c+c1}{\PYGZsh{} shift one cell}
        \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{p}{]} \PYG{o}{=} \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{p}{:}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}
        \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]} \PYG{o}{=} \PYG{n}{inflow}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}
    \PYG{n}{modify} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{index}\PYG{p}{,} \PYG{n}{cell} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]} \PYG{o}{+} \PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{SOLUTION\PYGZus{}MODIFY }\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZpc{}} \PYG{n}{cell}\PYG{p}{)}
        \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{\PYGZhy{}cb      }\PYG{l+s+si}{\PYGZpc{}e}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZpc{}} \PYG{n}{conc}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{cb}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{index}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{\PYGZhy{}total\PYGZus{}h }\PYG{l+s+si}{\PYGZpc{}f}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZpc{}} \PYG{n}{conc}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{H}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{index}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{\PYGZhy{}total\PYGZus{}o }\PYG{l+s+si}{\PYGZpc{}f}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZpc{}} \PYG{n}{conc}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{O}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{[}\PYG{n}{index}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+s2}{\PYGZhy{}totals}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{names}\PYG{p}{:}
            \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+si}{\PYGZpc{}s}\PYG{l+s+se}{\PYGZbs{}t}\PYG{l+s+si}{\PYGZpc{}f}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{name}\PYG{p}{,} \PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{n}{index}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{modify}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{RUN\PYGZus{}CELLS; \PYGZhy{}cells }\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+s2}{\PYGZhy{}}\PYG{l+s+si}{\PYGZpc{}d}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}} \PYG{o}{\PYGZpc{}} \PYG{p}{(}\PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}
    \PYG{n}{cmd} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{o}{.}\PYG{n}{join}\PYG{p}{(}\PYG{n}{modify}\PYG{p}{)}
    \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{run\PYGZus{}string}\PYG{p}{(}\PYG{n}{cmd}\PYG{p}{)}
    \PYG{n}{conc} \PYG{o}{=} \PYG{n}{get\PYGZus{}selected\PYGZus{}output}\PYG{p}{(}\PYG{n}{phreeqc}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{conc}


\PYG{k}{def} \PYG{n+nf}{get\PYGZus{}selected\PYGZus{}output}\PYG{p}{(}\PYG{n}{phreeqc}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Return calculation result as dict.}

\PYG{l+s+sd}{    Header entries are the keys and the columns}
\PYG{l+s+sd}{    are the values as lists of numbers.}
\PYG{l+s+sd}{    \PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{output} \PYG{o}{=} \PYG{n}{phreeqc}\PYG{o}{.}\PYG{n}{get\PYGZus{}selected\PYGZus{}output\PYGZus{}array}\PYG{p}{(}\PYG{p}{)}
    \PYG{n}{header} \PYG{o}{=} \PYG{n}{output}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}
    \PYG{n}{conc} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
    \PYG{k}{for} \PYG{n}{head} \PYG{o+ow}{in} \PYG{n}{header}\PYG{p}{:}
        \PYG{n}{conc}\PYG{p}{[}\PYG{n}{head}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{row} \PYG{o+ow}{in} \PYG{n}{output}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{:}\PYG{p}{]}\PYG{p}{:}
        \PYG{k}{for} \PYG{n}{col}\PYG{p}{,} \PYG{n}{head} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{header}\PYG{p}{)}\PYG{p}{:}
            \PYG{n}{conc}\PYG{p}{[}\PYG{n}{head}\PYG{p}{]}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{row}\PYG{p}{[}\PYG{n}{col}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{conc}


\PYG{k}{def} \PYG{n+nf}{run}\PYG{p}{(}\PYG{n}{ncells}\PYG{p}{,} \PYG{n}{shifts}\PYG{p}{,} \PYG{n}{specie\PYGZus{}names}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Do one run in one process.}
\PYG{l+s+sd}{    \PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{cells} \PYG{o}{=} \PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{ncells}\PYG{p}{)}
    \PYG{n}{phreeqc}\PYG{p}{,} \PYG{n}{inflow}\PYG{p}{,} \PYG{n}{conc} \PYG{o}{=} \PYG{n}{initialize}\PYG{p}{(}\PYG{n}{cells}\PYG{p}{,} \PYG{n}{first}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
    \PYG{n}{outflow} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}
    \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{specie\PYGZus{}names}\PYG{p}{:}
        \PYG{n}{outflow}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{\PYGZus{}counter} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{shifts}\PYG{p}{)}\PYG{p}{:}
        \PYG{c+c1}{\PYGZsh{} advect}
        \PYG{n}{conc} \PYG{o}{=} \PYG{n}{advect\PYGZus{}step}\PYG{p}{(}\PYG{n}{phreeqc}\PYG{p}{,} \PYG{n}{inflow}\PYG{p}{,} \PYG{n}{conc}\PYG{p}{,} \PYG{n}{cells}\PYG{p}{)}
        \PYG{k}{for} \PYG{n}{name} \PYG{o+ow}{in} \PYG{n}{specie\PYGZus{}names}\PYG{p}{:}
            \PYG{n}{outflow}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{conc}\PYG{p}{[}\PYG{n}{name}\PYG{p}{]}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{outflow}


\PYG{k}{def} \PYG{n+nf}{write\PYGZus{}outflow}\PYG{p}{(}\PYG{n}{file\PYGZus{}name}\PYG{p}{,} \PYG{n}{outflow}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Write the outflow values to a file.}
\PYG{l+s+sd}{    \PYGZdq{}\PYGZdq{}\PYGZdq{}}
    \PYG{n}{fobj} \PYG{o}{=} \PYG{n+nb}{open}\PYG{p}{(}\PYG{n}{file\PYGZus{}name}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{w}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{header} \PYG{o}{=} \PYG{n}{outflow}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{head} \PYG{o+ow}{in} \PYG{n}{header}\PYG{p}{:}
        \PYG{n}{fobj}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZpc{}20s}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{\PYGZpc{}} \PYG{n}{head}\PYG{p}{)}
    \PYG{n}{fobj}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{k}{for} \PYG{n}{lineno} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{outflow}\PYG{p}{[}\PYG{n}{head}\PYG{p}{]}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{for} \PYG{n}{head} \PYG{o+ow}{in} \PYG{n}{header}\PYG{p}{:}
            \PYG{n}{fobj}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+si}{\PYGZpc{}20.17f}\PYG{l+s+s1}{\PYGZsq{}} \PYG{o}{\PYGZpc{}} \PYG{n}{outflow}\PYG{p}{[}\PYG{n}{head}\PYG{p}{]}\PYG{p}{[}\PYG{n}{lineno}\PYG{p}{]}\PYG{p}{)}
        \PYG{n}{fobj}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}


\PYG{k}{def} \PYG{n+nf}{main}\PYG{p}{(}\PYG{n}{ncells}\PYG{p}{,} \PYG{n}{shifts}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Run different versions with and without multiprocessing}
\PYG{l+s+sd}{    \PYGZdq{}\PYGZdq{}\PYGZdq{}}

    \PYG{k}{def} \PYG{n+nf}{measure\PYGZus{}time}\PYG{p}{(}\PYG{n}{func}\PYG{p}{,} \PYG{o}{*}\PYG{n}{args}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}\PYG{p}{:}
        \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}Convinience function to measure run times.}
\PYG{l+s+sd}{        \PYGZdq{}\PYGZdq{}\PYGZdq{}}
        \PYG{n}{start} \PYG{o}{=} \PYG{n}{timeit}\PYG{o}{.}\PYG{n}{default\PYGZus{}timer}\PYG{p}{(}\PYG{p}{)}
        \PYG{n}{result} \PYG{o}{=} \PYG{n}{func}\PYG{p}{(}\PYG{o}{*}\PYG{n}{args}\PYG{p}{,} \PYG{o}{*}\PYG{o}{*}\PYG{n}{kwargs}\PYG{p}{)}
        \PYG{k}{return} \PYG{n}{result}\PYG{p}{,} \PYG{n}{timeit}\PYG{o}{.}\PYG{n}{default\PYGZus{}timer}\PYG{p}{(}\PYG{p}{)} \PYG{o}{\PYGZhy{}} \PYG{n}{start}

    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Dimensions}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{==========}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{number of cells:   }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{ncells}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{number of shifts   }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{shifts}\PYG{p}{)}
    \PYG{n}{specie\PYGZus{}names} \PYG{o}{=} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Ca}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Cl}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{K}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{N}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Na}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{outflow}\PYG{p}{,} \PYG{n}{run\PYGZus{}time} \PYG{o}{=} \PYG{n}{measure\PYGZus{}time}\PYG{p}{(}\PYG{n}{run}\PYG{p}{,} \PYG{n}{ncells}\PYG{p}{,} \PYG{n}{shifts}\PYG{p}{,} \PYG{n}{specie\PYGZus{}names}\PYG{p}{)}
    \PYG{k}{if} \PYG{o+ow}{not} \PYG{n}{os}\PYG{o}{.}\PYG{n}{path}\PYG{o}{.}\PYG{n}{exists}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{os}\PYG{o}{.}\PYG{n}{mkdir}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{write\PYGZus{}outflow}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{data/out.txt}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{outflow}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{run time:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{run\PYGZus{}time}\PYG{p}{)}
    \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Finished simulation}\PYG{l+s+se}{\PYGZbs{}n}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:}
    \PYG{n}{main}\PYG{p}{(}\PYG{n}{ncells}\PYG{o}{=}\PYG{l+m+mi}{40}\PYG{p}{,} \PYG{n}{shifts}\PYG{o}{=}\PYG{l+m+mi}{120}\PYG{p}{)}
\end{sphinxVerbatim}


\chapter{Changelog history}
\label{\detokenize{changelog:changelog-history}}\label{\detokenize{changelog:changelog}}\label{\detokenize{changelog::doc}}

\section{Changes between versions 0.2 and 0.3}
\label{\detokenize{changelog:changes-between-versions-0-2-and-0-3}}\begin{itemize}
\item {} 
Added \sphinxtitleref{set\_output\_file\_off()\textasciigrave{}and \textasciigrave{}set\_output\_file\_on()} that call IPhreeqc’s \sphinxtitleref{SetOutputFileOn}

\end{itemize}


\section{Changes between versions 0.1 and 0.2}
\label{\detokenize{changelog:changes-between-versions-0-1-and-0-2}}\begin{itemize}
\item {} 
Added more IPhreeqc functions.

\item {} 
Added support for Mac OS X.

\item {} 
Added error handling turning IPhreeqc errors into Python exceptions.

\item {} 
Added Python 3 compatibility. Tested with Python 3.3.

\item {} 
Added documentation in addition to example on website.

\end{itemize}


\chapter{Contact}
\label{\detokenize{contact:contact}}\label{\detokenize{contact::doc}}
\begin{DUlineblock}{0em}
\item[] hydrocomputing GmbH \& Co. KG
\item[] Zur Schule 20
\item[] 04158 Leipzig
\item[] Germany
\end{DUlineblock}

\begin{DUlineblock}{0em}
\item[] Tel: +49 341 525 599 54
\item[] Fax: +49 341 520 4495
\item[] mail: info {[}at{]} hydrocomputing {[}dot{]} com
\item[] www: \sphinxurl{http://www.hydrocomputing.com}
\end{DUlineblock}


\chapter{Datenschutzerklärung}
\label{\detokenize{datenschutz:datenschutzerklarung}}\label{\detokenize{datenschutz::doc}}
Diese Seite beschreibt die Erhebung, Verarbeitung und Nutzung Ihrer
personenbezogenen Daten beim Besuch dieser Website.
Ihre Daten werden im Rahmen der gesetzlichen Vorschriften geschützt.
Sie erfahren hier, welche Daten während Ihres Besuchs auf der Website erfasst
und wie diese genutzt werden.

Über diese Website erheben wir keine personenbezogenen Daten.


\section{1. Datenerhebung und \sphinxhyphen{}protokollierung}
\label{\detokenize{datenschutz:datenerhebung-und-protokollierung}}
Wir speichern von Ihrem Besuch Log\sphinxhyphen{}Dateien mit diesem Inhalt:
\begin{itemize}
\item {} 
pseudonymisierte IP\sphinxhyphen{}Adresse (ohne Personenbezug, siehe Erklärung unten)

\item {} 
Datum und Uhrzeit des Zugriffs

\item {} 
Art des Zugriffes (z.B. GET oder POST)

\item {} 
besuchten Seiten innerhalb unseres Angebots

\item {} 
Protokoll (z.B. HTTP 1.1)

\item {} 
übertragene Datenmenge

\item {} 
Meldung über erfolgreichen Abruf

\item {} 
anfragende Domain (z.B. google.com)

\item {} 
Webbrowser und Betriebssystem

\end{itemize}

Bei uns werden nur pseudonymisierte IP\sphinxhyphen{}Adressen von Besuchern der Website
gespeichert.
Auf Webserver\sphinxhyphen{}Ebene erfolgt dies dadurch, dass im Logfile standardmäßig stat
der tatsächlichen IP\sphinxhyphen{}Adresse des Besuchers z.B. 123.123.123.123 eine
IP\sphinxhyphen{}Adresse 123.123.123.XXX gespeichert wird, wobei XXX ein Zufallswert
zwischen 1 und 254 ist.
Die Herstellung eines Personenbezuges ist nicht mehr möglich.


\section{2. Verwendung von Cookies}
\label{\detokenize{datenschutz:verwendung-von-cookies}}
Wir verwenden keine Cookies.


\chapter{Data Protection Statement}
\label{\detokenize{datenschutz:data-protection-statement}}
\sphinxstylestrong{English Version for your convenience.
The German version below is the legally binding one.}

This page describes the collection, processing, and usage of your
personal data while visiting this website.
Your data is protected within the legal regulations.
This page explains what data are collected while visiting this website
and how they are used.

We do not collect personal via this website.


\section{1. Data Collection and Data  Logging}
\label{\detokenize{datenschutz:data-collection-and-data-logging}}
We store log files about your visit with this content:
\begin{itemize}
\item {} 
pseudonymised IP (no person identity can be establish, see explain below)

\item {} 
date and time of access

\item {} 
type of access (e.g. GET or POST)

\item {} 
visited page on website

\item {} 
protocol (e.g. HTTP 1.1)

\item {} 
amount of transmitted data

\item {} 
referring domain (e.g. google.com)

\item {} 
type of webbrowser

\end{itemize}

We do not save hostname or Ip address of your request.
The collected data is not personal and don’t allow to find out
who is visiting our website.

We only store pseudonymised IP addresses of visitors to the website.
At the web server level, this happens by default by storing an IP address
123.123.123.XXX in the log file instead of the visitor’s actual IP address,
for example, 123.123.123.123.
The “XXX” is a random value between 1 and 254, so it is no longer possible to
establish the true identity of the visitor.


\section{2. Use of Cookies}
\label{\detokenize{datenschutz:use-of-cookies}}
We do not use cookies.


\chapter{Indices and tables}
\label{\detokenize{contents:indices-and-tables}}\begin{itemize}
\item {} 
\DUrole{xref,std,std-ref}{genindex}

\item {} 
\DUrole{xref,std,std-ref}{modindex}

\item {} 
\DUrole{xref,std,std-ref}{search}

\end{itemize}


\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{p}
\item\relax\sphinxstyleindexentry{phreeqpy.iphreeqc.phreeqc\_dll}\sphinxstyleindexpageref{iphreeqc:\detokenize{module-phreeqpy.iphreeqc.phreeqc_dll}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Writing PB in file &mdash; PBxplore 1.3.5 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PBxplore 1.3.5 documentation" href="../index.html"/>
        <link rel="up" title="API Cookbook" href="../api_cookbook.html"/>
        <link rel="next" title="Visualize protein deformability" href="Deformability.html"/>
        <link rel="prev" title="PB assignation" href="Assignement.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PBxplore
          

          
          </a>

          
            
            
              <div class="version">
                1.3.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro_PB.html">Protein Blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilization.html">Utilization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PBassign.html">PBassign</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PBcount.html">PBcount</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PBstat.html">PBstat</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api_cookbook.html">API Cookbook</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api_cookbook.html#pbxplore-structure">PBxplore.structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_cookbook.html#pbxplore-io">PBxplore.io</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api_cookbook.html#pbxplore-analysis">PBxplore.analysis</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Assignement.html">PB assignation</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Writing PB in file</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#fasta-files">Fasta files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dihedral-angles">Dihedral angles</a></li>
<li class="toctree-l4"><a class="reference internal" href="#read-fasta-files">Read fasta files</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Deformability.html">Visualize protein deformability</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">PBxplore</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../api_cookbook.html">API Cookbook</a> &raquo;</li>
      
    <li>Writing PB in file</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/notebooks/WritePB.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="writing-pb-in-file">
<h1>Writing PB in file<a class="headerlink" href="#writing-pb-in-file" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#fasta-files" id="id1">Fasta files</a></li>
<li><a class="reference internal" href="#dihedral-angles" id="id2">Dihedral angles</a></li>
<li><a class="reference internal" href="#read-fasta-files" id="id3">Read fasta files</a></li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This page is initialy a jupyter notebook. You can see a <a class="reference external" href="WritePB_.html">notebook HTML
render</a> of it or download the <a class="reference external" href="WritePB.ipynb">notebook
itself</a>.</p>
</div>
<p>The API allows to write all the files the command line tools can. This
includes the outputs of PBassign. The functions to handle several file
formats are available in the <a class="reference internal" href="../pages/io.html#module-pbxplore.io" title="pbxplore.io"><code class="xref py py-mod docutils literal"><span class="pre">pbxplore.io</span></code></a> module.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pbxplore</span> <span class="kn">as</span> <span class="nn">pbx</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">ImportError</span>                               <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">853</span><span class="n">cbdb98b68</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="kn">import</span> <span class="nn">pbxplore</span> <span class="k">as</span> <span class="nn">pbx</span>


<span class="ne">ImportError</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="n">pbxplore</span>
</pre></div>
</div>
<div class="section" id="fasta-files">
<h2>Fasta files<a class="headerlink" href="#fasta-files" title="Permalink to this headline">¶</a></h2>
<p>The most common way to save PB sequences is to write them in a fasta
file.</p>
<p>PBxplore allows two ways to write fasta files. The sequences can be
written either all at once or one at a time. To write a batch of
sequences at once, we need a list of sequences and a list of the
corresponding sequence names. The writing function here is
<a class="reference internal" href="../pages/io.html#pbxplore.io.write_fasta" title="pbxplore.io.write_fasta"><code class="xref py py-func docutils literal"><span class="pre">pbxplore.io.write_fasta()</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pb_sequences</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pdb_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pbx</span><span class="o">.</span><span class="n">DEMO_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;2LFU.pdb&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">chain_name</span><span class="p">,</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">pbx</span><span class="o">.</span><span class="n">chains_from_files</span><span class="p">([</span><span class="n">pdb_path</span><span class="p">]):</span>
    <span class="n">dihedrals</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">get_phi_psi_angles</span><span class="p">()</span>
    <span class="n">pb_seq</span> <span class="o">=</span> <span class="n">pbx</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dihedrals</span><span class="p">)</span>
    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chain_name</span><span class="p">)</span>
    <span class="n">pb_sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pb_seq</span><span class="p">)</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>

<span class="n">pprint</span><span class="p">(</span><span class="n">pb_sequences</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;output.fasta&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="n">pbx</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write_fasta</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">pb_sequences</span><span class="p">,</span> <span class="n">names</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">feec9831b75c</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
      <span class="mi">1</span> <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="mi">2</span> <span class="n">pb_sequences</span> <span class="o">=</span> <span class="p">[]</span>
<span class="o">----&gt;</span> <span class="mi">3</span> <span class="n">pdb_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pbx</span><span class="o">.</span><span class="n">DEMO_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;2LFU.pdb&#39;</span><span class="p">)</span>
      <span class="mi">4</span> <span class="k">for</span> <span class="n">chain_name</span><span class="p">,</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">pbx</span><span class="o">.</span><span class="n">chains_from_files</span><span class="p">([</span><span class="n">pdb_path</span><span class="p">]):</span>
      <span class="mi">5</span>     <span class="n">dihedrals</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">get_phi_psi_angles</span><span class="p">()</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>!cat output.fasta
!rm output.fasta
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cat</span><span class="p">:</span> <span class="n">output</span><span class="o">.</span><span class="n">fasta</span><span class="p">:</span> <span class="n">Aucun</span> <span class="n">fichier</span> <span class="n">ou</span> <span class="n">dossier</span> <span class="n">de</span> <span class="n">ce</span> <span class="nb">type</span>
<span class="n">rm</span><span class="p">:</span> <span class="n">impossible</span> <span class="n">de</span> <span class="n">supprimer</span> <span class="s1">&#39;output.fasta&#39;</span><span class="p">:</span> <span class="n">Aucun</span> <span class="n">fichier</span> <span class="n">ou</span> <span class="n">dossier</span> <span class="n">de</span> <span class="n">ce</span> <span class="nb">type</span>
</pre></div>
</div>
<p>Sequences can be written once at a time using the
<a class="reference internal" href="../pages/io.html#pbxplore.io.write_fasta_entry" title="pbxplore.io.write_fasta_entry"><code class="xref py py-func docutils literal"><span class="pre">pbxplore.io.write_fasta_entry()</span></code></a> function.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">pdb_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pbx</span><span class="o">.</span><span class="n">DEMO_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;2LFU.pdb&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;output.fasta&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">chain_name</span><span class="p">,</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">pbx</span><span class="o">.</span><span class="n">chains_from_files</span><span class="p">([</span><span class="n">pdb_path</span><span class="p">]):</span>
        <span class="n">dihedrals</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">get_phi_psi_angles</span><span class="p">()</span>
        <span class="n">pb_seq</span> <span class="o">=</span> <span class="n">pbx</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dihedrals</span><span class="p">)</span>
        <span class="n">pbx</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write_fasta_entry</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">pb_seq</span><span class="p">,</span> <span class="n">chain_name</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="n">ca18ad829ea9</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">pdb_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pbx</span><span class="o">.</span><span class="n">DEMO_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;2LFU.pdb&#39;</span><span class="p">)</span>
      <span class="mi">2</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;output.fasta&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
      <span class="mi">3</span>     <span class="k">for</span> <span class="n">chain_name</span><span class="p">,</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">pbx</span><span class="o">.</span><span class="n">chains_from_files</span><span class="p">([</span><span class="n">pdb_path</span><span class="p">]):</span>
      <span class="mi">4</span>         <span class="n">dihedrals</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">get_phi_psi_angles</span><span class="p">()</span>
      <span class="mi">5</span>         <span class="n">pb_seq</span> <span class="o">=</span> <span class="n">pbx</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dihedrals</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>!cat output.fasta
!rm output.fasta
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cat</span><span class="p">:</span> <span class="n">output</span><span class="o">.</span><span class="n">fasta</span><span class="p">:</span> <span class="n">Aucun</span> <span class="n">fichier</span> <span class="n">ou</span> <span class="n">dossier</span> <span class="n">de</span> <span class="n">ce</span> <span class="nb">type</span>
<span class="n">rm</span><span class="p">:</span> <span class="n">impossible</span> <span class="n">de</span> <span class="n">supprimer</span> <span class="s1">&#39;output.fasta&#39;</span><span class="p">:</span> <span class="n">Aucun</span> <span class="n">fichier</span> <span class="n">ou</span> <span class="n">dossier</span> <span class="n">de</span> <span class="n">ce</span> <span class="nb">type</span>
</pre></div>
</div>
<p>By default, the lines in fasta files are wrapped at 60 caracters as
defined in <code class="xref py py-const docutils literal"><span class="pre">pbxplore.io.fasta.FASTA_WIDTH</span></code>. Both
<a class="reference internal" href="../pages/io.html#pbxplore.io.write_fasta" title="pbxplore.io.write_fasta"><code class="xref py py-func docutils literal"><span class="pre">pbxplore.io.write_fasta()</span></code></a> and
<a class="reference internal" href="../pages/io.html#pbxplore.io.write_fasta_entry" title="pbxplore.io.write_fasta_entry"><code class="xref py py-func docutils literal"><span class="pre">pbxplore.io.write_fasta_entry()</span></code></a> have a <code class="docutils literal"><span class="pre">width</span></code> optionnal
argument that allows to control the wrapping.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">pb_sequences</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">IndexError</span>                                <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="mi">37179</span><span class="n">c94b1b9</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="nb">print</span><span class="p">(</span><span class="n">pb_sequences</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>


<span class="ne">IndexError</span><span class="p">:</span> <span class="nb">list</span> <span class="n">index</span> <span class="n">out</span> <span class="n">of</span> <span class="nb">range</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;output.fasta&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">width</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">):</span>
        <span class="n">pbx</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write_fasta_entry</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">pb_sequences</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                        <span class="s1">&#39;width={} blocks&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="p">),</span>
                                        <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">8</span><span class="o">-</span><span class="mi">975</span><span class="n">b3b2c17a0</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
      <span class="mi">1</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;output.fasta&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
      <span class="mi">2</span>     <span class="k">for</span> <span class="n">width</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">):</span>
<span class="o">----&gt;</span> <span class="mi">3</span>         <span class="n">pbx</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">write_fasta_entry</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">pb_sequences</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
      <span class="mi">4</span>                                         <span class="s1">&#39;width=</span><span class="si">{}</span><span class="s1"> blocks&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="p">),</span>
      <span class="mi">5</span>                                         <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>!cat output.fasta
!rm output.fasta
</pre></div>
</div>
</div>
<div class="section" id="dihedral-angles">
<h2>Dihedral angles<a class="headerlink" href="#dihedral-angles" title="Permalink to this headline">¶</a></h2>
<p>One needs the phi and psi dihedral angles to assign protein block
sequences. Having these angles, it is sometime convenient to store them
in a file. This can be done easily.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">pdb_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pbx</span><span class="o">.</span><span class="n">DEMO_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;2LFU.pdb&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;output.phipsi&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">chain_name</span><span class="p">,</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">pbx</span><span class="o">.</span><span class="n">chains_from_files</span><span class="p">([</span><span class="n">pdb_path</span><span class="p">]):</span>
        <span class="n">dihedral</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">get_phi_psi_angles</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">res</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dihedral</span><span class="p">):</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="s2">&quot;{:8.2f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dihedral</span><span class="p">[</span><span class="n">res</span><span class="p">][</span><span class="s2">&quot;phi&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="n">dihedral</span><span class="p">[</span><span class="n">res</span><span class="p">][</span><span class="s2">&quot;phi&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;    None&quot;</span>
            <span class="n">psi</span> <span class="o">=</span> <span class="s2">&quot;{:8.2f}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dihedral</span><span class="p">[</span><span class="n">res</span><span class="p">][</span><span class="s2">&quot;psi&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="n">dihedral</span><span class="p">[</span><span class="n">res</span><span class="p">][</span><span class="s2">&quot;psi&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;    None&quot;</span>
            <span class="k">print</span><span class="p">(</span><span class="s2">&quot;{} {:6d} {} {} &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">chain_name</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">psi</span><span class="p">),</span> <span class="nb">file</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mf">667e115945</span><span class="n">df</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">pdb_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pbx</span><span class="o">.</span><span class="n">DEMO_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;2LFU.pdb&#39;</span><span class="p">)</span>
      <span class="mi">2</span>
      <span class="mi">3</span> <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;output.phipsi&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
      <span class="mi">4</span>     <span class="k">for</span> <span class="n">chain_name</span><span class="p">,</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">pbx</span><span class="o">.</span><span class="n">chains_from_files</span><span class="p">([</span><span class="n">pdb_path</span><span class="p">]):</span>
      <span class="mi">5</span>         <span class="n">dihedral</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">get_phi_psi_angles</span><span class="p">()</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<p>Note it&#8217;s better to write the dihedral for each PDB/frame due to the
high memory cost to store all of them in a list.</p>
<p>The output is formated with one line per residue. The first columns
repeat the name given for the chain, then is the residue id followed by
the phi and the psi angle. If an angle is not defined, &#8216;None&#8217; is written
instead.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>!head output.phipsi
!tail output.phipsi
!rm output.phipsi
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">head</span><span class="p">:</span> <span class="n">impossible</span> <span class="n">d</span><span class="s1">&#39;ouvrir &#39;</span><span class="n">output</span><span class="o">.</span><span class="n">phipsi</span><span class="s1">&#39; en lecture: Aucun fichier ou dossier de ce type</span>
<span class="n">tail</span><span class="p">:</span> <span class="n">impossible</span> <span class="n">d</span><span class="s1">&#39;ouvrir &#39;</span><span class="n">output</span><span class="o">.</span><span class="n">phipsi</span><span class="s1">&#39; en lecture: Aucun fichier ou dossier de ce type</span>
<span class="n">rm</span><span class="p">:</span> <span class="n">impossible</span> <span class="n">de</span> <span class="n">supprimer</span> <span class="s1">&#39;output.phipsi&#39;</span><span class="p">:</span> <span class="n">Aucun</span> <span class="n">fichier</span> <span class="n">ou</span> <span class="n">dossier</span> <span class="n">de</span> <span class="n">ce</span> <span class="nb">type</span>
</pre></div>
</div>
</div>
<div class="section" id="read-fasta-files">
<h2>Read fasta files<a class="headerlink" href="#read-fasta-files" title="Permalink to this headline">¶</a></h2>
<p>We want to read sequences that we wrote in files. PBxplore provides a
function to read fasta files: the <a class="reference internal" href="../pages/io.html#pbxplore.io.read_fasta" title="pbxplore.io.read_fasta"><code class="xref py py-func docutils literal"><span class="pre">pbxplore.io.read_fasta()</span></code></a>
function.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>def pdb_to_fasta_pb(pdb_path, fasta_path):
    &quot;&quot;&quot;
    Write a fasta file with all the PB sequences from a PDB
    &quot;&quot;&quot;
    with open(fasta_path, &#39;w&#39;) as outfile:
        for chain_name, chain in pbx.chains_from_files([pdb_path]):
            dihedrals = chain.get_phi_psi_angles()
            pb_seq = pbx.assign(dihedrals)
            pbx.io.write_fasta_entry(outfile, pb_seq, chain_name)

# Write a fasta file
pdb_path = os.path.join(pbx.DEMO_DATA_PATH, &#39;2LFU.pdb&#39;)
pdb_to_fasta_pb(pdb_path, &#39;output.fasta&#39;)

# Read a list of headers and a list of sequences from a fasta file
names, sequences = pbx.io.read_fasta(&#39;output.fasta&#39;)

print(&#39;names:&#39;)
pprint(names)
print(&#39;sequences:&#39;)
pprint(sequences)

!rm output.fasta
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">83</span><span class="n">ffe81d42a5</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
     <span class="mi">10</span>
     <span class="mi">11</span> <span class="c1"># Write a fasta file</span>
<span class="o">---&gt;</span> <span class="mi">12</span> <span class="n">pdb_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pbx</span><span class="o">.</span><span class="n">DEMO_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;2LFU.pdb&#39;</span><span class="p">)</span>
     <span class="mi">13</span> <span class="n">pdb_to_fasta_pb</span><span class="p">(</span><span class="n">pdb_path</span><span class="p">,</span> <span class="s1">&#39;output.fasta&#39;</span><span class="p">)</span>
     <span class="mi">14</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<p>If the sequences we want to read are spread amongst several fasta files,
then we can use the <a class="reference internal" href="../pages/io.html#pbxplore.io.read_several_fasta" title="pbxplore.io.read_several_fasta"><code class="xref py py-func docutils literal"><span class="pre">pbxplore.io.read_several_fasta()</span></code></a> function
that takes a list of fasta file path as argument instead of a single
path.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span># Write several fasta files
pdb_to_fasta_pb(os.path.join(pbx.DEMO_DATA_PATH, &#39;1BTA.pdb&#39;), &#39;1BTA.fasta&#39;)
pdb_to_fasta_pb(os.path.join(pbx.DEMO_DATA_PATH, &#39;2LFU.pdb&#39;), &#39;2FLU.fasta&#39;)

# Read the fasta files
names, sequences = pbx.io.read_several_fasta([&#39;1BTA.fasta&#39;, &#39;2FLU.fasta&#39;])

# Print the first entries
print(&#39;names:&#39;)
pprint(names[:5])
print(&#39;sequences:&#39;)
pprint(sequences[:5])

!rm 1BTA.fasta 2FLU.fasta
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">13</span><span class="o">-</span><span class="n">fe5b22c077f3</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
      <span class="mi">1</span> <span class="c1"># Write several fasta files</span>
<span class="o">----&gt;</span> <span class="mi">2</span> <span class="n">pdb_to_fasta_pb</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pbx</span><span class="o">.</span><span class="n">DEMO_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;1BTA.pdb&#39;</span><span class="p">),</span> <span class="s1">&#39;1BTA.fasta&#39;</span><span class="p">)</span>
      <span class="mi">3</span> <span class="n">pdb_to_fasta_pb</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pbx</span><span class="o">.</span><span class="n">DEMO_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;2LFU.pdb&#39;</span><span class="p">),</span> <span class="s1">&#39;2FLU.fasta&#39;</span><span class="p">)</span>
      <span class="mi">4</span>
      <span class="mi">5</span> <span class="c1"># Read the fasta files</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Deformability.html" class="btn btn-neutral float-right" title="Visualize protein deformability" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Assignement.html" class="btn btn-neutral" title="PB assignation" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Pierre Poulain, and Alexandre G. deBrevern.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.3.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
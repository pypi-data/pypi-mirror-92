

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Visualize protein deformability &mdash; PBxplore 1.3.5 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="PBxplore 1.3.5 documentation" href="../index.html"/>
        <link rel="up" title="API Cookbook" href="../api_cookbook.html"/>
        <link rel="next" title="API Reference" href="../api_reference.html"/>
        <link rel="prev" title="Writing PB in file" href="WritePB.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> PBxplore
          

          
          </a>

          
            
            
              <div class="version">
                1.3.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro_PB.html">Protein Blocks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utilization.html">Utilization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PBassign.html">PBassign</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PBcount.html">PBcount</a></li>
<li class="toctree-l1"><a class="reference internal" href="../PBstat.html">PBstat</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api_cookbook.html">API Cookbook</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api_cookbook.html#pbxplore-structure">PBxplore.structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_cookbook.html#pbxplore-io">PBxplore.io</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api_cookbook.html#pbxplore-analysis">PBxplore.analysis</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Assignement.html">PB assignation</a></li>
<li class="toctree-l3"><a class="reference internal" href="WritePB.html">Writing PB in file</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Visualize protein deformability</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#block-occurences-per-position">Block occurences per position</a></li>
<li class="toctree-l4"><a class="reference internal" href="#protein-block-entropy">Protein Block entropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#display-pb-variability-as-a-logo">Display PB variability as a logo</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">PBxplore</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../api_cookbook.html">API Cookbook</a> &raquo;</li>
      
    <li>Visualize protein deformability</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/notebooks/Deformability.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="visualize-protein-deformability">
<h1>Visualize protein deformability<a class="headerlink" href="#visualize-protein-deformability" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#block-occurences-per-position" id="id1">Block occurences per position</a></li>
<li><a class="reference internal" href="#protein-block-entropy" id="id2">Protein Block entropy</a></li>
<li><a class="reference internal" href="#display-pb-variability-as-a-logo" id="id3">Display PB variability as a logo</a></li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This page is initialy a jupyter notebook. You can see a <a class="reference external" href="Deformability_.html">notebook HTML
render</a> of it or download the <a class="reference external" href="Deformability.ipynb">notebook
itself</a>.</p>
</div>
<p>Protein Blocks are great tools to study protein deformability. Indeed,
if the block assigned to a residue changes between two frames of a
trajectory, it represents a local deformation of the protein rather than
the displacement of the residue.</p>
<p>The API allows to visualize Protein Block variability throughout a
molecular dynamics simulation trajectory.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Image</span><span class="p">,</span> <span class="n">display</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># The following line, in a jupyter notebook, allows to display</span>
<span class="c1"># the figure directly in the notebook. See &lt;https://jupyter.org/&gt;</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pbxplore</span> <span class="kn">as</span> <span class="nn">pbx</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">ImportError</span>                               <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">853</span><span class="n">cbdb98b68</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="kn">import</span> <span class="nn">pbxplore</span> <span class="k">as</span> <span class="nn">pbx</span>


<span class="ne">ImportError</span><span class="p">:</span> <span class="n">No</span> <span class="n">module</span> <span class="n">named</span> <span class="n">pbxplore</span>
</pre></div>
</div>
<p>Here we will look at a molecular dynamics simulation of the barstar. As
we will analyse Protein Block sequences, we first need to assign these
sequences for each frame of the trajectory.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Assign PB sequences for all frames of a trajectory</span>
<span class="n">trajectory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pbx</span><span class="o">.</span><span class="n">DEMO_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;barstar_md_traj.xtc&#39;</span><span class="p">)</span>
<span class="n">topology</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pbx</span><span class="o">.</span><span class="n">DEMO_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;barstar_md_traj.gro&#39;</span><span class="p">)</span>
<span class="n">sequences</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">chain_name</span><span class="p">,</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">pbx</span><span class="o">.</span><span class="n">chains_from_trajectory</span><span class="p">(</span><span class="n">trajectory</span><span class="p">,</span> <span class="n">topology</span><span class="p">):</span>
    <span class="n">dihedrals</span> <span class="o">=</span> <span class="n">chain</span><span class="o">.</span><span class="n">get_phi_psi_angles</span><span class="p">()</span>
    <span class="n">pb_seq</span> <span class="o">=</span> <span class="n">pbx</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dihedrals</span><span class="p">)</span>
    <span class="n">sequences</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pb_seq</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mf">495e579</span><span class="n">af03b</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
      <span class="mi">1</span> <span class="c1"># Assign PB sequences for all frames of a trajectory</span>
<span class="o">----&gt;</span> <span class="mi">2</span> <span class="n">trajectory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pbx</span><span class="o">.</span><span class="n">DEMO_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;barstar_md_traj.xtc&#39;</span><span class="p">)</span>
      <span class="mi">3</span> <span class="n">topology</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pbx</span><span class="o">.</span><span class="n">DEMO_DATA_PATH</span><span class="p">,</span> <span class="s1">&#39;barstar_md_traj.gro&#39;</span><span class="p">)</span>
      <span class="mi">4</span> <span class="n">sequences</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="mi">5</span> <span class="k">for</span> <span class="n">chain_name</span><span class="p">,</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">pbx</span><span class="o">.</span><span class="n">chains_from_trajectory</span><span class="p">(</span><span class="n">trajectory</span><span class="p">,</span> <span class="n">topology</span><span class="p">):</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<div class="section" id="block-occurences-per-position">
<h2>Block occurences per position<a class="headerlink" href="#block-occurences-per-position" title="Permalink to this headline">¶</a></h2>
<p>The basic information we need to analyse protein deformability is the
count of occurences of each PB for each position throughout the
trajectory. This occurence matrix can be calculated with the
<a class="reference internal" href="../pages/analysis.html#pbxplore.analysis.count_matrix" title="pbxplore.analysis.count_matrix"><code class="xref py py-func docutils literal"><span class="pre">pbxplore.analysis.count_matrix()</span></code></a> function.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">count_matrix</span> <span class="o">=</span> <span class="n">pbx</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">count_matrix</span><span class="p">(</span><span class="n">sequences</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">4</span><span class="o">-</span><span class="mi">25</span><span class="n">d9f2aed9b5</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">count_matrix</span> <span class="o">=</span> <span class="n">pbx</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">count_matrix</span><span class="p">(</span><span class="n">sequences</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">count_matrix</span></code> is a numpy array with one row per PB and one column per
position. In each cell is the number of time a position was assigned to
a PB.</p>
<p>We can visualize <code class="docutils literal"><span class="pre">count_matrix</span></code> using Matplotlib as any 2D numpy
array.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Position&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Block&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">5</span><span class="o">-</span><span class="mi">2544</span><span class="n">c1e550cd</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
      <span class="mi">2</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
      <span class="mi">3</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Position&#39;</span><span class="p">)</span>
      <span class="mi">4</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Block&#39;</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;count_matrix&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<p>PBxplore provides the <a class="reference internal" href="../pages/analysis.html#pbxplore.analysis.plot_map" title="pbxplore.analysis.plot_map"><code class="xref py py-func docutils literal"><span class="pre">pbxplore.analysis.plot_map()</span></code></a> function to
ease the visualization of the occurence matrix.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>pbx.analysis.plot_map(&#39;map.png&#39;, count_matrix)
!rm map.png
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">6</span><span class="o">-</span><span class="mi">89</span><span class="n">cb23d2983b</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">pbx</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="s1">&#39;map.png&#39;</span><span class="p">,</span> <span class="n">count_matrix</span><span class="p">)</span>
      <span class="mi">2</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;rm map.png&#39;</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../pages/analysis.html#pbxplore.analysis.plot_map" title="pbxplore.analysis.plot_map"><code class="xref py py-func docutils literal"><span class="pre">pbxplore.analysis.plot_map()</span></code></a> helper has a <code class="docutils literal"><span class="pre">residue_min</span></code>
and a <code class="docutils literal"><span class="pre">residue_max</span></code> optional arguments to display only part of the
matrix. These two arguments can be pass to all PBxplore functions that
produce a figure.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>pbx.analysis.plot_map(&#39;map.png&#39;, count_matrix,
                      residue_min=60, residue_max=70)
!rm map.png
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">7</span><span class="o">-</span><span class="n">d2cdc6435a50</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">pbx</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">plot_map</span><span class="p">(</span><span class="s1">&#39;map.png&#39;</span><span class="p">,</span> <span class="n">count_matrix</span><span class="p">,</span>
      <span class="mi">2</span>                       <span class="n">residue_min</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">residue_max</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
      <span class="mi">3</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;rm map.png&#39;</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<p>Note that matrix in the the figure produced by
<a class="reference internal" href="../pages/analysis.html#pbxplore.analysis.plot_map" title="pbxplore.analysis.plot_map"><code class="xref py py-func docutils literal"><span class="pre">pbxplore.analysis.plot_map()</span></code></a> is normalized so as the sum of each
column is 1. The matrix can be normalized with the
<a class="reference internal" href="../pages/analysis.html#pbxplore.analysis.compute_freq_matrix" title="pbxplore.analysis.compute_freq_matrix"><code class="xref py py-func docutils literal"><span class="pre">pbxplore.analysis.compute_freq_matrix()</span></code></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">freq_matrix</span> <span class="o">=</span> <span class="n">pbx</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">compute_freq_matrix</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">8</span><span class="o">-</span><span class="mi">65</span><span class="n">ead41a37b6</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">freq_matrix</span> <span class="o">=</span> <span class="n">pbx</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">compute_freq_matrix</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">freq_matrix</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Position&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Block&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="mi">81</span><span class="n">cb853faf4a</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">freq_matrix</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span>
      <span class="mi">2</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
      <span class="mi">3</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Position&#39;</span><span class="p">)</span>
      <span class="mi">4</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Block&#39;</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;freq_matrix&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
</div>
<div class="section" id="protein-block-entropy">
<h2>Protein Block entropy<a class="headerlink" href="#protein-block-entropy" title="Permalink to this headline">¶</a></h2>
<p>The <span class="math">\(N_{eq}\)</span> is a measure of variability based on the count matrix
calculated above. It can be computed with the
<a class="reference internal" href="../pages/analysis.html#pbxplore.analysis.compute_neq" title="pbxplore.analysis.compute_neq"><code class="xref py py-func docutils literal"><span class="pre">pbxplore.analysis.compute_neq()</span></code></a> function.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">neq_by_position</span> <span class="o">=</span> <span class="n">pbx</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">compute_neq</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">7</span><span class="n">eeb19d961f7</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">neq_by_position</span> <span class="o">=</span> <span class="n">pbx</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">compute_neq</span><span class="p">(</span><span class="n">count_matrix</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">neq_by_position</span></code> is a 1D numpy array with the <span class="math">\(N_{eq}\)</span> for each
residue.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">neq_by_position</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Position&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$N_{eq}$&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="n">b3b064739482</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">neq_by_position</span><span class="p">)</span>
      <span class="mi">2</span> <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Position&#39;</span><span class="p">)</span>
      <span class="mi">3</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$N_</span><span class="si">{eq}</span><span class="s1">$&#39;</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;neq_by_position&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../pages/analysis.html#pbxplore.analysis.plot_neq" title="pbxplore.analysis.plot_neq"><code class="xref py py-func docutils literal"><span class="pre">pbxplore.analysis.plot_neq()</span></code></a> helper ease the plotting of the
<span class="math">\(N_{eq}\)</span>.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>pbx.analysis.plot_neq(&#39;neq.png&#39;, neq_by_position)
!rm neq.png
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="n">f4134ffa3fff</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">pbx</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">plot_neq</span><span class="p">(</span><span class="s1">&#39;neq.png&#39;</span><span class="p">,</span> <span class="n">neq_by_position</span><span class="p">)</span>
      <span class="mi">2</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;rm neq.png&#39;</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">residue_min</span></code> and <code class="docutils literal"><span class="pre">residue_max</span></code> arguments are available.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>pbx.analysis.plot_neq(&#39;neq.png&#39;, neq_by_position,
                      residue_min=60, residue_max=70)
!rm neq.png
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">13</span><span class="o">-</span><span class="n">d9fd90e1d17b</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">pbx</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">plot_neq</span><span class="p">(</span><span class="s1">&#39;neq.png&#39;</span><span class="p">,</span> <span class="n">neq_by_position</span><span class="p">,</span>
      <span class="mi">2</span>                       <span class="n">residue_min</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">residue_max</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
      <span class="mi">3</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;rm neq.png&#39;</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
</div>
<div class="section" id="display-pb-variability-as-a-logo">
<h2>Display PB variability as a logo<a class="headerlink" href="#display-pb-variability-as-a-logo" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python"><div class="highlight"><pre><span></span>pbx.analysis.generate_weblogo(&#39;logo.png&#39;, count_matrix)
display(Image(&#39;logo.png&#39;))
!rm logo.png
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">14</span><span class="o">-</span><span class="n">a4d44c0d9f48</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">pbx</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">generate_weblogo</span><span class="p">(</span><span class="s1">&#39;logo.png&#39;</span><span class="p">,</span> <span class="n">count_matrix</span><span class="p">)</span>
      <span class="mi">2</span> <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;logo.png&#39;</span><span class="p">))</span>
      <span class="mi">3</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;rm logo.png&#39;</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span>pbx.analysis.generate_weblogo(&#39;logo.png&#39;, count_matrix,
                              residue_min=60, residue_max=70)
display(Image(&#39;logo.png&#39;))
!rm logo.png
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">---------------------------------------------------------------------------</span>

<span class="ne">NameError</span>                                 <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>

<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">15</span><span class="o">-</span><span class="n">ae0b8a456c34</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span><span class="p">()</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="n">pbx</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">generate_weblogo</span><span class="p">(</span><span class="s1">&#39;logo.png&#39;</span><span class="p">,</span> <span class="n">count_matrix</span><span class="p">,</span>
      <span class="mi">2</span>                               <span class="n">residue_min</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">residue_max</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
      <span class="mi">3</span> <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="s1">&#39;logo.png&#39;</span><span class="p">))</span>
      <span class="mi">4</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;rm logo.png&#39;</span><span class="p">)</span>


<span class="ne">NameError</span><span class="p">:</span> <span class="n">name</span> <span class="s1">&#39;pbx&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">defined</span>
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../api_reference.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="WritePB.html" class="btn btn-neutral" title="Writing PB in file" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Pierre Poulain, and Alexandre G. deBrevern.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.3.5',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
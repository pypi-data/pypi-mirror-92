{"version":3,"sources":["reviewRequestPageViewTests.es6.js"],"names":[],"mappings":";;AAAA,MAAM,kDAAN,EAA0D,YAAW;AACjE,QAAM,ihCAAN;;AAkCA,QAAI,aAAJ;AACA,QAAI,iBAAJ;AACA,QAAI,eAAJ;AACA,QAAI,eAAJ;;AAEA,eAAW,YAAW;AAClB,YAAM,MAAM,EAAE,QAAF,EACP,IADO,CACF,QADE,EAEP,QAFO,CAEE,aAFF,CAAZ;;AAIA,WAAG,WAAH,CAAe,QAAf,GAA0B,IAA1B;;AAEA,eAAO,IAAI,GAAG,iBAAH,CAAqB,iBAAzB,CAA2C;AAC9C,6BAAiB,KAD6B;AAE9C,+BAAmB,EAF2B;AAG9C,wBAAY;AACR,iCAAiB,EADT;AAER,+BAAe,IAFP;AAGR,+BAAe;AAHP;AAHkC,SAA3C,EAQJ;AACC,mBAAO;AADR,SARI,CAAP;;AAYA,mBAAW,IAAI,GAAG,iBAAH,CAAqB,qBAAzB,CAA+C;AACtD,gBAAI,GADkD;AAEtD,mBAAO;AAF+C,SAA/C,CAAX;;AAKA;AACA,cAAM,GAAG,iBAAH,CAAqB,qBAArB,CAA2C,SAAjD,EACM,QADN;;AAGA,YAAM,gBAAgB,KAAK,GAAL,CAAS,eAAT,CAAtB;;AAEA,iBAAS,YAAT,CAAsB,IAAI,GAAG,iBAAH,CAAqB,eAAzB,CAAyC;AAC3D,mBAAO,IAAI,GAAG,iBAAH,CAAqB,WAAzB,CAAqC;AACxC,wBAAQ,cAAc,YAAd,CAA2B,GAA3B,EAAgC;AACpC,4BAAQ,IAD4B;AAEpC,4BAAQ,IAF4B;AAGpC,6BAAS,UAH2B;AAIpC,gCAAY;AAJwB,iBAAhC,CADgC;AAOxC,qCAAqB,SAAS;AAPU,aAArC,CADoD;AAU3D,gBAAI,IAAI,IAAJ,CAAS,YAAT;AAVuD,SAAzC,CAAtB;;AAaA,iBAAS,YAAT,CAAsB,IAAI,GAAG,iBAAH,CAAqB,eAAzB,CAAyC;AAC3D,mBAAO,IAAI,GAAG,iBAAH,CAAqB,WAAzB,CAAqC;AACxC,wBAAQ,cAAc,YAAd,CAA2B,GAA3B,EAAgC;AACpC,4BAAQ,KAD4B;AAEpC,4BAAQ,IAF4B;AAGpC,6BAAS,UAH2B;AAIpC,gCAAY;AAJwB,iBAAhC,CADgC;AAOxC,qCAAqB,SAAS;AAPU,aAArC,CADoD;AAU3D,gBAAI,IAAI,IAAJ,CAAS,YAAT;AAVuD,SAAzC,CAAtB;;AAaA,iBAAS,MAAT;;AAEA,eAAO,SAAS,WAAT,CAAqB,MAA5B,EAAoC,IAApC,CAAyC,CAAzC;AACA,iBAAS,SAAS,WAAT,CAAqB,CAArB,CAAT;AACA,iBAAS,SAAS,WAAT,CAAqB,CAArB,CAAT;AACH,KA7DD;;AA+DA,cAAU,YAAW;AACjB,WAAG,WAAH,CAAe,QAAf,GAA0B,IAA1B;AACH,KAFD;;AAIA,aAAS,SAAT,EAAoB,YAAW;AAC3B,WAAG,cAAH,EAAmB,YAAW;AAC1B,gBAAM,OAAO,OAAO,GAAP,CAAW,IAAX,CAAgB,qCAAhB,CAAb;AACA,gBAAM,OAAO,OAAO,GAAP,CAAW,IAAX,CAAgB,qCAAhB,CAAb;;AAEA,mBAAO,KAAK,QAAL,CAAc,WAAd,CAAP,EAAmC,IAAnC,CAAwC,KAAxC;AACA,mBAAO,KAAK,QAAL,CAAc,WAAd,CAAP,EAAmC,IAAnC,CAAwC,KAAxC;;AAEA,qBAAS,CAAT,CAAW,eAAX,EAA4B,KAA5B;;AAEA,mBAAO,KAAK,QAAL,CAAc,WAAd,CAAP,EAAmC,IAAnC,CAAwC,IAAxC;AACA,mBAAO,KAAK,QAAL,CAAc,WAAd,CAAP,EAAmC,IAAnC,CAAwC,IAAxC;AACH,SAXD;;AAaA,WAAG,YAAH,EAAiB,YAAW;AACxB,gBAAM,OAAO,OAAO,GAAP,CAAW,IAAX,CAAgB,qCAAhB,CAAb;AACA,gBAAM,OAAO,OAAO,GAAP,CAAW,IAAX,CAAgB,qCAAhB,CAAb;;AAEA,iBAAK,QAAL,CAAc,WAAd;AACA,iBAAK,QAAL,CAAc,WAAd;;AAEA,qBAAS,CAAT,CAAW,aAAX,EAA0B,KAA1B;;AAEA,mBAAO,KAAK,QAAL,CAAc,WAAd,CAAP,EAAmC,IAAnC,CAAwC,KAAxC;AACA,mBAAO,KAAK,QAAL,CAAc,WAAd,CAAP,EAAmC,IAAnC,CAAwC,KAAxC;AACH,SAXD;AAYH,KA1BD;;AA4BA,aAAS,SAAT,EAAoB,YAAW;AAC3B,iBAAS,mBAAT,EAA8B,YAAW;AACrC,uBAAW,YAAW;AAClB,sBAAM,GAAG,iBAAH,CAAqB,qBAArB,CAA2C,SAAjD,EACM,mBADN;AAEA,sBAAM,MAAN,EAAc,0BAAd,EAA0C,GAA1C,CAA8C,WAA9C;AACA,sBAAM,MAAN,EAAc,0BAAd,EAA0C,GAA1C,CAA8C,WAA9C;AACH,aALD;;AAOA,eAAG,eAAH,EAAoB,YAAW;AAC3B,yBAAS,iBAAT,CAA2B,UAA3B;;AAEA,uBAAO,OAAO,wBAAd,EAAwC,gBAAxC;AACA,uBAAO,GAAG,iBAAH,CAAqB,qBAArB,CACC,SADD,CACW,iBADlB,EACqC,gBADrC;;AAGA;AACA,uBAAO,OAAO,wBAAd,EAAwC,GAAxC,CAA4C,gBAA5C;AACH,aATD;;AAWA,eAAG,kBAAH,EAAuB,YAAW;AAC9B,yBAAS,iBAAT,CAA2B,aAA3B;;AAEA,uBAAO,OAAO,wBAAd,EAAwC,gBAAxC;AACA,uBAAO,GAAG,iBAAH,CAAqB,qBAArB,CACC,SADD,CACW,iBADlB,EACqC,gBADrC;;AAGA;AACA,uBAAO,OAAO,wBAAd,EAAwC,GAAxC,CAA4C,gBAA5C;AACH,aATD;;AAWA,eAAG,eAAH,EAAoB,YAAW;AAC3B,yBAAS,iBAAT,CAA2B,eAA3B,EAA4C,GAA5C;;AAEA,uBAAO,OAAO,wBAAd,EAAwC,gBAAxC;AACA,uBAAO,GAAG,iBAAH,CAAqB,qBAArB,CACC,SADD,CACW,iBADlB,EACqC,gBADrC;;AAGA;AACA,uBAAO,OAAO,wBAAd,EAAwC,GAAxC,CAA4C,gBAA5C;AACH,aATD;AAUH,SAxCD;AAyCH,KA1CD;AA2CH,CAlLD","file":"reviewRequestPageViewTests.js","sourcesContent":["suite('rb/reviewRequestPage/views/ReviewRequestPageView', function() {\n    const template = dedent`\n        <div id=\"review-banner\"></div>\n        <a id=\"collapse-all\"></a>\n        <a id=\"expand-all\"></a>\n        <div>\n         <div class=\"review review-request-page-entry\" id=\"review123\">\n          <div class=\"review-request-page-entry-contents\">\n           <div class=\"body\">\n            <pre class=\"body_top\">Body Top</pre>\n            <div class=\"comment-section\" data-context-type=\"body_top\">\n            </div>\n            <div class=\"comment-section\" data-context-id=\"123\"\n                 data-context-type=\"diff_comments\">\n            </div>\n            <pre class=\"body_bottom\">Body Bottom</pre>\n            <div class=\"comment-section\" data-context-type=\"body_bottom\">\n            </div>\n           </div>\n         </div>\n         <div class=\"review review-request-page-entry\" id=\"review124\">\n          <div class=\"review-request-page-entry-contents\">\n           <div class=\"body\">\n            <pre class=\"body_top\">Body Top</pre>\n            <div class=\"comment-section\" data-context-type=\"body_top\">\n            </div>\n            <pre class=\"body_bottom\">Body Bottom</pre>\n            <div class=\"comment-section\" data-context-type=\"body_bottom\">\n            </div>\n           </div>\n          </div>\n         </div>\n        </div>\n    `;\n\n    let page;\n    let pageView;\n    let entry1;\n    let entry2;\n\n    beforeEach(function() {\n        const $el = $('<div/>')\n            .html(template)\n            .appendTo($testsScratch);\n\n        RB.DnDUploader.instance = null;\n\n        page = new RB.ReviewRequestPage.ReviewRequestPage({\n            checkForUpdates: false,\n            reviewRequestData: {},\n            editorData: {\n                fileAttachments: [],\n                mutableByUser: true,\n                showSendEmail: false,\n            },\n        }, {\n            parse: true,\n        });\n\n        pageView = new RB.ReviewRequestPage.ReviewRequestPageView({\n            el: $el,\n            model: page,\n        });\n\n        // Stub this out.\n        spyOn(RB.ReviewRequestPage.IssueSummaryTableView.prototype,\n              'render');\n\n        const reviewRequest = page.get('reviewRequest');\n\n        pageView.addEntryView(new RB.ReviewRequestPage.ReviewEntryView({\n            model: new RB.ReviewRequestPage.ReviewEntry({\n                review: reviewRequest.createReview(123, {\n                    shipIt: true,\n                    public: true,\n                    bodyTop: 'Body Top',\n                    bodyBottom: 'Body Bottom',\n                }),\n                reviewRequestEditor: pageView.reviewRequestEditor,\n            }),\n            el: $el.find('#review123'),\n        }));\n\n        pageView.addEntryView(new RB.ReviewRequestPage.ReviewEntryView({\n            model: new RB.ReviewRequestPage.ReviewEntry({\n                review: reviewRequest.createReview(124, {\n                    shipIt: false,\n                    public: true,\n                    bodyTop: 'Body Top',\n                    bodyBottom: 'Body Bottom',\n                }),\n                reviewRequestEditor: pageView.reviewRequestEditor,\n            }),\n            el: $el.find('#review124'),\n        }));\n\n        pageView.render();\n\n        expect(pageView._entryViews.length).toBe(2);\n        entry1 = pageView._entryViews[0];\n        entry2 = pageView._entryViews[1];\n    });\n\n    afterEach(function() {\n        RB.DnDUploader.instance = null;\n    });\n\n    describe('Actions', function() {\n        it('Collapse all', function() {\n            const $el1 = entry1.$el.find('.review-request-page-entry-contents');\n            const $el2 = entry2.$el.find('.review-request-page-entry-contents');\n\n            expect($el1.hasClass('collapsed')).toBe(false);\n            expect($el2.hasClass('collapsed')).toBe(false);\n\n            pageView.$('#collapse-all').click();\n\n            expect($el1.hasClass('collapsed')).toBe(true);\n            expect($el2.hasClass('collapsed')).toBe(true);\n        });\n\n        it('Expand all', function() {\n            const $el1 = entry1.$el.find('.review-request-page-entry-contents');\n            const $el2 = entry2.$el.find('.review-request-page-entry-contents');\n\n            $el1.addClass('collapsed');\n            $el2.addClass('collapsed');\n\n            pageView.$('#expand-all').click();\n\n            expect($el1.hasClass('collapsed')).toBe(false);\n            expect($el2.hasClass('collapsed')).toBe(false);\n        });\n    });\n\n    describe('Methods', function() {\n        describe('openCommentEditor', function() {\n            beforeEach(function() {\n                spyOn(RB.ReviewRequestPage.ReviewReplyEditorView.prototype,\n                      'openCommentEditor');\n                spyOn(entry1, 'getReviewReplyEditorView').and.callThrough();\n                spyOn(entry2, 'getReviewReplyEditorView').and.callThrough();\n            });\n\n            it('With body_top', function() {\n                pageView.openCommentEditor('body_top');\n\n                expect(entry1.getReviewReplyEditorView).toHaveBeenCalled();\n                expect(RB.ReviewRequestPage.ReviewReplyEditorView\n                       .prototype.openCommentEditor).toHaveBeenCalled();\n\n                /* We should have matched the first one. */\n                expect(entry2.getReviewReplyEditorView).not.toHaveBeenCalled();\n            });\n\n            it('With body_bottom', function() {\n                pageView.openCommentEditor('body_bottom');\n\n                expect(entry1.getReviewReplyEditorView).toHaveBeenCalled();\n                expect(RB.ReviewRequestPage.ReviewReplyEditorView\n                       .prototype.openCommentEditor).toHaveBeenCalled();\n\n                /* We should have matched the first one. */\n                expect(entry2.getReviewReplyEditorView).not.toHaveBeenCalled();\n            });\n\n            it('With comments', function() {\n                pageView.openCommentEditor('diff_comments', 123);\n\n                expect(entry1.getReviewReplyEditorView).toHaveBeenCalled();\n                expect(RB.ReviewRequestPage.ReviewReplyEditorView\n                       .prototype.openCommentEditor).toHaveBeenCalled();\n\n                /* We should have matched the first one. */\n                expect(entry2.getReviewReplyEditorView).not.toHaveBeenCalled();\n            });\n        });\n    });\n});\n"]}
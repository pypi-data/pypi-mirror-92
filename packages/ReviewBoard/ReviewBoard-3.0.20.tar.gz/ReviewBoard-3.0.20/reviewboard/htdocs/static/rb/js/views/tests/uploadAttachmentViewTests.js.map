{"version":3,"sources":["uploadAttachmentViewTests.es6.js"],"names":[],"mappings":"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","file":"uploadAttachmentViewTests.js","sourcesContent":["suite('rb/views/UploadAttachmentView', function() {\n    let reviewRequest;\n\n    beforeEach(function() {\n        reviewRequest = new RB.ReviewRequest({\n            summary: 'My Review Request',\n            reviewURL: '/r/1/',\n        });\n    });\n\n    describe('Instances', function() {\n        let dialog;\n\n        afterEach(function() {\n            if (dialog) {\n                dialog.hide();\n                dialog = null;\n            }\n        });\n\n        describe('Buttons', function() {\n            beforeEach(function() {\n                dialog = new RB.UploadAttachmentView({\n                    reviewRequest: reviewRequest,\n                });\n            });\n\n            describe('Cancel', function() {\n                let $button;\n\n                beforeEach(function() {\n                    dialog.show();\n                    $button = dialog.$buttonsMap.cancel;\n\n                    expect($button.length).toBe(1);\n                });\n\n                it('Enabled by default', function() {\n                    expect($button.is(':disabled')).toBe(false);\n                });\n\n                it('Closes dialog when clicked', function() {\n                    spyOn($.fn, 'modalBox').and.callThrough();\n                    dialog.delegateEvents();\n\n                    $button.click();\n                    expect($.fn.modalBox).toHaveBeenCalledWith('destroy');\n                });\n            });\n\n            describe('Upload', function() {\n                let $button;\n                let $path;\n\n                beforeEach(function() {\n                    spyOn(dialog, 'send');\n\n                    dialog.show();\n                    $button = dialog.$buttonsMap.upload;\n                    $path = dialog._$path;\n\n                    /*\n                     * Allows the value of the input to be changed\n                     * programmatically without security issues.\n                     */\n                    $path.attr('type', 'text');\n\n                    spyOn(dialog, 'updateUploadButtonEnabledState')\n                        .and.callThrough();\n                    dialog.delegateEvents();\n\n                    expect($button.length).toBe(1);\n                });\n\n                it('Disabled by default until a file is uploaded', function() {\n                    expect($button.is(':disabled')).toBe(true);\n                });\n\n                it('Enabled when a file is uploaded', function() {\n                    expect($button.is(':disabled')).toBe(true);\n\n                    $path\n                        .val('fakefile')\n                        .trigger('change');\n\n                    expect(dialog.updateUploadButtonEnabledState)\n                        .toHaveBeenCalledTimes(1);\n                    expect($button.is(':disabled')).toBe(false);\n                });\n\n                it('Disabled when an uploaded file is removed', function() {\n                    $path\n                        .val('fakefile')\n                        .trigger('change')\n                        .val('')\n                        .trigger('change');\n\n                    expect(dialog.updateUploadButtonEnabledState)\n                        .toHaveBeenCalledTimes(2);\n                    expect($button.is(':disabled')).toBe(true);\n                });\n\n                it('Uploads the file attachment', function() {\n                    expect($button.is(':disabled')).toBe(true);\n\n                    $path\n                        .val('fakefile')\n                        .trigger('change');\n\n                    expect(dialog.updateUploadButtonEnabledState).toHaveBeenCalled();\n                    expect($button.is(':disabled')).toBe(false);\n\n                    $button.click();\n                    expect(dialog.send).toHaveBeenCalled();\n                });\n            });\n        });\n\n        it('Dialog for updating an existing file attachment', function() {\n            dialog = new RB.UploadAttachmentView({\n                attachmentHistoryID: 14,\n                presetCaption: 'fakecaption',\n                reviewRequest: reviewRequest,\n            });\n\n            dialog.show();\n            const $caption = dialog.$('[name=\"caption\"]');\n            const $attachmentHistory = dialog.$('[name=\"attachment_history\"]');\n\n            expect($caption.length).toBe(1);\n            expect($caption.val()).toBe('fakecaption');\n\n            expect($attachmentHistory.length).toBe(1);\n            expect($attachmentHistory.val()).toBe('14');\n        });\n    });\n});\n"]}
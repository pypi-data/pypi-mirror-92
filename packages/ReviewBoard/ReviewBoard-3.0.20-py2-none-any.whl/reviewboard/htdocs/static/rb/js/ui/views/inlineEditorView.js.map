{"version":3,"sources":["inlineEditorView.es6.js"],"names":[],"mappings":"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","file":"inlineEditorView.js","sourcesContent":["/**\n * A view for inline editors.\n *\n * This provides the framework for items which are \"editable\". These provide a\n * way to switch between a normal view and an edit view, which is usually a\n * text box (either single- or multiple-line).\n */\nRB.InlineEditorView = Backbone.View.extend({\n    /**\n     * Defaults for the view options.\n     */\n    defaultOptions: {\n        animationSpeedMS: 200,\n        deferEventSetup: false,\n        editIconPath: null,\n        editIconClass: null,\n        enabled: true,\n        extraHeight: 100,\n        focusOnOpen: true,\n        formatResult: value => value.htmlEncode(),\n        formClass: '',\n        getFieldValue: editor => editor.$field.val(),\n        hasRawValue: false,\n        isFieldDirty: (editor, initialValue) => {\n            const value = editor.getValue() || '';\n            const normValue = (editor.options.hasRawValue\n                               ? value\n                               : value.htmlEncode()) || '';\n            initialValue = editor.normalizeText(initialValue);\n\n            return (normValue.length !== initialValue.length ||\n                    normValue !== initialValue);\n        },\n        matchHeight: true,\n        multiline: false,\n        notifyUnchangedCompletion: false,\n        promptOnCancel: true,\n        rawValue: null,\n        setFieldValue: (editor, value) => editor.$field.val(value),\n        showButtons: true,\n        showEditIcon: true,\n        showRequiredFlag: false,\n        startOpen: false,\n    },\n\n    /**\n     * Initialize the view.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the view.\n     *\n     * Option Args:\n     *     animationSpeedMS (number, optional):\n     *         The duration of animated transitions, in milliseconds.\n     *\n     *     deferEventSetup (boolean, optional):\n     *         Whether to defer event setup after rendering. This should be\n     *         used when a consumer wants to prioritize event handling (such as\n     *         handling the \"enter\" key for autocomplete).\n     *\n     *     editIconClass (string, optional):\n     *         The class name to use for the edit icon, when the icon is\n     *         created via CSS rules. This is only used if ``editIconPath`` is\n     *         unspecified.\n     *\n     *     editIconPath (string, optional):\n     *         The path for an image for the edit icon.\n     *\n     *     enabled (boolean):\n     *         Whether editing is enabled.\n     *\n     *     extraHeight (number, optional):\n     *         Extra height to add when displaying the editor, in pixels.\n     *\n     *     focusOnOpen (boolean, optional):\n     *         Whether to focus the field when opening the editor.\n     *\n     *     formatResult (function, optional):\n     *         A function to format the resulting value after editing back\n     *         into the element.\n     *\n     *     formClass (string, optional):\n     *         The class to add to the form's DOM element.\n     *\n     *     getFieldValue (function, optional):\n     *         A function to retrieve the field value.\n     *\n     *     hasRawValue (boolean, optional):\n     *         Whether the field has a \"raw value\", which is data for the field\n     *         separate from the actual contents of the element.\n     *\n     *     isFieldDirty (function, optional):\n     *         A function to calculate whether the editor value is dirty.\n     *\n     *     matchHeight (boolean, optional):\n     *         Whether to attempt to match the height of the editor and the\n     *         element it's replacing.\n     *\n     *     multiline (boolean, optional):\n     *         Whether the text input should be multi-line or single-line.\n     *\n     *     notifyUnchangedCompletion (boolean, optional):\n     *         Whether the editor should trigger a ``complete`` event even if\n     *         the value was unchanged. If this is ``false``, the editor will\n     *         trigger a ``cancel`` event instead.\n     *\n     *     promptOnCancel (boolean, optional):\n     *         Whether to prompt the user before cancelling if the editor is\n     *         dirty.\n     *\n     *     rawValue (*, optional):\n     *         When ``hasRawValue`` is ``true``, this provides the data for the\n     *         raw value of the item being edited.\n     *\n     *     setFieldValue (function, optional):\n     *         A function to set the field value.\n     *\n     *     showButtons (boolean, optional):\n     *         Whether to show OK/Cancel buttons.\n     *\n     *     showEditIcon (boolean, optional):\n     *         Whether to show the edit icon.\n     *\n     *     showRequiredFlag (boolean, optional):\n     *         Whether to show the required flag on the edit icon.\n     *\n     *     startOpen (boolean, optional):\n     *         Whether the editor should be open when first created.\n     *\n     *     stripTags (boolean, optional):\n     *         Whether to strip out HTML tags when normalizing input.\n     *\n     *     useEditIconOnly (boolean, optional):\n     *         Whether the editor can be opened only by clicking on the edit\n     *         icon. If false, clicking on the field value will also trigger an\n     *         edit.\n     */\n    initialize(options) {\n        this.options = _.defaults(options, this.defaultOptions);\n        this._initialValue = null;\n        this._editing = false;\n        this._dirty = false;\n        this._dirtyCalcTimeout = null;\n    },\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     RB.InlineEditorView:\n     *     This object, for chaining.\n     */\n    render() {\n        this._$form = $('<form>')\n            .addClass(`inline-editor-form ${this.options.formClass}`)\n            .css('display', 'inline')\n            .hide()\n            .insertBefore(this.$el);\n\n        this.$field = this.createField()\n            .prependTo(this._$form);\n        this._isTextArea = (this.$field[0].tagName === 'TEXTAREA');\n\n        this.$buttons = $();\n\n        if (this.options.showButtons) {\n            this.$buttons = $(this.options.multiline ? '<div>' : '<span>')\n                .hide()\n                .addClass('buttons')\n                .appendTo(this._$form);\n\n            $('<input type=\"button\" class=\"save\">')\n                .val(gettext('OK'))\n                .appendTo(this.$buttons)\n                .click(this.submit.bind(this));\n\n            $('<input type=\"button\" class=\"cancel\">')\n                .val(gettext('Cancel'))\n                .appendTo(this.$buttons)\n                .click(this.cancel.bind(this));\n        }\n\n        this._$editIcon = $();\n\n        if (this.options.showEditIcon) {\n            const editText = gettext('Edit this field');\n            this._$editIcon = $('<a class=\"editicon\" href=\"#\" role=\"button\">')\n                .attr({\n                    'title': editText,\n                    'aria-label': editText,\n                })\n                .click(e => {\n                    e.preventDefault();\n                    e.stopPropagation();\n\n                    this.startEdit();\n                });\n\n            if (this.options.editIconPath) {\n                this._$editIcon.append(\n                    `<img src=\"${this.options.editIconPath}\">`);\n            } else if (this.options.editIconClass) {\n                this._$editIcon.append(\n                    `<div class=\"${this.options.editIconClass}\" aria-hidden=\"true\"></div>`);\n            }\n\n            if (this.options.showRequiredFlag) {\n                const requiredText = gettext('This field is required');\n                $('<span class=\"required-flag\">*</span>')\n                    .attr({\n                        'aria-label': requiredText,\n                        'title': requiredText,\n                    })\n                    .appendTo(this._$editIcon);\n            }\n\n            if (this.options.multiline && this.$el[0].id) {\n                $(`label[for=\"${this.$el[0].id}\"]`)\n                    .append(this._$editIcon);\n            } else {\n                this._$editIcon.insertAfter(this.$el);\n            }\n        }\n\n        if (!this.options.deferEventSetup) {\n            this.setupEvents();\n        }\n\n        if (this.options.startOpen) {\n            this.startEdit({\n                preventAnimation: true,\n            });\n        }\n\n        if (this.options.enabled) {\n            this.enable();\n        } else {\n            this.disable();\n        }\n\n        return this;\n    },\n\n    /**\n     * Create and return the field to use for the input element.\n     *\n     * Returns:\n     *     jQuery:\n     *     The newly created input element.\n     */\n    createField() {\n        if (this.options.multiline) {\n            return $('<textarea>').autoSizeTextArea();\n        } else {\n            return $('<input type=\"text\">');\n        }\n    },\n\n    /**\n     * Connect events.\n     */\n    setupEvents() {\n        this.$field\n            .keydown(e => {\n                e.stopPropagation();\n\n                switch (e.keyCode || e.charCode || e.which) {\n                    case 13: // Enter\n                        if (!this.options.multiline || e.ctrlKey) {\n                            this.submit();\n                        }\n\n                        if (!this.options.multiline) {\n                            e.preventDefault();\n                        }\n\n                        break;\n\n                    case 27: // Escape\n                        this.cancel();\n                        break;\n\n                    case 83: // S\n                    case 115: // s\n                        if (e.ctrlKey) {\n                            this.submit();\n                            e.preventDefault();\n                        }\n                        break;\n\n                    default:\n                        break;\n                }\n            })\n            .keypress(e => e.stopPropagation())\n            .keyup(e => {\n                e.stopPropagation();\n                e.preventDefault();\n\n                this._scheduleUpdateDirtyState();\n            })\n            .on('cut paste', () => this._scheduleUpdateDirtyState());\n\n        if (!this.options.useEditIconOnly) {\n            /*\n             * Check if the mouse was dragging, so that the editor isn't opened\n             * when text is selected.\n             */\n            let isDragging = true;\n\n            this.$el\n                .on('click', 'a', e => e.stopPropagation())\n                .click(e => {\n                    e.stopPropagation();\n                    e.preventDefault();\n\n                    if (!isDragging) {\n                        this.startEdit();\n                    }\n\n                    isDragging = true;\n                })\n                .mousedown(() => {\n                    isDragging = false;\n                    this.$el.one('mousemove', () => {\n                        isDragging = true;\n                    });\n                })\n                .mouseup(() => {\n                    this.$el.unbind('mousemove');\n                });\n        }\n\n        $(window).resize(this._fitWidthToParent.bind(this));\n    },\n\n    /**\n     * Start editing.\n     *\n     * Args:\n     *     options (object, optional):\n     *         Options for the operation.\n     *\n     * Option Args:\n     *     preventAnimation (boolean, optional):\n     *         Whether to prevent the default animation.\n     */\n    startEdit(options={}) {\n        if (this._editing || !this.options.enabled) {\n            return;\n        }\n\n        let value;\n\n        if (this.options.hasRawValue) {\n            this._initialValue = this.options.rawValue;\n            value = this._initialValue;\n        } else {\n            this._initialValue = this.$el.text();\n            value = this.normalizeText(this._initialValue).htmlDecode();\n        }\n\n        this._editing = true;\n        this.options.setFieldValue(this, value);\n\n        this.trigger('beginEditPreShow');\n        this.showEditor(options);\n        this.trigger('beginEdit');\n    },\n\n    /**\n     * Show the editor.\n     *\n     * Args:\n     *     options (object, optional):\n     *         Options for the operation.\n     *\n     * Options Args:\n     *     preventAnimation (boolean, optional):\n     *         Whether to prevent the default animation.\n     */\n    showEditor(options={}) {\n        if (this.options.multiline && !options.preventAnimation) {\n            this._$editIcon.fadeOut(this.options.animationSpeedMS);\n        } else {\n            this._$editIcon.hide();\n        }\n\n        this.$el.hide();\n        this._$form.show();\n\n        if (this.options.multiline) {\n            const elHeight = this.$el.outerHeight();\n            const newHeight = elHeight + this.options.extraHeight;\n\n            this._fitWidthToParent();\n\n            if (this._isTextArea) {\n                if (this.options.matchHeight) {\n                    // TODO: Set autosize min height\n                    this.$field\n                        .autoSizeTextArea('setMinHeight', newHeight)\n                        .css('overflow', 'hidden');\n\n                    if (options.preventAnimation) {\n                        this.$field.height(newHeight);\n                    } else {\n                        this.$field\n                            .height(elHeight)\n                            .animate({ height: newHeight },\n                                     this.options.animationSpeedMS);\n                    }\n                } else {\n                    /*\n                     * If there's significant processing that happens between\n                     * the text and what's displayed in the element, it's\n                     * likely that the rendered size will be different from the\n                     * editor size. In that case, don't try to match sizes,\n                     * just ask the field to auto-size itself to the size of\n                     * the source text.\n                     */\n                    this.$field.autoSizeTextArea('autoSize', true, false,\n                                                  elHeight);\n                }\n            }\n        }\n\n        this.$buttons.show();\n\n        // Execute this after the animation, if we performed one.\n        this.$field.queue(() => {\n            if (this.options.multiline && this._isTextArea) {\n                this.$field.css('overflow', 'auto');\n            }\n\n            this._fitWidthToParent();\n\n            if (this.options.focusOnOpen) {\n                this.$field.focus();\n            }\n\n            if (!this.options.multiline &&\n                this.$field[0].tagName === 'INPUT') {\n                this.$field[0].select();\n            }\n\n            this.$field.dequeue();\n        });\n    },\n\n    /**\n     * Hide the inline editor.\n     */\n    hideEditor() {\n        this.$field.blur();\n        this.$buttons.hide();\n\n        if (this.options.multiline) {\n            this._$editIcon.fadeIn(this.options.animationSpeedMS);\n        } else {\n            this._$editIcon.show();\n        }\n\n        if (this.options.multiline &&\n            this.options.matchHeight &&\n            this._editing &&\n            this._isTextArea) {\n            this.$field\n                .css('overflow', 'hidden')\n                .animate({ height: this.$el.outerHeight() },\n                        this.options.animationSpeedMS);\n        }\n\n        this.$field.queue(() => {\n            this.$el.show();\n            this._$form.hide();\n            this.$field.dequeue();\n        });\n\n        this._editing = false;\n        this._updateDirtyState();\n    },\n\n    /**\n     * Save the value of the editor.\n     */\n    save() {\n        const value = this.getValue();\n        const initialValue = this._initialValue;\n        const dirty = this.isDirty();\n\n        if (dirty) {\n            this.$el.html(this.options.formatResult(value));\n            this._initialValue = this.$el.text();\n        }\n\n        if (dirty || this.options.notifyUnchangedCompletion) {\n            this.trigger('complete', value, initialValue);\n\n            if (this.options.hasRawValue) {\n                this.options.rawValue = value;\n            }\n        } else {\n            this.trigger('cancel', this._initialValue);\n        }\n    },\n\n    /**\n     * Submit the editor.\n     */\n    submit() {\n        // hideEditor() resets the _dirty flag, so we need to save() first.\n        this.save();\n        this.hideEditor();\n    },\n\n    /**\n     * Cancel the edit.\n     */\n    cancel() {\n        if (!this.isDirty() ||\n            !this.options.promptOnCancel ||\n            confirm(gettext('You have unsaved changes. Are you sure you want to discard them?'))) {\n            this.hideEditor();\n            this.trigger('cancel', this._initialValue);\n        }\n    },\n\n    /**\n     * Return the dirty state of the editor.\n     *\n     * Returns:\n     *     boolean:\n     *     Whether the editor is currently dirty.\n     */\n    isDirty() {\n        if (this._dirtyCalcTimeout !== null) {\n            clearTimeout(this._dirtyCalcTimeout);\n            this._updateDirtyState();\n        }\n\n        return this._dirty;\n    },\n\n    /**\n     * Return the value in the field.\n     *\n     * Returns:\n     *     *:\n     *     The current value of the field.\n     */\n    getValue() {\n        return this.options.getFieldValue(this);\n    },\n\n    /**\n     * Set the value in the field.\n     *\n     * Args:\n     *     value (*):\n     *     The new value for the field.\n     */\n    setValue(value) {\n        this.options.setFieldValue(this, value);\n        this._updateDirtyState();\n    },\n\n    /**\n     * Enable the editor.\n     */\n    enable() {\n        if (this._editing) {\n            this.showEditor();\n        }\n\n        this._$editIcon.show();\n        this.options.enabled = true;\n    },\n\n    /**\n     * Disable the editor.\n     */\n    disable() {\n        if (this._editing) {\n            this.hideEditor();\n        }\n\n        this._$editIcon.hide();\n        this.options.enabled = false;\n    },\n\n    /**\n     * Return whether the editor is currently in edit mode.\n     *\n     * Returns:\n     *     boolean:\n     *     true if the inline editor is open.\n     */\n    editing() {\n        return this._editing;\n    },\n\n    /**\n     * Normalize the given text.\n     *\n     * Args:\n     *     text (string):\n     *         The text to normalize.\n     *\n     * Returns:\n     *     string:\n     *     The text with ``<br>`` elements turned into newlines and (in the\n     *     case of multi-line data), whitespace collapsed.\n     */\n    normalizeText(text) {\n        if (this.options.stripTags) {\n            /*\n             * Turn <br> elements back into newlines before stripping out all\n             * other tags. Without this, we lose multi-line data when editing\n             * some legacy data.\n             */\n            text = text.replace(/<br>/g, '\\n');\n            text = text.stripTags().strip();\n        }\n\n        if (!this.options.multiline) {\n            text = text.replace(/\\s{2,}/g, ' ');\n        }\n\n        return text;\n    },\n\n    /**\n     * Schedule an update for the dirty state.\n     */\n    _scheduleUpdateDirtyState() {\n        if (this._dirtyCalcTimeout === null) {\n            this._dirtyCalcTimeout = setTimeout(\n                this._updateDirtyState.bind(this), 200);\n        }\n    },\n\n    /**\n     * Update the dirty state of the editor.\n     */\n    _updateDirtyState() {\n        const newDirtyState = (\n            this._editing &&\n            this.options.isFieldDirty(this, this._initialValue));\n\n        if (this._dirty !== newDirtyState) {\n            this._dirty = newDirtyState;\n            this.trigger('dirtyStateChanged', this._dirty);\n        }\n\n        this._dirtyCalcTimeout = null;\n    },\n\n    /**\n     * Fit the editor width to the parent element.\n     */\n    _fitWidthToParent() {\n        if (!this._editing) {\n            return;\n        }\n\n        if (this.options.multiline) {\n            this.$field.css({\n                '-webkit-box-sizing': 'border-box',\n                '-moz-box-sizing': 'border-box',\n                'box-sizing': 'border-box',\n                'width': '100%',\n            });\n            return;\n        }\n\n        const $formParent = this._$form.parent();\n        const parentTextAlign = $formParent.css('text-align');\n        const isLeftAligned = (parentTextAlign === 'left');\n\n        if (!isLeftAligned) {\n            $formParent.css('text-align', 'left');\n        }\n\n        const boxSizing = this.$field.css('box-sizing');\n        let extentTypes;\n\n        if (boxSizing === 'border-box') {\n            extentTypes = 'm';\n        } else if (boxSizing === 'padding-box') {\n            extentTypes = 'p';\n        } else {\n            extentTypes = 'bmp';\n        }\n\n        let buttonsWidth = 0;\n\n        if (this.$buttons.length !== 0) {\n            const buttonsDisplay = this.$buttons.css('display');\n\n            if (buttonsDisplay === 'inline' ||\n                buttonsDisplay === 'inline-block') {\n                /*\n                 * The buttons are set for the same line as the field, so\n                 * factor the width of the buttons container into the field\n                 * width calculation below.\n                 */\n                buttonsWidth = this.$buttons.outerWidth();\n            }\n        }\n\n        /*\n         * First make the field really small so it will fit without wrapping,\n         * then figure out the offset and use it to calculate the desired\n         * width.\n         */\n        this.$field\n            .width(0)\n            .outerWidth(\n                $formParent.innerWidth() -\n                (this._$form.offset().left - $formParent.offset().left) -\n                this.$field.getExtents(extentTypes, 'lr') -\n                buttonsWidth);\n\n        if (!isLeftAligned) {\n            $formParent.css('text-align', parentTextAlign);\n        }\n    },\n});\n\n\n/**\n * A view for inline editors which use the CodeMirror editor for Markdown.\n */\nRB.RichTextInlineEditorView = RB.InlineEditorView.extend({\n    /**\n     * Defaults for the view options.\n     */\n    defaultOptions: _.defaults({\n        matchHeight: false,\n        multiline: true,\n        setFieldValue: (editor, value) =>\n            editor.textEditor.setText(value || ''),\n        getFieldValue: editor => editor.textEditor.getText(),\n        isFieldDirty: (editor, initialValue) => {\n            initialValue = editor.normalizeText(initialValue);\n\n            return editor.textEditor.isDirty(initialValue);\n        },\n    }, RB.InlineEditorView.prototype.defaultOptions),\n\n    /**\n     * Create and return the field to use for the input element.\n     *\n     * Returns:\n     *     jQuery:\n     *     The newly created input element.\n     */\n    createField() {\n        let origRichText;\n\n        this.textEditor = new RB.TextEditorView(this.options.textEditorOptions);\n        this.textEditor.$el.on('resize', () => this.trigger('resize'));\n\n        this.$el.data('text-editor', this.textEditor);\n\n        this.once('beginEdit', () => {\n            const $span = $('<span class=\"enable-markdown\">');\n            const $checkbox = $('<input type=\"checkbox\">')\n                .attr('id', _.uniqueId('markdown_check'))\n                .change(() => _.defer(() => this._updateDirtyState()))\n                .appendTo($span);\n\n            this.textEditor.bindRichTextCheckbox($checkbox);\n\n            $('<label>')\n                .attr('for', $checkbox[0].id)\n                .text(gettext('Enable Markdown'))\n                .appendTo($span);\n\n            this.$buttons.append($span);\n\n            const $markdownRef = $('<a class=\"markdown-info\" target=\"_blank\">')\n                .attr('href', `${MANUAL_URL}users/markdown/`)\n                .text(gettext('Markdown Reference'))\n                .setVisible(this.textEditor.richText)\n                .appendTo(this.$buttons);\n\n            this.textEditor.bindRichTextVisibility($markdownRef);\n        });\n\n        this.listenTo(this, 'beginEdit', () => {\n            this.textEditor._showEditor();\n            origRichText = this.textEditor.richText;\n        });\n\n        this.listenTo(this, 'cancel', () => {\n            this.textEditor._hideEditor();\n            this.textEditor.setRichText(origRichText);\n        });\n\n        this.listenTo(this, 'complete', () => this.textEditor._hideEditor());\n\n        return this.textEditor.render().$el;\n    },\n});\n"]}
(function(e){function t(t){for(var i,a,s=t[0],d=t[1],u=t[2],l=0,h=[];l<s.length;l++)a=s[l],Object.prototype.hasOwnProperty.call(n,a)&&n[a]&&h.push(n[a][0]),n[a]=0;for(i in d)Object.prototype.hasOwnProperty.call(d,i)&&(e[i]=d[i]);c&&c(t);while(h.length)h.shift()();return o.push.apply(o,u||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],i=!0,s=1;s<r.length;s++){var d=r[s];0!==n[d]&&(i=!1)}i&&(o.splice(t--,1),e=a(a.s=r[0]))}return e}var i={},n={app:0},o=[];function a(t){if(i[t])return i[t].exports;var r=i[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=i,a.d=function(e,t,r){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(r,i,function(t){return e[t]}.bind(null,i));return r},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/static/live-editor/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],d=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var c=d;o.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";var i=r("85ec"),n=r.n(i);n.a},1:function(e,t){},"25f7":function(e,t,r){},"4d2c":function(e,t,r){},5077:function(e,t,r){"use strict";var i=r("4d2c"),n=r.n(i);n.a},"56d7":function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var i=r("2b0e"),n=r("3003"),o=r("28dd"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("Editor")],1)},s=[],d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"cont",attrs:{id:"container"}},[r("div",{attrs:{id:"toolbar"}},[r("div",{attrs:{id:"toolbar-controls"}},[r("button",{on:{click:e.saveChanges}},[e._v("Save")]),r("button",{on:{click:e.exitEditor}},[e._v("Exit editor")])]),e._m(0)]),r("div",{attrs:{id:"editor"}},[r("div",{style:{width:e.editor_width},attrs:{id:"editor-panel"}},[r("textarea",{ref:"edtext",domProps:{value:e.editor_text},on:{input:e.updateFromEditor}})]),r("div",{ref:"dragbar",attrs:{id:"dragbar"}}),r("div",{style:{width:e.preview_width,"grid-template-rows":e.preview_rows},attrs:{id:"preview-panel"}},[r("div",{attrs:{id:"preview-window"},domProps:{innerHTML:e._s(e.compiledMarkdown)}}),r("div",{ref:"warningcounter",style:{background:e.warningColour},attrs:{id:"warning-counter"}},[e._v(" "+e._s(e.warningNumber)+" "+e._s(e.warningShowMsg)+" ")]),r("div",{attrs:{id:"warning-window"},domProps:{innerHTML:e._s(e.compilerLog)}})])]),r("div",{style:{visibility:e.saveMessageVisible},attrs:{id:"saving-background"}},[r("div",{attrs:{id:"saving-message"}},[e._v(" Please wait while project rebuilds "),r("vue-simple-spinner",{attrs:{size:"medium"}})],1)])])},u=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"editor-title"}},[r("h3",[e._v("GitBuilding Live Editor")])])}],c=(r("a481"),r("ac6a"),{name:"Editor",components:{},data:function(){return{saving:!1,saved_text:"",editor_text:"",editor_text_debounced:"",page:"",compilerOutput:new Promise((function(e){e({data:{html:"",number:0,log:""}})})),dragAndDropCapable:!1,files:[],uploadedFiles:[],editor_width:"49.75%",preview_width:"49.75%",preview_rows:"auto 24px 0",warnings_visible:!1}},mounted:function(){var e=this;window.addEventListener("keydown",(function(t){if(t.ctrlKey||t.metaKey)switch(String.fromCharCode(t.which).toLowerCase()){case"s":t.preventDefault(),e.saveChanges();break}})),window.addEventListener("beforeunload",this.checkSave),this.$refs.dragbar.addEventListener("mousedown",this.enable_dragbar),this.$refs.warningcounter.addEventListener("click",this.hideshow_warnigns),this.dragAndDropCapable=this.determineDragAndDropCapable(),this.dragAndDropCapable&&(["drag","dragstart","dragend","dragover","dragenter","dragleave","drop"].forEach(function(e){this.$refs.edtext.addEventListener(e,function(e){e.preventDefault(),e.stopPropagation()}.bind(this),!1)}.bind(this)),this.$refs.edtext.addEventListener("drop",function(e){for(var t=0;t<e.dataTransfer.files.length;t++)this.files.push(e.dataTransfer.files[t]);this.submitFiles()}.bind(this)))},watch:{editor_text_debounced:function(){this.compilerOutput=this.$http.post("/-/render_markdown",{md:this.editor_text_debounced,page:this.page})}},asyncComputed:{compiledMarkdown:function(){return this.compilerOutput.then((function(e){return e.data.html}))},compilerLog:function(){return this.compilerOutput.then((function(e){return e.data.log}))},warningNumber:function(){return this.compilerOutput.then((function(e){return e.data.number>1?"There are "+e.data.number+" warnings on this page.":1==e.data.number?"There is 1 warning on this page.":"There are no warnings on this page."}))},warningColour:function(){return this.compilerOutput.then((function(e){return e.data.number>0?"#fb9e9e":"#9efb9e"}))},warningShowMsg:function(){return this.warnings_visible?"(Click to hide)":"(Click to show)"},saveMessageVisible:function(){return this.saving?"visible":"hidden"}},methods:{updateFromEditor:function(e){this.editor_text=e.target.value},updateFromServer:function(){this.$http.get("raw").then((function(e){this.editor_text=e.body.md,this.editor_text_debounced=this.editor_text,this.saved_text=this.editor_text,this.page=e.body.page}))},pollEditor:function(){var e=this;setInterval((function(){e.editor_text_debounced=e.editor_text}),500)},saveChanges:function(){var e=this;this.saving=!0,this.$http.post("save",{md:this.editor_text,page:this.page,uploadedFiles:this.uploadedFiles}).then((function(t){e.saving=!1,t.body.saved?(e.$fire({type:"success",text:"Save sucessful!",title:"Saved",heightAuto:!1}),e.saved_text=e.editor_text):e.$fire({type:"error",text:"Save completed with error.",title:"Error",heightAuto:!1})})).catch((function(t){e.saving=!1,console.error(t),e.$fire({type:"error",text:"Save completed with error.",title:"Error",heightAuto:!1})}))},checkSave:function(e){this.saved_text!=this.editor_text&&(e.returnValue="Are you sure you want to leave?")},exitEditor:function(){window.location.href=window.location.href.replace(/\/-\/editor\//,"")},enable_dragbar:function(){this.$refs.cont.addEventListener("mousemove",this.bar_dragged),this.$refs.cont.addEventListener("mouseup",this.disable_dragbar)},disable_dragbar:function(){this.$refs.cont.removeEventListener("mouseup",this.disable_dragbar),this.$refs.cont.removeEventListener("mousemove",this.bar_dragged)},bar_dragged:function(e){var t=100*e.pageX/this.$refs.cont.clientWidth;this.editor_width=t-.5+"%",this.preview_width=100-t+"%"},hideshow_warnigns:function(){this.warnings_visible=!this.warnings_visible,this.warnings_visible?this.preview_rows="70% 24px auto":this.preview_rows="auto 24px 0"},determineDragAndDropCapable:function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&"FormData"in window&&"FileReader"in window},submitFiles:function(){for(var e=this,t=new FormData,r=0;r<this.files.length;r++){var i=this.files[r];t.append("files["+r+"]",i)}this.files=[],this.$axios.post("dropped-file",t,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){for(var t=this.$refs.edtext.selectionEnd,r=0;r<e.data.filenames.length;r++)this.uploadedFiles.push(e.data.filenames[r]);this.$refs.edtext.setRangeText("\n"+e.data.md_line+"\n",t,t,"end"),this.editor_text=this.$refs.edtext.value}.bind(this)).catch((function(t){console.error(t),e.$fire({type:"error",text:"Upload completed with an error.",title:"Error",heightAuto:!1})}))}},created:function(){this.updateFromServer(),this.pollEditor()}}),l=c,h=(r("b16a"),r("5077"),r("2877")),p=Object(h["a"])(l,d,u,!1,null,"67db16f4",null),f=p.exports,v={name:"app",components:{Editor:f}},g=v,w=(r("034f"),Object(h["a"])(g,a,s,!1,null,null,null)),b=w.exports,m=r("bc3a"),_=r.n(m),x=r("683f"),y=r("5b7e"),E=r.n(y);i["a"].config.productionTip=!1,i["a"].use(n["a"]),i["a"].use(o["a"]),i["a"].prototype.$axios=_.a,i["a"].use(x["a"]),i["a"].component("vue-simple-spinner",E.a),new i["a"]({render:function(e){return e(b)}}).$mount("#app")},"85ec":function(e,t,r){},b16a:function(e,t,r){"use strict";var i=r("25f7"),n=r.n(i);n.a}});
//# sourceMappingURL=app.e1f25f25.js.map
# LIFTOFF DOCKER CONFIGURATION
# DO NOT EDIT THIS FILE, AS CHANGES MAY BE OVERWRITTEN

version: "3.8"

services:
  nginx:
    image: nginx:latest
    container_name: liftoff-nginx
    restart: on-failure
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
      - ./vhosts:/etc/nginx/sites-enabled
    ports:
      - 80:80
    extra_hosts:
      - "local.liftoff.com:172.17.0.1"
      - "mailhog.local.liftoff.com:172.17.0.1"
    depends_on:
      - php-7.4
      - php-8.0

  php-7.4:
    image: heliumliftoff/php:7.4-fpm
    container_name: liftoff-php-7.4
    restart: on-failure
    extra_hosts:
      - "local.liftoff.com:172.17.0.1"
      - "mailhog.local.liftoff.com:172.17.0.1"

  php-8.0:
    image: heliumliftoff/php:8.0-fpm
    container_name: liftoff-php-8.0
    restart: on-failure
    extra_hosts:
      - "local.liftoff.com:172.17.0.1"
      - "mailhog.local.liftoff.com:172.17.0.1"

  mysql:
    image: mysql:latest
    container_name: liftoff-mysql
    command: --default-authentication-plugin=mysql_native_password
    ports:
      - 3306:3306
    restart: on-failure
    environment:
      MYSQL_ROOT_PASSWORD: liftoff
      MYSQL_USER: liftoff
      MYSQL_PASSWORD: liftoff
    volumes:
      - ~/.liftoff/mysql:/var/lib/mysql

  pgsql:
    image: postgres:latest
    container_name: liftoff-pgsql
    ports:
      - "5432:5432"
    restart: on-failure
    environment:
      POSTGRES_USER: liftoff
      POSTGRES_PASSWORD: liftoff
    volumes:
      - ~/.liftoff/pgsql:/var/lib/postgresql/data

  adminer:
    image: adminer:latest
    container_name: liftoff-adminer
    restart: on-failure
    ports:
      - 8079:8080
    extra_hosts:
      - "local.liftoff.com:172.17.0.1"
      - "mailhog.local.liftoff.com:172.17.0.1"

  mailhog:
    image: "mailhog/mailhog:latest"
    container_name: liftoff-mailhog
    restart: on-failure
    ports:
      - 1025:1025
      - 8025:8025
    extra_hosts:
      - "local.liftoff.com:172.17.0.1"
      - "mailhog.local.liftoff.com:172.17.0.1"
    volumes:
      - ~/.liftoff/mailhog:/maildir

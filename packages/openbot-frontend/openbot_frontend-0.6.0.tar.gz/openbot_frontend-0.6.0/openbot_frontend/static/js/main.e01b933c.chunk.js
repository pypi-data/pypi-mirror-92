(this.webpackJsonpopenbot_frontend=this.webpackJsonpopenbot_frontend||[]).push([[0],{302:function(e,t,n){},304:function(e,t,n){},471:function(e,t,n){},475:function(e,t,n){},584:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n(51),r=n(1),s=n.n(r),i=n(42),l=n.n(i),o=(n(302),n(36)),j=n(21),d=n(609),b=n(615),u=n(596),h=n(606),O=n(617),x=(n(303),n(12)),p=n(15),f=n(616),m=n(602);n(304);function v(e){return Object(c.jsx)("div",Object(x.a)({className:"button-bar"},e))}function g(e){if(e<120)return"".concat(e," seconds");var t=Math.round(e/6)/10;return"".concat(t," minutes")}function w(e){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{children:["Sessions: ",e.sessions.length]}),Object(c.jsxs)("div",{children:["Length: ",g(e.sessions.reduce((function(e,t){return e+t.seconds}),0))]}),Object(c.jsxs)("div",{children:["Frames: ",e.sessions.reduce((function(e,t){return e+t.ctrl.length}),0)]})]})}var y=n(45),k=n.n(y),S=n(70),C=n(33),E=n(295),F=n(29),_=n(607),D=n(597),T=n(610),A=n(587),I=n(620),N=n(604),M=n(588),L=n(618),H=n(34);function P(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Object(r.useReducer)(B,e)}function B(e){return!e}var R=new Set,z=new Set,U=function e(){z.forEach((function(e){return e("connecting")}));var t=window.location.protocol.replace("http","ws"),n=new WebSocket("".concat(t,"//").concat(window.location.host,"/ws"));return n.addEventListener("open",(function(){console.log("ws.open"),z.forEach((function(e){return e("connected")}))})),n.addEventListener("message",(function(e){console.log("ws.message",e.data);var t=JSON.parse(e.data);R.forEach((function(n){n(t,e)}))})),n.addEventListener("close",(function(){console.warn("ws.closed"),z.forEach((function(e){return e("closed")})),setTimeout((function(){U=e()}),3e3),n.close()})),n.addEventListener("error",(function(){console.error("ws.error")})),n}(),J=1;function W(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),c=1;c<t;c++)n[c-1]=arguments[c];return new Promise((function(t,c){var a=J++,r=V((function(e){"2.0"===e.jsonrpc&&e.id===a&&(r(),e.error?c(e.error):t(e.result))}));G({jsonrpc:"2.0",method:e,params:n,id:a}),setTimeout((function(){r(),c("JsonRpc timeout")}),3e4)}))}function G(e){if(U.readyState===WebSocket.OPEN){var t=JSON.stringify(e);console.log("ws.send",t),U.send(t)}else var n=Y((function(t){"connected"===t&&(n(),G(e))}))}function q(e,t){function n(n,c){"method"in n&&n.method===e&&t(n.params,n,c)}R.add(n),W("subscribe",e);var c=Y((function(t){"connected"===t&&W("subscribe",e)}));return function(){R.delete(n),W("unsubscribe",e),c()}}function V(e){return R.add(e),function(){R.delete(e)}}function Y(e){return z.add(e),function(){z.delete(e)}}function Z(e){var t=P(),n=Object(p.a)(t,2),a=n[0],r=n[1];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(E.a,{appearance:"ghost",onClick:r,icon:Object(c.jsx)(F.a,{icon:"plus"}),children:"Create dataset"}),Object(c.jsx)(X,Object(x.a)(Object(x.a)({},e),{},{show:a,toggle:r}))]})}function X(e){var t=e.defaultDir,n=e.name,a=e.toggle,s=Object(C.a)(e,["defaultDir","name","toggle"]),i=n?"Move/Rename dataset":"Create dataset",l=Object(r.useState)(t),o=Object(p.a)(l,2),d=o[0],b=o[1],u=Object(r.useState)(n||""),h=Object(p.a)(u,2),O=h[0],f=h[1],m=Object(j.f)();function v(){return(v=Object(S.a)(k.a.mark((function e(t,n,c,r){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!r){e.next=8;break}return e.next=4,W("renameDataset",{newDir:t,newName:n,oldDir:c,oldName:r});case 4:m.replace("/".concat(t,"/").concat(n)),a(),e.next=11;break;case 8:return e.next=10,W("createDataset",{newDir:t,newName:n});case 10:a();case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),_.a.warning({title:"".concat(e.t0)});case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}return Object(c.jsxs)(D.a,Object(x.a)(Object(x.a)({backdrop:"static",size:"sm"},s),{},{children:[Object(c.jsx)(D.a.Header,{children:Object(c.jsx)(D.a.Title,{children:i})}),Object(c.jsx)(D.a.Body,{children:Object(c.jsxs)(T.a,{layout:"horizontal",children:[Object(c.jsxs)(A.a,{children:[Object(c.jsx)(I.a,{children:"Name:"}),Object(c.jsx)(N.a,{value:O,onChange:f})]}),Object(c.jsxs)(A.a,{children:[Object(c.jsx)(I.a,{children:"Dir: "}),Object(c.jsxs)(M.a,{inline:!0,appearance:"picker",value:d,onChange:b,children:[Object(c.jsx)(L.a,{value:"train_data",children:"Train"}),Object(c.jsx)(L.a,{value:"test_data",children:"Test"})]})]})]})}),Object(c.jsxs)(D.a.Footer,{children:[Object(c.jsx)(H.a,{onClick:function(){return function(e,t,n,c){return v.apply(this,arguments)}(d,O,t,n)},appearance:"primary",children:"Save"}),Object(c.jsx)(H.a,{onClick:a,appearance:"subtle",children:"Cancel"})]})]}))}var K=n(137),Q=n(73),$=n(144),ee=n(614),te=n(608),ne=n(600),ce=n(599),ae=n(612),re=n(611),se=100;function ie(e){var t=e.left,n=e.right;return void 0===t&&void 0===n?Object(c.jsx)("svg",{viewBox:"0 0 50 50",width:se,children:Object(c.jsx)("text",{x:10,y:25,children:"N/A"})}):t||n?Object(c.jsxs)("svg",{viewBox:"0 0 200 200",width:se,children:[Object(c.jsx)("defs",{children:Object(c.jsx)("marker",{id:"arrowhead",markerWidth:"10",markerHeight:"7",refX:"0",refY:"3.5",orient:"auto",children:Object(c.jsx)("polygon",{points:"0 0, 10 3.5, 0 7"})})}),Object(c.jsx)("line",{x1:se,x2:se+(t-n)/2,y1:se+(t+n)/4,y2:se-(t+n)/4,stroke:"#000",strokeWidth:3,markerEnd:"url(#arrowhead)"})]}):Object(c.jsx)("svg",{viewBox:"0 0 50 50",width:se,children:Object(c.jsx)("text",{x:10,y:25,children:"stop"})})}function le(e,t,n){var c=Object(r.useState)(),a=Object(p.a)(c,2),s=a[0],i=a[1],l=Object(r.useState)(!0),o=Object(p.a)(l,2),j=o[0],d=o[1],b=Object(r.useState)(e),u=Object(p.a)(b,2),h=u[0],O=u[1],x=P(!1),f=Object(p.a)(x,2),m=f[0],v=f[1],g=Object(r.useMemo)((function(){return n}),[JSON.stringify(n)]);return Object(r.useEffect)((function(){d(!0);var e=!0;return console.log("useRpc",t,g),W(t,g).then((function(t){e&&(O(t),i(void 0),d(!1))})).catch((function(t){e&&(console.error(t),i(t),d(!1))})),function(){e=!1}}),[t,g,m]),{error:s,pending:j,value:h,reload:v}}function oe(){return le([],"getModels")}function je(){var e=le([],"getModelFiles"),t=e.error,n=e.pending,c=e.value,a=e.reload;return Object(r.useEffect)((function(){return q("modelFile",a)}),[a]),{error:t,pending:n,value:c,reload:a}}function de(){var e=Object(Q.a)(["\n    display: flex;\n    gap: 10px;\n    margin: 20px 0;\n    > img {\n        flex: 1;\n        width: 100%;\n        max-width: 600px;\n        align-self: flex-start;\n    }\n    > div {\n        vertical-align: top;\n        text-align: center;\n        width: 130px;\n    }\n"]);return de=function(){return e},e}var be=[{label:"-1",value:"-1"},{label:"0",value:"0"},{label:"1",value:"1"}];function ue(){var e=Object(j.h)(),t=le(null,"getSession",e.url).value;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h3",{children:e.params.path}),Object(c.jsx)(f.a,{shaded:!0,children:t?Object(c.jsx)(Oe,{session:t}):Object(c.jsx)(ee.a,{})})]})}var he=Object(a.b)("div")(de());function Oe(e){var t,n,a=e.session,s=a.ctrl.length-1,i=oe(),l=P(!1),o=Object(p.a)(l,2),j=o[0],d=o[1],b=Object(r.useState)(0),u=Object(p.a)(b,2),h=u[0],O=u[1],x=Object(r.useState)(null),m=Object(p.a)(x,2),v=m[0],w=m[1],y=Object(r.useState)(null),k=Object(p.a)(y,2),S=k[0],C=k[1];t=function(){j&&O((function(e){return e===s?0:e+1}))},n=[j,s],Object(r.useEffect)((function(){var e=!0,n=performance.now(),c=function c(){performance.now()-n>25&&(t(),n=performance.now()),e&&requestAnimationFrame(c)};return requestAnimationFrame(c),function(){e=!1}}),n),Object($.a)("space",d),Object($.a)("right",(function(){return O((function(e){return e===s?0:e+1}))}),[s]),Object($.a)("left",(function(){return O((function(e){return 0===e?s:e-1}))}),[s]);var _=function(e,t,n,c){var a=Object(r.useState)(0),s=Object(p.a)(a,2),i=s[0],l=s[1],o=Object(r.useState)([]),j=Object(p.a)(o,2),d=j[0],b=j[1],u=Object(r.useRef)();u.current||(u.current=[]);Object(r.useEffect)((function(){console.log("clear predictions"),u.current=[]}),[n,t,e]);var h=Math.floor(c/xe);u.current[h]&&h++;return Object(r.useEffect)((function(){if(!u.current[h]){u.current[h]=!0,l((function(e){return e+1}));var c=h*xe;W("getPrediction",{path:e,model:t,indicator:n,start:c,end:c+xe}).then((function(e){b((function(t){var n=t.slice();return n[c]=null,n.splice.apply(n,[c,h].concat(Object(K.a)(e))),n})),l((function(e){return e-1}))})).catch((function(){u.current[h]=!1,l((function(e){return e-1}))}))}}),[h,n,t,e]),{value:d,pending:i}}(a.path,v,S,h),D=_.value[h]||[],T=Object(p.a)(D,2),A=T[0],I=T[1],N=Object(p.a)(a.ctrl[h],4),M=N[0],L=N[1],H=N[2],B=N[3];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)(te.a,{children:[Object(c.jsxs)(te.a.Item,{colspan:12,children:[Object(c.jsxs)("div",{children:["Length: ",g(a.seconds)]}),Object(c.jsxs)("div",{children:["Frames: ",a.ctrl.length]}),Object(c.jsxs)("div",{children:["Predictions: ",_.value.length]})]}),Object(c.jsxs)(te.a.Item,{colspan:12,style:{textAlign:"right"},children:["Model ",Object(c.jsx)(ne.a,{placeholder:"Select a model to test",data:i.value.map((function(e){return{label:e,value:e}})),value:v,onChange:w,searchable:i.value.length>10,placement:"bottomEnd"}),Object(c.jsx)("br",{}),"Indicator ",Object(c.jsx)(ne.a,{placeholder:"Use recorded",data:be,value:S,onChange:C,searchable:!1})]})]}),Object(c.jsxs)(he,{children:[Object(c.jsx)("img",{src:"".concat(a.path,"/images/").concat(M),alt:""}),Object(c.jsxs)(f.a,{header:"Recorded",bordered:!0,children:[Object(c.jsx)(ie,{left:+L,right:+H}),"Indicator: ",B]}),Object(c.jsxs)(f.a,{header:"Model",bordered:!0,children:[Object(c.jsx)(ie,{left:A,right:I}),_.pending>0&&Object(c.jsx)(ee.a,{})]})]}),Object(c.jsxs)(te.a,{children:[Object(c.jsx)(E.a,{icon:Object(c.jsx)(F.a,{icon:j?"pause":"arrow-right"}),onClick:d}),Object(c.jsx)(ce.a,{style:{flex:1,margin:14},max:s,value:h,onChange:O}),Object(c.jsx)(ae.a,{min:0,max:s,value:h,onChange:function(e){return O(+e)},style:{maxWidth:100}})]}),Object(c.jsx)("br",{}),Object(c.jsx)(re.a,{title:"Hotkeys",description:Object(c.jsxs)("div",{children:[Object(c.jsx)("div",{children:"Space: toggle playing"}),Object(c.jsx)("div",{children:"Arrow right: next frame"}),Object(c.jsx)("div",{children:"Arrow left: prev frame"})]})})]})}var xe=50;var pe={train:[{name:"loading...",path:"",sessions:[]}],test:[{name:"loading...",path:"",sessions:[]}]};function fe(){var e=le(pe,"getDatasets"),t=e.error,n=e.pending,c=e.value,a=e.reload;return Object(r.useEffect)((function(){return q("dataset",a)}),[a]),{error:t,pending:n,value:c,reload:a}}var me=[];n(471);function ve(e){return Object(c.jsx)("div",Object(x.a)({className:"grid-view"},e))}function ge(e){var t=Object.assign({},e),n=P(!1),a=Object(p.a)(n,2),r=a[0],s=a[1];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(H.a,{onClick:s,children:"Delete"}),Object(c.jsx)(we,Object(x.a)({show:r,onHide:s},t))]})}function we(e){var t=e.type,n=e.path,a=Object(C.a)(e,["type","path"]);function r(){return(r=Object(S.a)(k.a.mark((function e(t,n){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"session"!==t){e.next=6;break}return e.next=4,W("deleteSession",{path:n});case 4:e.next=13;break;case 6:if("model file"!==t){e.next=11;break}return e.next=9,W("deleteModelFile",{path:n});case 9:e.next=13;break;case 11:return e.next=13,W("deleteDataset",{path:n});case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),_.a.warning({title:"".concat(e.t0)});case 18:case"end":return e.stop()}}),e,null,[[0,15]])})))).apply(this,arguments)}return Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)(D.a,Object(x.a)(Object(x.a)({backdrop:"static",size:"xs"},a),{},{children:[Object(c.jsx)(D.a.Header,{children:Object(c.jsx)(D.a.Title,{children:n})}),Object(c.jsxs)(D.a.Body,{children:["Are you really want to delete this ",t,"?","session"===t&&Object(c.jsx)("img",{src:"".concat(n,"/preview.gif"),alt:"preview"})]}),Object(c.jsxs)(D.a.Footer,{children:[Object(c.jsx)(H.a,{onClick:function(){return function(e,t){return r.apply(this,arguments)}(t,n)},appearance:"primary",children:"Yes"}),Object(c.jsx)(H.a,{onClick:a.onHide,appearance:"subtle",children:"No"})]})]}))})}var ye=n(601);function ke(e){var t=e.path,n=Object(C.a)(e,["path"]),a=function(e){return[{value:"uploaded",label:"uploaded"},{value:"train",label:"train",children:e.train.map((function(e){return{value:e.path,label:e.name}}))},{value:"test",label:"test",children:e.test.map((function(e){return{value:e.path,label:e.name}}))}]}(fe().value),s=Object(r.useRef)("");return Object(c.jsx)(D.a,Object(x.a)(Object(x.a)({backdrop:"static",size:"xs"},n),{},{children:Object(c.jsxs)(T.a,{onSubmit:function(){W("moveSession",{path:t,new_path:s.current})},children:[Object(c.jsx)(D.a.Header,{children:Object(c.jsx)(D.a.Title,{children:"Move session"})}),Object(c.jsxs)(D.a.Body,{children:[Object(c.jsxs)(A.a,{children:[Object(c.jsx)(I.a,{children:"To folder:"}),Object(c.jsx)(ye.a,{name:"new_path",data:a,defaultValue:"uploaded",defaultExpandAll:!0,disabledItemValues:["train","test"],onChange:function(e){console.log(e),s.current=e},block:!0})]}),Object(c.jsx)(Z,{defaultDir:"train_data"})]}),Object(c.jsxs)(D.a.Footer,{children:[Object(c.jsx)(H.a,{type:"submit",appearance:"primary",children:"Move"}),Object(c.jsx)(H.a,{onClick:n.onHide,appearance:"subtle",children:"Cancel"})]})]})}))}function Se(){var e=Object(j.h)();return Object(c.jsxs)(j.c,{children:[Object(c.jsx)(j.a,{path:e.url+"/:path",component:ue}),Object(c.jsx)(j.a,{component:Ce})]})}function Ce(){var e,t=P(),n=Object(p.a)(t,2),a=n[0],s=n[1],i=P(),l=Object(p.a)(i,2),o=l[0],d=l[1],b=Object(j.h)(),u=null===(e=b.url.match(/\/(.*)\//))||void 0===e?void 0:e.pop(),h=function(e){var t=le(me,"listDir",{path:e}),n=t.error,c=t.pending,a=t.value,s=t.reload;return Object(r.useEffect)((function(){return q("session",s)}),[s]),{error:n,pending:c,value:a,reload:s}}(b.url).value;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("h3",{children:["Sessions in ",b.url]}),Object(c.jsxs)(f.a,{shaded:!0,children:[Object(c.jsx)(w,{sessions:h}),u&&Object(c.jsxs)(v,{children:[Object(c.jsxs)(m.a,{title:"Actions",placement:"bottomEnd",children:[Object(c.jsx)(m.a.Item,{onSelect:s,children:"Move/Rename..."}),Object(c.jsx)(m.a.Item,{onSelect:d,children:"Delete..."})]}),Object(c.jsx)(X,{defaultDir:u,name:b.params.dataset,show:a,toggle:s}),Object(c.jsx)(we,{type:"dataset",path:b.url,show:o,onHide:d})]})]}),Object(c.jsxs)(ve,{children:[!h.length&&Object(c.jsx)(f.a,{shaded:!0,children:"No sessions"}),h.map((function(e){return Object(c.jsx)(f.a,{bodyFill:!0,shaded:!0,children:Object(c.jsx)(Ee,Object(x.a)({},e))},e.path)}))]})]})}function Ee(e){var t=P(),n=Object(p.a)(t,2),a=n[0],r=n[1],s=P(),i=Object(p.a)(s,2),l=i[0],j=i[1];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("img",{src:"".concat(e.path,"/preview.gif"),alt:"preview"}),Object(c.jsxs)(f.a,{children:[Object(c.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[Object(c.jsx)(o.b,{to:e.path,children:e.name}),Object(c.jsxs)(m.a,{title:"Actions",placement:"bottomEnd",children:[Object(c.jsx)(m.a.Item,{onSelect:r,children:"Move..."}),Object(c.jsx)(m.a.Item,{onSelect:j,children:"Delete..."})]})]}),Object(c.jsxs)("div",{children:["Length: ",g(e.seconds)]}),Object(c.jsxs)("div",{children:["Frames: ",e.ctrl.length]}),e.error&&Object(c.jsxs)("div",{children:["Error: ",e.error]})]}),a&&Object(c.jsx)(ke,{path:e.path,show:a,onHide:r}),Object(c.jsx)(we,{type:"session",path:e.path,show:l,onHide:j})]})}n(475);function Fe(){return Object(r.useEffect)((function(){return Y((function(e){"connected"!==e?_.a.warning({title:"Not connected",key:"connection"}):_.a.close("connection")}))}),[]),null}function _e(){var e=fe();return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h3",{children:"Train datasets"}),Object(c.jsx)(ve,{children:e.value.train.map((function(e){return Object(c.jsx)(De,Object(x.a)({},e),e.name)}))}),Object(c.jsx)(v,{children:Object(c.jsx)(Z,{defaultDir:"train_data"})}),Object(c.jsx)("h3",{children:"Test datasets"}),Object(c.jsx)(ve,{children:e.value.test.map((function(e){return Object(c.jsx)(De,Object(x.a)({},e),e.name)}))}),Object(c.jsx)(v,{children:Object(c.jsx)(Z,{defaultDir:"test_data"})})]})}function De(e){return Object(c.jsx)(f.a,{header:Object(c.jsx)(o.b,{to:e.path,children:e.name}),shaded:!0,children:Object(c.jsx)(w,{sessions:e.sessions})})}var Te=n(291),Ae=n(598),Ie=n(292),Ne=["blue","red"],Me={scales:{xAxes:[{scaleLabel:{display:!0,labelString:"Epoch"}}]}};function Le(e){return Object(c.jsx)(f.a,{bodyFill:!0,shaded:!0,children:Object(c.jsx)(Ie.Line,{data:(t=e.logs,n=[e.metric,"val_".concat(e.metric)],{labels:t.map((function(e,t){return e.epoch||t})),datasets:n.map((function(e,n){return{borderColor:Ne[n],borderWidth:2,fill:!1,label:e,data:t.map((function(t){return t[e]}))}}))}),options:Me})});var t,n}var He=n(619),Pe=n(595),Be=n(139);function Re(){var e=Object(Q.a)(["\n    &.rs-form-group .rs-form-control-wrapper {\n        overflow: hidden;\n        float: none;\n    }\n"]);return Re=function(){return e},e}var ze=Object(a.b)(A.a)(Re());function Ue(e){var t=P(),n=Object(p.a)(t,2),a=n[0],r=n[1];return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(E.a,{appearance:"ghost",onClick:r,icon:Object(c.jsx)(F.a,{icon:"send"}),children:"Push to phone"}),Object(c.jsx)(He.a,{tooltip:!0,children:"Will be accessible only on your local network. The android app will download it automatically."}),Object(c.jsx)(Je,Object(x.a)(Object(x.a)({},e),{},{show:a,toggle:r}))]})}function Je(e){var t=e.model,n=e.toggle,a=Object(C.a)(e,["model","toggle"]),s=Object(r.useState)("best"),i=Object(p.a)(s,2),l=i[0],o=i[1],j=Object(r.useState)(t),d=Object(p.a)(j,2),b=d[0],u=d[1],h=je().value.some((function(e){return e.name===b+".tflite"}));function O(){return(O=Object(S.a)(k.a.mark((function e(){return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,W("publishModel",{model:t,checkpoint:l,name:b});case 3:n(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),_.a.warning({title:"".concat(e.t0)});case 9:case"end":return e.stop()}}),e,null,[[0,6]])})))).apply(this,arguments)}return Object(c.jsxs)(D.a,Object(x.a)(Object(x.a)({backdrop:"static",size:"sm"},a),{},{children:[Object(c.jsx)(D.a.Header,{children:Object(c.jsx)(D.a.Title,{children:"Publish tflite model"})}),Object(c.jsx)(D.a.Body,{children:Object(c.jsxs)(T.a,{layout:"horizontal",children:[Object(c.jsxs)(ze,{children:[Object(c.jsx)(I.a,{children:"Name:"}),Object(c.jsx)(N.a,{value:b,onChange:u,accepter:We}),h&&Object(c.jsx)(He.a,{children:"Note: this file exists and will be overwritten"})]}),Object(c.jsxs)(A.a,{children:[Object(c.jsx)(I.a,{children:"Checkpoint: "}),Object(c.jsxs)(M.a,{inline:!0,appearance:"picker",value:l,onChange:o,children:[Object(c.jsx)(L.a,{value:"best",children:"Best"}),Object(c.jsx)(L.a,{value:"last",children:"Last"})]})]})]})}),Object(c.jsxs)(D.a.Footer,{children:[Object(c.jsx)(H.a,{onClick:function(){return function(){return O.apply(this,arguments)}()},appearance:"primary",children:"Save"}),Object(c.jsx)(H.a,{onClick:n,appearance:"subtle",children:"Cancel"})]})]}))}function We(e){return Object(c.jsxs)(Pe.a,{children:[Object(c.jsx)(Be.a,Object(x.a)({},e)),Object(c.jsx)(Pe.a.Addon,{children:".tflite"})]})}function Ge(){var e=Object(Q.a)(["\n    .rs-list-item-content {\n        display: flex;\n        justify-content: space-between;\n    }\n"]);return Ge=function(){return e},e}function qe(){var e=Object(j.h)();return Object(c.jsxs)(j.c,{children:[Object(c.jsx)(j.a,{path:"".concat(e.url,"/:name"),component:Ze}),Object(c.jsx)(j.a,{component:Ye})]})}var Ve=Object(a.b)(Ae.a)(Ge());function Ye(){var e=Object(j.h)(),t=oe(),n=je();return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h3",{children:"Trained models"}),Object(c.jsx)(f.a,{shaded:!0,bodyFill:!0,children:Object(c.jsx)(Ae.a,{bordered:!0,children:t.value.map((function(t){return Object(c.jsx)(Ae.a.Item,{children:Object(c.jsx)(o.b,{to:"".concat(e.url,"/").concat(t),children:t})},t)}))})}),Object(c.jsx)("h3",{children:"Published model files"}),Object(c.jsx)(f.a,{shaded:!0,bodyFill:!0,children:Object(c.jsxs)(Ve,{bordered:!0,children:[Object(c.jsxs)(Ae.a.Item,{children:["Published models only accessible only on your local network.",Object(c.jsx)("br",{}),"The android app will download these automatically."]}),n.value.map((function(e){var t=e.name,n=e.mtime;return Object(c.jsxs)(Ae.a.Item,{children:[Object(c.jsxs)("div",{children:[Object(c.jsx)("h6",{children:t}),Object(Te.distanceInWordsToNow)(new Date(1e3*n).toISOString())]}),Object(c.jsx)(ge,{path:t,type:"model file"})]},t)}))]})})]})}function Ze(){var e=function(e){return le(null,"getModelInfo",e)}(Object(j.g)().name);if(e.pending)return null;var t=e.value;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)(f.a,{header:t.name,shaded:!0,children:["Params:",Object(c.jsx)("pre",{children:JSON.stringify(t.params,null,2)}),"Last log:",Object(c.jsx)("pre",{children:JSON.stringify(t.logs[t.logs.length-1],null,2)}),Object(c.jsx)(Ue,{model:t.name})]}),Object(c.jsxs)(ve,{children:[Object(c.jsx)(Le,{logs:t.logs,metric:"MeanAbsoluteError"}),Object(c.jsx)(Le,{logs:t.logs,metric:"direction_metric"}),Object(c.jsx)(Le,{logs:t.logs,metric:"angle_metric"}),Object(c.jsx)(Le,{logs:t.logs,metric:"loss"})]})]})}var Xe=n(294),Ke=n.n(Xe),Qe=n(605),$e=n(603),et=n(613);function tt(e){var t=e.help,n=Object(C.a)(e,["help"]);return Object(c.jsxs)("div",{className:"bool-input",children:[Object(c.jsx)(I.a,{children:n.name}),Object(c.jsx)(N.a,Object(x.a)({accepter:et.a},n)),t&&Object(c.jsx)(He.a,{children:t})]})}function nt(e){var t=e.help,n=Object(C.a)(e,["help"]);return Object(c.jsxs)(A.a,{children:[Object(c.jsx)(I.a,{children:n.name}),Object(c.jsx)(N.a,Object(x.a)({accepter:ae.a},n)),t&&Object(c.jsx)(He.a,{children:t})]})}var ct=[{label:"cil",value:"cil"},{label:"cil_mobile",value:"cil_mobile"},{label:"cil_mobile_fast",value:"cil_mobile_fast"},{label:"pilot_net",value:"pilot_net"}],at={};function rt(){var e=Object(r.useRef)(at),t=le(e.current,"getHyperparameters"),n=t.pending,a=t.value;if(Object(r.useEffect)((function(){e.current=a}),[a]),n)return Object(c.jsx)($e.a.Paragraph,{rows:20});return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(re.a,{description:"You may have to tune the learning rate and batch size depending on your available compute resources and dataset. As a general rule of thumb, if you increase the batch size by a factor of n, you can increase the learning rate by a factor of sqrt(n)."}),Object(c.jsxs)(T.a,{onChange:function(t){Object.keys(t).forEach((function(e){if("MODEL"!==e){var n=t[e];t[e]="string"===typeof n?Number(n):n}})),console.log(t),e.current=t},formDefaultValue:a,layout:"horizontal",children:[Object(c.jsxs)(A.a,{children:[Object(c.jsx)(I.a,{children:"MODEL"}),Object(c.jsx)(N.a,{name:"MODEL",accepter:ne.a,data:ct,block:!0})]}),Object(c.jsx)(tt,{name:"USE_LAST",defaultChecked:a.USE_LAST,help:"Continue training from last checkpoint"}),Object(c.jsx)(nt,{name:"LEARNING_RATE",min:0,step:1e-4}),Object(c.jsx)(nt,{name:"TRAIN_BATCH_SIZE",min:1}),Object(c.jsx)(nt,{name:"TEST_BATCH_SIZE",min:1}),Object(c.jsx)(nt,{name:"NUM_EPOCHS",min:1,help:"For debugging and hyperparamter tuning, you can set the number of epochs to a small value like 10. If you want to train a model which will achieve good performance, you should set it to 50 or more. In our paper we used 100."}),Object(c.jsxs)(f.a,{bordered:!0,header:"Advanced parameters",collapsible:!0,children:[Object(c.jsx)(re.a,{type:"warning",description:"Don't change these unless you know what you are doing"}),Object(c.jsx)(tt,{name:"BATCH_NORM",defaultChecked:a.BATCH_NORM}),Object(c.jsx)(tt,{name:"FLIP_AUG",defaultChecked:a.FLIP_AUG}),Object(c.jsx)(tt,{name:"CMD_AUG",defaultChecked:a.CMD_AUG})]}),Object(c.jsx)(re.a,{title:"Note",description:"If you have a trained model with the same parameters, the old model will be overwritten."})]}),Object(c.jsx)(v,{children:Object(c.jsx)(H.a,{onClick:function(){return W("start",e.current)},appearance:"primary",children:"Start"})})]})}var st={status:void 0,epoch:0,percent:0,logs:[],message:""};function it(e,t){switch(t.event){case"started":return{status:"active",epoch:0,percent:0,logs:[],message:"Starting..."};case"preview":return Object(x.a)(Object(x.a)({},e),{},{rnd:Date.now()});case"logs":return Object(x.a)(Object(x.a)({},e),{},{logs:[].concat(Object(K.a)(e.logs),[t.payload])});case"message":return Object(x.a)(Object(x.a)({},e),{},{message:t.payload});case"progress":return Object(x.a)(Object(x.a)({},e),{},{status:"active",epoch:t.payload.epoch,percent:t.payload.train});case"cancelled":return Object(x.a)(Object(x.a)({},e),{},{status:"fail",error:t.payload,message:"Cancelled"});case"failed":return Object(x.a)(Object(x.a)({},e),{},{status:"fail",error:t.payload,message:"Failed"});case"done":return Object(x.a)(Object(x.a)({},e),{},{rnd:Date.now(),status:"success",model:t.payload.model,message:"Done"});case"clear":return{status:void 0,epoch:0,percent:0,logs:[],message:""}}return e}var lt=new Ke.a;function ot(){var e=function(){var e=Object(r.useReducer)(it,st),t=Object(p.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){return q("training",c)}),[]),[n,Object(r.useCallback)((function(){c({event:"clear"})}),[])]}(),t=Object(p.a)(e,2),n=t[0],a=t[1];return Object(c.jsxs)("div",{className:"trainPage",children:[Object(c.jsx)("h3",{children:"Model training"}),n.status?Object(c.jsx)(jt,{state:n,clear:a}):Object(c.jsx)(f.a,{shaded:!0,header:"Hyperparameters",children:Object(c.jsx)(rt,{})})]})}function jt(e){var t=e.state,n=e.clear,a="active"===t.status;return Object(r.useEffect)((function(){a?lt.enable():lt.disable()}),[a]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)(f.a,{shaded:!0,header:"Progress",children:[Object(c.jsxs)("div",{children:["Current epoch:",Object(c.jsx)(Qe.a.Line,{percent:t.epoch,status:t.status})]}),Object(c.jsxs)("div",{children:["Training:",Object(c.jsx)(Qe.a.Line,{percent:t.percent,status:t.status})]}),Object(c.jsx)("h5",{children:t.message}),Object(c.jsx)(v,{children:a?Object(c.jsx)(H.a,{onClick:function(){return W("stop")},children:"Stop"}):Object(c.jsx)(H.a,{onClick:n,children:"Clear"})})]}),Object(c.jsxs)(ve,{children:[Object(c.jsx)(Le,{logs:t.logs,metric:"MeanAbsoluteError"}),Object(c.jsx)(Le,{logs:t.logs,metric:"direction_metric"}),Object(c.jsx)(Le,{logs:t.logs,metric:"angle_metric"}),Object(c.jsx)(Le,{logs:t.logs,metric:"loss"})]}),t.error&&Object(c.jsx)(f.a,{shaded:!0,header:"Error",children:t.error}),!!t.rnd&&Object(c.jsx)(f.a,{bodyFill:!0,shaded:!0,header:"Train preview",collapsible:!0,defaultExpanded:!0,children:Object(c.jsx)("img",{alt:"preview thumbnails",src:"/models/train_preview.png?rnd=".concat(t.rnd)})}),t.model&&Object(c.jsx)(f.a,{bodyFill:!0,shaded:!0,header:"Test preview",collapsible:!0,defaultExpanded:!0,children:Object(c.jsx)("img",{alt:"preview thumbnails",src:"/models/".concat(t.model,"/logs/test_preview.png?rnd=").concat(t.rnd)})})]})}var dt=function(){return Object(c.jsxs)(d.a,{className:"App",children:[Object(c.jsx)(b.a,{children:Object(c.jsxs)(u.a,{appearance:"inverse",children:[Object(c.jsx)(u.a.Header,{children:Object(c.jsx)("a",{href:"#/",className:"navbar-brand logo",children:"OpenBot Driving Policy Trainer"})}),Object(c.jsx)(u.a.Body,{children:Object(c.jsxs)(h.a,{children:[Object(c.jsx)(h.a.Item,{href:"#/",children:"Datasets"}),Object(c.jsx)(h.a.Item,{href:"#/models",children:"Models"}),Object(c.jsx)(h.a.Item,{href:"#/uploaded",children:"Uploaded"}),Object(c.jsx)(h.a.Item,{href:"#/train",children:"Train"})]})})]})}),Object(c.jsx)(O.a,{children:Object(c.jsxs)(j.c,{children:[Object(c.jsx)(j.a,{path:"/models",children:Object(c.jsx)(qe,{})}),Object(c.jsx)(j.a,{path:"/uploaded",children:Object(c.jsx)(Se,{})}),Object(c.jsx)(j.a,{path:"/train_data/:dataset",children:Object(c.jsx)(Se,{})}),Object(c.jsx)(j.a,{path:"/test_data/:dataset",children:Object(c.jsx)(Se,{})}),Object(c.jsx)(j.a,{path:"/train",children:Object(c.jsx)(ot,{})}),Object(c.jsx)(j.a,{children:Object(c.jsx)(_e,{})})]})}),Object(c.jsx)(Fe,{})]})},bt=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,622)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))};Object(a.a)(s.a.createElement),l.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(o.a,{children:Object(c.jsx)(dt,{})})}),document.getElementById("root")),bt()}},[[584,1,2]]]);
//# sourceMappingURL=main.e01b933c.chunk.js.map